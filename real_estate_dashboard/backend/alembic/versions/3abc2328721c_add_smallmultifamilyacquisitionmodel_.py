"""Add SmallMultifamilyAcquisitionModel table

Revision ID: 3abc2328721c
Revises: fix_properties_company_id
Create Date: 2025-11-17 12:30:04.795128

"""
from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision: str = '3abc2328721c'
down_revision: Union[str, None] = 'fix_properties_company_id'
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('data_update_logs',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('integration_name', sa.String(length=100), nullable=False),
    sa.Column('data_type', sa.String(length=100), nullable=False),
    sa.Column('update_type', sa.String(length=50), nullable=False),
    sa.Column('status', sa.String(length=50), nullable=False),
    sa.Column('records_processed', sa.Integer(), nullable=True),
    sa.Column('records_inserted', sa.Integer(), nullable=True),
    sa.Column('records_updated', sa.Integer(), nullable=True),
    sa.Column('records_failed', sa.Integer(), nullable=True),
    sa.Column('started_at', sa.DateTime(timezone=True), nullable=False),
    sa.Column('completed_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('duration_seconds', sa.Float(), nullable=True),
    sa.Column('error_message', sa.Text(), nullable=True),
    sa.Column('error_details', sa.JSON(), nullable=True),
    sa.Column('update_metadata', sa.JSON(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_data_update_logs_data_type'), 'data_update_logs', ['data_type'], unique=False)
    op.create_index(op.f('ix_data_update_logs_id'), 'data_update_logs', ['id'], unique=False)
    op.create_index(op.f('ix_data_update_logs_integration_name'), 'data_update_logs', ['integration_name'], unique=False)
    op.create_index(op.f('ix_data_update_logs_status'), 'data_update_logs', ['status'], unique=False)
    op.create_table('economics_api_indicators',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('country', sa.String(length=100), nullable=False),
    sa.Column('country_code', sa.String(length=3), nullable=True),
    sa.Column('category', sa.String(length=50), nullable=False),
    sa.Column('indicator_name', sa.String(length=200), nullable=False),
    sa.Column('indicator_code', sa.String(length=100), nullable=True),
    sa.Column('value', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('previous_value', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('value_change', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('value_change_pct', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('units', sa.String(length=100), nullable=True),
    sa.Column('frequency', sa.String(length=50), nullable=True),
    sa.Column('reference_date', sa.Date(), nullable=False),
    sa.Column('next_release_date', sa.Date(), nullable=True),
    sa.Column('raw_data', sa.JSON(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index('idx_economic_category_date', 'economics_api_indicators', ['category', 'reference_date'], unique=False)
    op.create_index('idx_economic_country_category', 'economics_api_indicators', ['country', 'category'], unique=False)
    op.create_index('idx_economic_indicator', 'economics_api_indicators', ['indicator_name', 'reference_date'], unique=False)
    op.create_index(op.f('ix_economics_api_indicators_category'), 'economics_api_indicators', ['category'], unique=False)
    op.create_index(op.f('ix_economics_api_indicators_country'), 'economics_api_indicators', ['country'], unique=False)
    op.create_index(op.f('ix_economics_api_indicators_country_code'), 'economics_api_indicators', ['country_code'], unique=False)
    op.create_index(op.f('ix_economics_api_indicators_id'), 'economics_api_indicators', ['id'], unique=False)
    op.create_index(op.f('ix_economics_api_indicators_reference_date'), 'economics_api_indicators', ['reference_date'], unique=False)
    op.create_table('exchange_rates',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('source', sa.String(length=50), nullable=False),
    sa.Column('base_currency', sa.String(length=3), nullable=False),
    sa.Column('quote_currency', sa.String(length=3), nullable=False),
    sa.Column('date', sa.DateTime(), nullable=False),
    sa.Column('year', sa.Integer(), nullable=False),
    sa.Column('month', sa.Integer(), nullable=False),
    sa.Column('day', sa.Integer(), nullable=False),
    sa.Column('rate', sa.Float(), nullable=False),
    sa.Column('rate_type', sa.String(length=50), nullable=True),
    sa.Column('series_code', sa.String(length=100), nullable=True),
    sa.Column('daily_change', sa.Float(), nullable=True),
    sa.Column('daily_change_pct', sa.Float(), nullable=True),
    sa.Column('raw_data', sa.JSON(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_exchange_rates_base_currency'), 'exchange_rates', ['base_currency'], unique=False)
    op.create_index(op.f('ix_exchange_rates_date'), 'exchange_rates', ['date'], unique=False)
    op.create_index(op.f('ix_exchange_rates_id'), 'exchange_rates', ['id'], unique=False)
    op.create_index(op.f('ix_exchange_rates_month'), 'exchange_rates', ['month'], unique=False)
    op.create_index(op.f('ix_exchange_rates_quote_currency'), 'exchange_rates', ['quote_currency'], unique=False)
    op.create_index(op.f('ix_exchange_rates_series_code'), 'exchange_rates', ['series_code'], unique=False)
    op.create_index(op.f('ix_exchange_rates_source'), 'exchange_rates', ['source'], unique=False)
    op.create_index(op.f('ix_exchange_rates_year'), 'exchange_rates', ['year'], unique=False)
    op.create_table('fair_market_rents',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('zip_code', sa.String(length=10), nullable=True),
    sa.Column('county', sa.String(length=100), nullable=True),
    sa.Column('county_code', sa.String(length=10), nullable=True),
    sa.Column('metro_code', sa.String(length=10), nullable=True),
    sa.Column('metro_name', sa.String(length=255), nullable=True),
    sa.Column('state', sa.String(length=2), nullable=True),
    sa.Column('year', sa.Integer(), nullable=False),
    sa.Column('efficiency', sa.Float(), nullable=True),
    sa.Column('one_bedroom', sa.Float(), nullable=True),
    sa.Column('two_bedroom', sa.Float(), nullable=True),
    sa.Column('three_bedroom', sa.Float(), nullable=True),
    sa.Column('four_bedroom', sa.Float(), nullable=True),
    sa.Column('percentile', sa.Integer(), nullable=True),
    sa.Column('small_area_fmr', sa.Boolean(), nullable=True),
    sa.Column('raw_data', sa.JSON(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_fair_market_rents_county'), 'fair_market_rents', ['county'], unique=False)
    op.create_index(op.f('ix_fair_market_rents_id'), 'fair_market_rents', ['id'], unique=False)
    op.create_index(op.f('ix_fair_market_rents_metro_code'), 'fair_market_rents', ['metro_code'], unique=False)
    op.create_index(op.f('ix_fair_market_rents_state'), 'fair_market_rents', ['state'], unique=False)
    op.create_index(op.f('ix_fair_market_rents_year'), 'fair_market_rents', ['year'], unique=False)
    op.create_index(op.f('ix_fair_market_rents_zip_code'), 'fair_market_rents', ['zip_code'], unique=False)
    op.create_table('global_economic_indicators',
    sa.Column('country', sa.String(length=100), nullable=False),
    sa.Column('country_code', sa.String(length=10), nullable=True),
    sa.Column('category', sa.String(length=100), nullable=False),
    sa.Column('indicator_name', sa.String(length=300), nullable=False),
    sa.Column('indicator_code', sa.String(length=100), nullable=True),
    sa.Column('value', sa.Numeric(precision=20, scale=4), nullable=True),
    sa.Column('previous_value', sa.Numeric(precision=20, scale=4), nullable=True),
    sa.Column('change', sa.Numeric(precision=20, scale=4), nullable=True),
    sa.Column('change_pct', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('forecast', sa.Numeric(precision=20, scale=4), nullable=True),
    sa.Column('unit', sa.String(length=50), nullable=True),
    sa.Column('frequency', sa.String(length=50), nullable=True),
    sa.Column('data_date', sa.Date(), nullable=False),
    sa.Column('period', sa.String(length=50), nullable=True),
    sa.Column('source', sa.String(length=50), nullable=True),
    sa.Column('source_organization', sa.String(length=200), nullable=True),
    sa.Column('last_updated', sa.DateTime(), nullable=True),
    sa.Column('raw_data', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record last update timestamp'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('id')
    )
    op.create_index('idx_global_economic_country_category', 'global_economic_indicators', ['country', 'category', 'data_date'], unique=False)
    op.create_index('idx_global_economic_indicator', 'global_economic_indicators', ['indicator_name', 'data_date'], unique=False)
    op.create_index(op.f('ix_global_economic_indicators_category'), 'global_economic_indicators', ['category'], unique=False)
    op.create_index(op.f('ix_global_economic_indicators_country'), 'global_economic_indicators', ['country'], unique=False)
    op.create_index(op.f('ix_global_economic_indicators_data_date'), 'global_economic_indicators', ['data_date'], unique=False)
    op.create_table('housing_price_indexes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('source', sa.String(length=50), nullable=False),
    sa.Column('geography_type', sa.String(length=50), nullable=False),
    sa.Column('geography_code', sa.String(length=100), nullable=True),
    sa.Column('geography_name', sa.String(length=255), nullable=True),
    sa.Column('year', sa.Integer(), nullable=False),
    sa.Column('quarter', sa.Integer(), nullable=True),
    sa.Column('month', sa.Integer(), nullable=True),
    sa.Column('date', sa.DateTime(), nullable=True),
    sa.Column('index_value', sa.Float(), nullable=False),
    sa.Column('index_type', sa.String(length=100), nullable=True),
    sa.Column('quarterly_change', sa.Float(), nullable=True),
    sa.Column('annual_change', sa.Float(), nullable=True),
    sa.Column('since_peak_change', sa.Float(), nullable=True),
    sa.Column('base_period', sa.String(length=50), nullable=True),
    sa.Column('seasonal_adjustment', sa.Boolean(), nullable=True),
    sa.Column('raw_data', sa.JSON(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_housing_price_indexes_date'), 'housing_price_indexes', ['date'], unique=False)
    op.create_index(op.f('ix_housing_price_indexes_geography_code'), 'housing_price_indexes', ['geography_code'], unique=False)
    op.create_index(op.f('ix_housing_price_indexes_geography_type'), 'housing_price_indexes', ['geography_type'], unique=False)
    op.create_index(op.f('ix_housing_price_indexes_id'), 'housing_price_indexes', ['id'], unique=False)
    op.create_index(op.f('ix_housing_price_indexes_source'), 'housing_price_indexes', ['source'], unique=False)
    op.create_index(op.f('ix_housing_price_indexes_year'), 'housing_price_indexes', ['year'], unique=False)
    op.create_table('legal_knowledge_base',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('title', sa.String(length=255), nullable=False),
    sa.Column('topic', sa.String(length=255), nullable=False),
    sa.Column('category', sa.String(length=100), nullable=False),
    sa.Column('content', sa.Text(), nullable=False),
    sa.Column('summary', sa.Text(), nullable=True),
    sa.Column('tags', sa.JSON(), nullable=True),
    sa.Column('jurisdiction', sa.String(length=100), nullable=True),
    sa.Column('applicable_states', sa.JSON(), nullable=True),
    sa.Column('last_reviewed', sa.Date(), nullable=True),
    sa.Column('author', sa.String(length=255), nullable=True),
    sa.Column('references', sa.JSON(), nullable=True),
    sa.Column('is_published', sa.Boolean(), nullable=True),
    sa.Column('view_count', sa.Integer(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_legal_knowledge_base_id'), 'legal_knowledge_base', ['id'], unique=False)
    op.create_index(op.f('ix_legal_knowledge_base_topic'), 'legal_knowledge_base', ['topic'], unique=False)
    op.create_table('market_indices',
    sa.Column('symbol', sa.String(length=20), nullable=False),
    sa.Column('name', sa.String(length=200), nullable=False),
    sa.Column('current_value', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('open_value', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('high_value', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('low_value', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('previous_close', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('price_change', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('price_change_pct', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('volume', sa.Numeric(precision=20, scale=0), nullable=True),
    sa.Column('data_date', sa.Date(), nullable=False),
    sa.Column('currency', sa.String(length=10), nullable=True),
    sa.Column('market', sa.String(length=50), nullable=True),
    sa.Column('source', sa.String(length=50), nullable=True),
    sa.Column('raw_data', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record last update timestamp'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('id')
    )
    op.create_index('idx_market_index_symbol_date', 'market_indices', ['symbol', 'data_date'], unique=False)
    op.create_index(op.f('ix_market_indices_data_date'), 'market_indices', ['data_date'], unique=False)
    op.create_index(op.f('ix_market_indices_symbol'), 'market_indices', ['symbol'], unique=False)
    op.create_table('market_intelligence_fetch_log',
    sa.Column('fetch_timestamp', sa.DateTime(), nullable=False),
    sa.Column('data_source', sa.String(length=100), nullable=False),
    sa.Column('data_type', sa.String(length=100), nullable=False),
    sa.Column('endpoint', sa.String(length=300), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('records_fetched', sa.Numeric(precision=10, scale=0), nullable=True),
    sa.Column('records_saved', sa.Numeric(precision=10, scale=0), nullable=True),
    sa.Column('records_updated', sa.Numeric(precision=10, scale=0), nullable=True),
    sa.Column('has_errors', sa.Boolean(), nullable=True),
    sa.Column('error_message', sa.Text(), nullable=True),
    sa.Column('error_details', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('retry_count', sa.Numeric(precision=5, scale=0), nullable=True),
    sa.Column('max_retries', sa.Numeric(precision=5, scale=0), nullable=True),
    sa.Column('duration_seconds', sa.Numeric(precision=10, scale=3), nullable=True),
    sa.Column('cache_hit', sa.Boolean(), nullable=True),
    sa.Column('cache_ttl', sa.Numeric(precision=10, scale=0), nullable=True),
    sa.Column('request_params', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('response_summary', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('user_id', sa.UUID(), nullable=True),
    sa.Column('automated', sa.Boolean(), nullable=True),
    sa.Column('fetch_metadata', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record last update timestamp'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('id')
    )
    op.create_index('idx_fetch_log_source_type', 'market_intelligence_fetch_log', ['data_source', 'data_type', 'fetch_timestamp'], unique=False)
    op.create_index('idx_fetch_log_status', 'market_intelligence_fetch_log', ['status', 'fetch_timestamp'], unique=False)
    op.create_index(op.f('ix_market_intelligence_fetch_log_fetch_timestamp'), 'market_intelligence_fetch_log', ['fetch_timestamp'], unique=False)
    op.create_table('market_intelligence_snapshots',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('snapshot_date', sa.Date(), nullable=False),
    sa.Column('snapshot_type', sa.String(length=50), nullable=True),
    sa.Column('sp500_value', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('sp500_change_pct', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('dow_jones_value', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('nasdaq_value', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('vix_value', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('reit_etf_vnq', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('reit_sector_change_pct', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('treasury_10y', sa.Numeric(precision=10, scale=6), nullable=True),
    sa.Column('treasury_30y', sa.Numeric(precision=10, scale=6), nullable=True),
    sa.Column('fed_funds_rate', sa.Numeric(precision=10, scale=6), nullable=True),
    sa.Column('mortgage_30y', sa.Numeric(precision=10, scale=6), nullable=True),
    sa.Column('unemployment_rate', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('inflation_rate', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('gdp_growth_rate', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('home_price_index', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('housing_starts', sa.Integer(), nullable=True),
    sa.Column('building_permits', sa.Integer(), nullable=True),
    sa.Column('full_data', sa.JSON(), nullable=True),
    sa.Column('data_completeness_pct', sa.Numeric(precision=5, scale=2), nullable=True),
    sa.Column('data_sources_count', sa.Integer(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index('idx_snapshot_date_type', 'market_intelligence_snapshots', ['snapshot_date', 'snapshot_type'], unique=False)
    op.create_index(op.f('ix_market_intelligence_snapshots_id'), 'market_intelligence_snapshots', ['id'], unique=False)
    op.create_index(op.f('ix_market_intelligence_snapshots_snapshot_date'), 'market_intelligence_snapshots', ['snapshot_date'], unique=False)
    op.create_index(op.f('ix_market_intelligence_snapshots_snapshot_type'), 'market_intelligence_snapshots', ['snapshot_type'], unique=False)
    op.create_table('official_datasets',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('source', sa.String(length=100), nullable=False),
    sa.Column('dataset_id', sa.String(length=255), nullable=False),
    sa.Column('name', sa.String(length=500), nullable=False),
    sa.Column('title', sa.String(length=500), nullable=True),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('organization', sa.String(length=255), nullable=True),
    sa.Column('publisher', sa.String(length=255), nullable=True),
    sa.Column('tags', sa.JSON(), nullable=True),
    sa.Column('categories', sa.JSON(), nullable=True),
    sa.Column('license_title', sa.String(length=255), nullable=True),
    sa.Column('license_url', sa.String(length=500), nullable=True),
    sa.Column('metadata_created', sa.DateTime(), nullable=True),
    sa.Column('metadata_modified', sa.DateTime(), nullable=True),
    sa.Column('resource_count', sa.Integer(), nullable=True),
    sa.Column('resources', sa.JSON(), nullable=True),
    sa.Column('dataset_url', sa.String(length=500), nullable=True),
    sa.Column('api_url', sa.String(length=500), nullable=True),
    sa.Column('extras', sa.JSON(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_official_datasets_dataset_id'), 'official_datasets', ['dataset_id'], unique=False)
    op.create_index(op.f('ix_official_datasets_id'), 'official_datasets', ['id'], unique=False)
    op.create_index(op.f('ix_official_datasets_source'), 'official_datasets', ['source'], unique=False)
    op.create_table('real_estate_economic_indicators',
    sa.Column('data_date', sa.Date(), nullable=False),
    sa.Column('geography', sa.String(length=100), nullable=True),
    sa.Column('cpi_all_items', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('cpi_year_over_year', sa.Numeric(precision=5, scale=2), nullable=True),
    sa.Column('cpi_core', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('ppi', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('pce', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('housing_cpi', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('gdp_real', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('gdp_growth_rate', sa.Numeric(precision=5, scale=2), nullable=True),
    sa.Column('construction_spending', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('residential_construction', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('building_permits_total', sa.Numeric(precision=10, scale=0), nullable=True),
    sa.Column('building_permits_single_family', sa.Numeric(precision=10, scale=0), nullable=True),
    sa.Column('building_permits_multi_family', sa.Numeric(precision=10, scale=0), nullable=True),
    sa.Column('housing_starts', sa.Numeric(precision=10, scale=0), nullable=True),
    sa.Column('housing_completions', sa.Numeric(precision=10, scale=0), nullable=True),
    sa.Column('source', sa.String(length=100), nullable=True),
    sa.Column('raw_data', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record last update timestamp'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('id')
    )
    op.create_index(op.f('ix_real_estate_economic_indicators_data_date'), 'real_estate_economic_indicators', ['data_date'], unique=False)
    op.create_table('regulatory_changes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('title', sa.String(length=255), nullable=False),
    sa.Column('change_type', sa.String(length=100), nullable=True),
    sa.Column('jurisdiction', sa.String(length=255), nullable=False),
    sa.Column('state', sa.String(length=2), nullable=True),
    sa.Column('effective_date', sa.Date(), nullable=False),
    sa.Column('description', sa.Text(), nullable=False),
    sa.Column('affected_areas', sa.JSON(), nullable=True),
    sa.Column('impact_level', sa.String(length=50), nullable=True),
    sa.Column('action_required', sa.Boolean(), nullable=True),
    sa.Column('action_deadline', sa.Date(), nullable=True),
    sa.Column('reference_url', sa.String(length=500), nullable=True),
    sa.Column('notification_sent', sa.Boolean(), nullable=True),
    sa.Column('acknowledged_by', sa.JSON(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_regulatory_changes_id'), 'regulatory_changes', ['id'], unique=False)
    op.create_table('reit_data',
    sa.Column('ticker', sa.String(length=20), nullable=False),
    sa.Column('company_name', sa.String(length=300), nullable=True),
    sa.Column('sector', sa.String(length=100), nullable=True),
    sa.Column('current_price', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('day_high', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('day_low', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('previous_close', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('price_change', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('price_change_pct', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('dividend_yield', sa.Numeric(precision=8, scale=4), nullable=True),
    sa.Column('annual_dividend', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('dividend_date', sa.Date(), nullable=True),
    sa.Column('ex_dividend_date', sa.Date(), nullable=True),
    sa.Column('payout_ratio', sa.Numeric(precision=8, scale=4), nullable=True),
    sa.Column('market_cap', sa.Numeric(precision=20, scale=0), nullable=True),
    sa.Column('volume', sa.Numeric(precision=20, scale=0), nullable=True),
    sa.Column('average_volume', sa.Numeric(precision=20, scale=0), nullable=True),
    sa.Column('pe_ratio', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('beta', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('week_52_high', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('week_52_low', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('ytd_return', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('data_date', sa.Date(), nullable=False),
    sa.Column('currency', sa.String(length=10), nullable=True),
    sa.Column('exchange', sa.String(length=50), nullable=True),
    sa.Column('source', sa.String(length=50), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('raw_data', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record last update timestamp'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('id')
    )
    op.create_index('idx_reit_sector', 'reit_data', ['sector'], unique=False)
    op.create_index('idx_reit_ticker_date', 'reit_data', ['ticker', 'data_date'], unique=False)
    op.create_index(op.f('ix_reit_data_data_date'), 'reit_data', ['data_date'], unique=False)
    op.create_index(op.f('ix_reit_data_ticker'), 'reit_data', ['ticker'], unique=False)
    op.create_table('small_multifamily_acquisition_models',
    sa.Column('property_type', sa.String(length=100), nullable=True, comment='Property type (duplex, triplex, quadplex, small_multifamily)'),
    sa.Column('number_of_units', sa.Integer(), nullable=True, comment='Number of units in the property'),
    sa.Column('name', sa.String(length=255), nullable=False, comment='Deal or project name'),
    sa.Column('location', sa.String(length=255), nullable=True, comment='Primary market or address'),
    sa.Column('analyst', sa.String(length=255), nullable=True, comment='Person who created the record'),
    sa.Column('notes', sa.String(), nullable=True, comment='Optional internal notes'),
    sa.Column('model_version', sa.String(length=50), nullable=False, comment='Model template version'),
    sa.Column('inputs', sa.JSON(), nullable=False, comment='Serialized user inputs'),
    sa.Column('results', sa.JSON(), nullable=False, comment='Serialized output metrics and projections'),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record last update timestamp'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('id')
    )
    op.create_table('state_legal_forms',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('form_name', sa.String(length=255), nullable=False),
    sa.Column('state', sa.String(length=2), nullable=False),
    sa.Column('form_number', sa.String(length=100), nullable=True),
    sa.Column('category', sa.String(length=100), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('form_content', sa.Text(), nullable=True),
    sa.Column('form_url', sa.String(length=500), nullable=True),
    sa.Column('is_required', sa.Boolean(), nullable=True),
    sa.Column('applicable_transactions', sa.JSON(), nullable=True),
    sa.Column('effective_date', sa.Date(), nullable=True),
    sa.Column('expiration_date', sa.Date(), nullable=True),
    sa.Column('last_updated', sa.Date(), nullable=True),
    sa.Column('source_authority', sa.String(length=255), nullable=True),
    sa.Column('compliance_notes', sa.Text(), nullable=True),
    sa.Column('is_fillable', sa.Boolean(), nullable=True),
    sa.Column('required_fields', sa.JSON(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_state_legal_forms_id'), 'state_legal_forms', ['id'], unique=False)
    op.create_index(op.f('ix_state_legal_forms_state'), 'state_legal_forms', ['state'], unique=False)
    op.create_table('stock_data',
    sa.Column('ticker', sa.String(length=20), nullable=False),
    sa.Column('company_name', sa.String(length=300), nullable=True),
    sa.Column('sector', sa.String(length=100), nullable=True),
    sa.Column('industry', sa.String(length=100), nullable=True),
    sa.Column('current_price', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('open_price', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('high_price', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('low_price', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('previous_close', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('price_change', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('price_change_pct', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('volume', sa.Numeric(precision=20, scale=0), nullable=True),
    sa.Column('market_cap', sa.Numeric(precision=20, scale=0), nullable=True),
    sa.Column('pe_ratio', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('dividend_yield', sa.Numeric(precision=8, scale=4), nullable=True),
    sa.Column('beta', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('data_date', sa.Date(), nullable=False),
    sa.Column('currency', sa.String(length=10), nullable=True),
    sa.Column('exchange', sa.String(length=50), nullable=True),
    sa.Column('source', sa.String(length=50), nullable=True),
    sa.Column('is_tracked', sa.Boolean(), nullable=True),
    sa.Column('raw_data', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record last update timestamp'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('id')
    )
    op.create_index('idx_stock_sector', 'stock_data', ['sector'], unique=False)
    op.create_index('idx_stock_ticker_date', 'stock_data', ['ticker', 'data_date'], unique=False)
    op.create_index(op.f('ix_stock_data_data_date'), 'stock_data', ['data_date'], unique=False)
    op.create_index(op.f('ix_stock_data_ticker'), 'stock_data', ['ticker'], unique=False)
    op.create_table('treasury_rates',
    sa.Column('symbol', sa.String(length=20), nullable=False),
    sa.Column('name', sa.String(length=200), nullable=True),
    sa.Column('maturity', sa.String(length=50), nullable=True),
    sa.Column('rate', sa.Numeric(precision=8, scale=4), nullable=False),
    sa.Column('previous_rate', sa.Numeric(precision=8, scale=4), nullable=True),
    sa.Column('rate_change', sa.Numeric(precision=8, scale=4), nullable=True),
    sa.Column('rate_change_pct', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('week_52_high', sa.Numeric(precision=8, scale=4), nullable=True),
    sa.Column('week_52_low', sa.Numeric(precision=8, scale=4), nullable=True),
    sa.Column('data_date', sa.Date(), nullable=False),
    sa.Column('source', sa.String(length=50), nullable=True),
    sa.Column('raw_data', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record last update timestamp'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('id')
    )
    op.create_index('idx_treasury_symbol_date', 'treasury_rates', ['symbol', 'data_date'], unique=False)
    op.create_index(op.f('ix_treasury_rates_data_date'), 'treasury_rates', ['data_date'], unique=False)
    op.create_index(op.f('ix_treasury_rates_symbol'), 'treasury_rates', ['symbol'], unique=False)
    op.create_table('yfinance_market_data',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('ticker', sa.String(length=20), nullable=False),
    sa.Column('company_name', sa.String(length=200), nullable=True),
    sa.Column('security_type', sa.String(length=50), nullable=True),
    sa.Column('current_price', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('currency', sa.String(length=10), nullable=True),
    sa.Column('price_change', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('price_change_pct', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('volume', sa.Integer(), nullable=True),
    sa.Column('market_cap', sa.Integer(), nullable=True),
    sa.Column('pe_ratio', sa.Numeric(precision=10, scale=4), nullable=True),
    sa.Column('dividend_yield', sa.Numeric(precision=10, scale=6), nullable=True),
    sa.Column('week_52_high', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('week_52_low', sa.Numeric(precision=20, scale=6), nullable=True),
    sa.Column('sector', sa.String(length=100), nullable=True),
    sa.Column('industry', sa.String(length=100), nullable=True),
    sa.Column('historical_data', sa.JSON(), nullable=True),
    sa.Column('data_period', sa.String(length=20), nullable=True),
    sa.Column('data_interval', sa.String(length=20), nullable=True),
    sa.Column('data_timestamp', sa.DateTime(timezone=True), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index('idx_yfinance_ticker_timestamp', 'yfinance_market_data', ['ticker', 'data_timestamp'], unique=False)
    op.create_index('idx_yfinance_type_sector', 'yfinance_market_data', ['security_type', 'sector'], unique=False)
    op.create_index(op.f('ix_yfinance_market_data_id'), 'yfinance_market_data', ['id'], unique=False)
    op.create_index(op.f('ix_yfinance_market_data_industry'), 'yfinance_market_data', ['industry'], unique=False)
    op.create_index(op.f('ix_yfinance_market_data_sector'), 'yfinance_market_data', ['sector'], unique=False)
    op.create_index(op.f('ix_yfinance_market_data_security_type'), 'yfinance_market_data', ['security_type'], unique=False)
    op.create_index(op.f('ix_yfinance_market_data_ticker'), 'yfinance_market_data', ['ticker'], unique=False)
    op.create_table('zoning_data',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('jurisdiction', sa.String(length=255), nullable=False),
    sa.Column('state', sa.String(length=2), nullable=False),
    sa.Column('zoning_code', sa.String(length=50), nullable=False),
    sa.Column('zoning_name', sa.String(length=255), nullable=False),
    sa.Column('category', sa.String(length=100), nullable=True),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('permitted_uses', sa.JSON(), nullable=True),
    sa.Column('conditional_uses', sa.JSON(), nullable=True),
    sa.Column('prohibited_uses', sa.JSON(), nullable=True),
    sa.Column('density_requirements', sa.Text(), nullable=True),
    sa.Column('height_restrictions', sa.String(length=255), nullable=True),
    sa.Column('parking_requirements', sa.Text(), nullable=True),
    sa.Column('setback_requirements', sa.Text(), nullable=True),
    sa.Column('special_conditions', sa.Text(), nullable=True),
    sa.Column('ordinance_reference', sa.String(length=255), nullable=True),
    sa.Column('last_updated', sa.Date(), nullable=True),
    sa.Column('data_source', sa.String(length=500), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_zoning_data_id'), 'zoning_data', ['id'], unique=False)
    op.create_index(op.f('ix_zoning_data_jurisdiction'), 'zoning_data', ['jurisdiction'], unique=False)
    op.create_index(op.f('ix_zoning_data_state'), 'zoning_data', ['state'], unique=False)
    op.create_table('ai_contract_analysis',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('contract_name', sa.String(length=255), nullable=False),
    sa.Column('file_path', sa.String(length=500), nullable=True),
    sa.Column('analysis_date', sa.DateTime(), nullable=True),
    sa.Column('risk_score', sa.Integer(), nullable=True),
    sa.Column('risk_level', sa.String(length=50), nullable=True),
    sa.Column('high_risk_clauses', sa.JSON(), nullable=True),
    sa.Column('missing_provisions', sa.JSON(), nullable=True),
    sa.Column('compliance_issues', sa.JSON(), nullable=True),
    sa.Column('recommendations', sa.JSON(), nullable=True),
    sa.Column('clause_analysis', sa.JSON(), nullable=True),
    sa.Column('financial_terms', sa.JSON(), nullable=True),
    sa.Column('key_dates', sa.JSON(), nullable=True),
    sa.Column('parties_involved', sa.JSON(), nullable=True),
    sa.Column('jurisdiction', sa.String(length=255), nullable=True),
    sa.Column('ai_model_version', sa.String(length=50), nullable=True),
    sa.Column('confidence_score', sa.Float(), nullable=True),
    sa.Column('processing_time', sa.Integer(), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_ai_contract_analysis_id'), 'ai_contract_analysis', ['id'], unique=False)
    op.create_table('audit_preparation',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('audit_name', sa.String(length=255), nullable=False),
    sa.Column('audit_type', sa.String(length=100), nullable=True),
    sa.Column('audit_year', sa.Integer(), nullable=True),
    sa.Column('auditor_firm', sa.String(length=255), nullable=True),
    sa.Column('auditor_contact', sa.String(length=255), nullable=True),
    sa.Column('engagement_letter_date', sa.Date(), nullable=True),
    sa.Column('audit_start_date', sa.Date(), nullable=True),
    sa.Column('fieldwork_start_date', sa.Date(), nullable=True),
    sa.Column('fieldwork_end_date', sa.Date(), nullable=True),
    sa.Column('expected_completion_date', sa.Date(), nullable=True),
    sa.Column('status', sa.Enum('NOT_STARTED', 'IN_PROGRESS', 'COMPLETED', 'FAILED', name='auditstatus'), nullable=True),
    sa.Column('document_request_list', sa.JSON(), nullable=True),
    sa.Column('documents_collected', sa.Integer(), nullable=True),
    sa.Column('documents_required', sa.Integer(), nullable=True),
    sa.Column('collection_progress', sa.Integer(), nullable=True),
    sa.Column('checklist', sa.JSON(), nullable=True),
    sa.Column('checklist_completion', sa.Integer(), nullable=True),
    sa.Column('findings_count', sa.Integer(), nullable=True),
    sa.Column('material_weaknesses', sa.Integer(), nullable=True),
    sa.Column('significant_deficiencies', sa.Integer(), nullable=True),
    sa.Column('findings_details', sa.JSON(), nullable=True),
    sa.Column('management_response_required', sa.Boolean(), nullable=True),
    sa.Column('management_response_submitted', sa.Boolean(), nullable=True),
    sa.Column('management_response_date', sa.Date(), nullable=True),
    sa.Column('remediation_plan', sa.JSON(), nullable=True),
    sa.Column('remediation_deadline', sa.Date(), nullable=True),
    sa.Column('remediation_completed', sa.Boolean(), nullable=True),
    sa.Column('draft_report_received', sa.Boolean(), nullable=True),
    sa.Column('draft_report_date', sa.Date(), nullable=True),
    sa.Column('final_report_received', sa.Boolean(), nullable=True),
    sa.Column('final_report_date', sa.Date(), nullable=True),
    sa.Column('audit_opinion', sa.String(length=100), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_audit_preparation_id'), 'audit_preparation', ['id'], unique=False)
    op.create_table('automation_workflows',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('workflow_type', sa.String(length=100), nullable=True),
    sa.Column('status', sa.Enum('ACTIVE', 'INACTIVE', 'PAUSED', 'ERROR', name='automationstatus'), nullable=True),
    sa.Column('trigger_conditions', sa.JSON(), nullable=True),
    sa.Column('actions', sa.JSON(), nullable=True),
    sa.Column('schedule', sa.String(length=255), nullable=True),
    sa.Column('last_run', sa.DateTime(), nullable=True),
    sa.Column('next_run', sa.DateTime(), nullable=True),
    sa.Column('trigger_count', sa.Integer(), nullable=True),
    sa.Column('success_count', sa.Integer(), nullable=True),
    sa.Column('error_count', sa.Integer(), nullable=True),
    sa.Column('notification_settings', sa.JSON(), nullable=True),
    sa.Column('is_enabled', sa.Boolean(), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_automation_workflows_id'), 'automation_workflows', ['id'], unique=False)
    op.create_table('clause_comparisons',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('comparison_name', sa.String(length=255), nullable=False),
    sa.Column('comparison_date', sa.DateTime(), nullable=True),
    sa.Column('document_a_id', sa.Integer(), nullable=True),
    sa.Column('document_a_name', sa.String(length=255), nullable=True),
    sa.Column('document_a_path', sa.String(length=500), nullable=True),
    sa.Column('document_b_id', sa.Integer(), nullable=True),
    sa.Column('document_b_name', sa.String(length=255), nullable=True),
    sa.Column('document_b_path', sa.String(length=500), nullable=True),
    sa.Column('clauses_compared', sa.Integer(), nullable=True),
    sa.Column('differences_found', sa.Integer(), nullable=True),
    sa.Column('similarity_score', sa.Float(), nullable=True),
    sa.Column('comparison_results', sa.JSON(), nullable=True),
    sa.Column('key_differences', sa.JSON(), nullable=True),
    sa.Column('risk_differences', sa.JSON(), nullable=True),
    sa.Column('ai_summary', sa.Text(), nullable=True),
    sa.Column('ai_recommendations', sa.JSON(), nullable=True),
    sa.Column('reviewed_by', sa.String(length=255), nullable=True),
    sa.Column('review_notes', sa.Text(), nullable=True),
    sa.Column('approved_version', sa.String(length=10), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_clause_comparisons_id'), 'clause_comparisons', ['id'], unique=False)
    op.create_table('clause_library',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=False),
    sa.Column('category', sa.Enum('PURCHASE_SALE', 'LEASING', 'RISK_MITIGATION', 'FINANCING', 'DISCLOSURE', 'TERMINATION', 'GENERAL', name='clausecategory'), nullable=False),
    sa.Column('clause_text', sa.Text(), nullable=False),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('usage_recommendation', sa.String(length=100), nullable=True),
    sa.Column('ai_safety_score', sa.Integer(), nullable=True),
    sa.Column('risk_level', sa.Enum('LOW', 'MEDIUM', 'HIGH', 'CRITICAL', name='clauserisklevel'), nullable=True),
    sa.Column('state_specific', sa.Boolean(), nullable=True),
    sa.Column('applicable_states', sa.JSON(), nullable=True),
    sa.Column('jurisdiction_notes', sa.Text(), nullable=True),
    sa.Column('version', sa.String(length=50), nullable=True),
    sa.Column('is_approved', sa.Boolean(), nullable=True),
    sa.Column('created_by', sa.String(length=255), nullable=True),
    sa.Column('approved_by', sa.String(length=255), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_clause_library_id'), 'clause_library', ['id'], unique=False)
    op.create_table('country_filters',
    sa.Column('user_id', sa.UUID(), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=True),
    sa.Column('country', sa.String(length=100), nullable=False),
    sa.Column('country_code', sa.String(length=10), nullable=True),
    sa.Column('country_display_name', sa.String(length=200), nullable=True),
    sa.Column('state', sa.String(length=100), nullable=True),
    sa.Column('state_code', sa.String(length=10), nullable=True),
    sa.Column('metro_area', sa.String(length=200), nullable=True),
    sa.Column('is_primary', sa.Boolean(), nullable=True),
    sa.Column('display_order', sa.Numeric(precision=5, scale=0), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('track_economic_indicators', sa.Boolean(), nullable=True),
    sa.Column('track_housing_data', sa.Boolean(), nullable=True),
    sa.Column('track_employment_data', sa.Boolean(), nullable=True),
    sa.Column('track_interest_rates', sa.Boolean(), nullable=True),
    sa.Column('preferences', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False, comment='Record last update timestamp'),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('id')
    )
    op.create_index('idx_country_filter_company', 'country_filters', ['company_id', 'country'], unique=False)
    op.create_index('idx_country_filter_user', 'country_filters', ['user_id', 'country'], unique=False)
    op.create_index(op.f('ix_country_filters_user_id'), 'country_filters', ['user_id'], unique=False)
    op.create_table('document_templates',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=False),
    sa.Column('document_type', sa.String(length=100), nullable=False),
    sa.Column('complexity', sa.String(length=50), nullable=True),
    sa.Column('estimated_time', sa.String(length=50), nullable=True),
    sa.Column('ai_powered', sa.Boolean(), nullable=True),
    sa.Column('state_specific', sa.Boolean(), nullable=True),
    sa.Column('template_content', sa.Text(), nullable=True),
    sa.Column('template_url', sa.String(length=500), nullable=True),
    sa.Column('required_fields', sa.JSON(), nullable=True),
    sa.Column('optional_fields', sa.JSON(), nullable=True),
    sa.Column('suggested_clauses', sa.JSON(), nullable=True),
    sa.Column('compliance_requirements', sa.JSON(), nullable=True),
    sa.Column('category', sa.String(length=100), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_document_templates_id'), 'document_templates', ['id'], unique=False)
    op.create_table('esignature_requests',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('document_name', sa.String(length=255), nullable=False),
    sa.Column('document_path', sa.String(length=500), nullable=True),
    sa.Column('status', sa.Enum('PENDING', 'SENT', 'SIGNED', 'DECLINED', 'EXPIRED', name='signaturestatus'), nullable=True),
    sa.Column('sender_email', sa.String(length=255), nullable=False),
    sa.Column('signers', sa.JSON(), nullable=False),
    sa.Column('current_signer_index', sa.Integer(), nullable=True),
    sa.Column('expiration_date', sa.Date(), nullable=True),
    sa.Column('reminder_sent', sa.Boolean(), nullable=True),
    sa.Column('completed_at', sa.DateTime(), nullable=True),
    sa.Column('audit_trail', sa.JSON(), nullable=True),
    sa.Column('ip_addresses', sa.JSON(), nullable=True),
    sa.Column('esign_provider', sa.String(length=100), nullable=True),
    sa.Column('provider_reference', sa.String(length=255), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_esignature_requests_id'), 'esignature_requests', ['id'], unique=False)
    op.create_table('exchange_1031_tracking',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('exchange_name', sa.String(length=255), nullable=False),
    sa.Column('status', sa.Enum('PLANNING', 'PROPERTY_SOLD', 'IDENTIFICATION_PERIOD', 'EXCHANGE_PERIOD', 'COMPLETED', 'FAILED', 'CANCELLED', name='exchange1031status'), nullable=True),
    sa.Column('relinquished_property_address', sa.String(length=500), nullable=True),
    sa.Column('relinquished_property_value', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sale_date', sa.Date(), nullable=True),
    sa.Column('sale_proceeds', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('debt_retired', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('identification_deadline', sa.Date(), nullable=True),
    sa.Column('exchange_deadline', sa.Date(), nullable=True),
    sa.Column('identified_properties', sa.JSON(), nullable=True),
    sa.Column('replacement_property_address', sa.String(length=500), nullable=True),
    sa.Column('replacement_property_value', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('replacement_purchase_date', sa.Date(), nullable=True),
    sa.Column('boot_received', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('new_loan_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('qualified_intermediary', sa.String(length=255), nullable=True),
    sa.Column('qi_contact_info', sa.Text(), nullable=True),
    sa.Column('deferred_gain', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('basis_in_new_property', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('estimated_tax_savings', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('exchange_agreement_date', sa.Date(), nullable=True),
    sa.Column('exchange_agreement_file', sa.String(length=500), nullable=True),
    sa.Column('compliance_notes', sa.Text(), nullable=True),
    sa.Column('cpa_advisor', sa.String(length=255), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_exchange_1031_tracking_id'), 'exchange_1031_tracking', ['id'], unique=False)
    op.create_table('fair_housing_compliance',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('property_address', sa.String(length=500), nullable=False),
    sa.Column('compliance_check_date', sa.Date(), nullable=False),
    sa.Column('advertising_compliant', sa.Boolean(), nullable=True),
    sa.Column('advertising_notes', sa.Text(), nullable=True),
    sa.Column('application_process_compliant', sa.Boolean(), nullable=True),
    sa.Column('application_notes', sa.Text(), nullable=True),
    sa.Column('screening_criteria_compliant', sa.Boolean(), nullable=True),
    sa.Column('screening_notes', sa.Text(), nullable=True),
    sa.Column('reasonable_accommodation_policy', sa.Boolean(), nullable=True),
    sa.Column('accommodation_notes', sa.Text(), nullable=True),
    sa.Column('equal_opportunity_posting', sa.Boolean(), nullable=True),
    sa.Column('posting_location', sa.String(length=255), nullable=True),
    sa.Column('staff_training_completed', sa.Boolean(), nullable=True),
    sa.Column('training_date', sa.Date(), nullable=True),
    sa.Column('training_provider', sa.String(length=255), nullable=True),
    sa.Column('next_training_date', sa.Date(), nullable=True),
    sa.Column('policy_manual_updated', sa.Boolean(), nullable=True),
    sa.Column('policy_manual_version', sa.String(length=50), nullable=True),
    sa.Column('policy_manual_url', sa.String(length=500), nullable=True),
    sa.Column('violations_reported', sa.Boolean(), nullable=True),
    sa.Column('violation_details', sa.JSON(), nullable=True),
    sa.Column('remediation_plan', sa.Text(), nullable=True),
    sa.Column('remediation_completed', sa.Boolean(), nullable=True),
    sa.Column('compliance_status', sa.Enum('COMPLIANT', 'NON_COMPLIANT', 'UNDER_REVIEW', 'REMEDIATION', name='compliancestatus'), nullable=True),
    sa.Column('compliance_score', sa.Integer(), nullable=True),
    sa.Column('next_review_date', sa.Date(), nullable=True),
    sa.Column('reviewer_name', sa.String(length=255), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_fair_housing_compliance_id'), 'fair_housing_compliance', ['id'], unique=False)
    op.create_table('firpta_compliance',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('transaction_name', sa.String(length=255), nullable=False),
    sa.Column('property_address', sa.String(length=500), nullable=False),
    sa.Column('seller_name', sa.String(length=255), nullable=False),
    sa.Column('is_foreign_person', sa.Boolean(), nullable=False),
    sa.Column('seller_tin', sa.String(length=50), nullable=True),
    sa.Column('seller_country', sa.String(length=100), nullable=True),
    sa.Column('sale_price', sa.Numeric(precision=15, scale=2), nullable=False),
    sa.Column('sale_date', sa.Date(), nullable=True),
    sa.Column('property_type', sa.String(length=100), nullable=True),
    sa.Column('withholding_rate', sa.Float(), nullable=True),
    sa.Column('withholding_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('reduced_withholding_approved', sa.Boolean(), nullable=True),
    sa.Column('reduced_withholding_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('exemption_claimed', sa.Boolean(), nullable=True),
    sa.Column('exemption_type', sa.String(length=100), nullable=True),
    sa.Column('exemption_documentation', sa.String(length=500), nullable=True),
    sa.Column('form_8288_filed', sa.Boolean(), nullable=True),
    sa.Column('form_8288_filing_date', sa.Date(), nullable=True),
    sa.Column('form_8288a_issued', sa.Boolean(), nullable=True),
    sa.Column('form_8288b_filed', sa.Boolean(), nullable=True),
    sa.Column('withholding_payment_date', sa.Date(), nullable=True),
    sa.Column('withholding_payment_reference', sa.String(length=255), nullable=True),
    sa.Column('irs_confirmation_number', sa.String(length=100), nullable=True),
    sa.Column('compliance_status', sa.Enum('COMPLIANT', 'NON_COMPLIANT', 'UNDER_REVIEW', 'REMEDIATION', name='compliancestatus'), nullable=True),
    sa.Column('closing_attorney', sa.String(length=255), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_firpta_compliance_id'), 'firpta_compliance', ['id'], unique=False)
    op.create_table('investor_kyc_aml',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('investor_name', sa.String(length=255), nullable=False),
    sa.Column('investor_type', sa.String(length=100), nullable=True),
    sa.Column('investor_country', sa.String(length=100), nullable=True),
    sa.Column('identity_verified', sa.Boolean(), nullable=True),
    sa.Column('verification_method', sa.String(length=100), nullable=True),
    sa.Column('verification_date', sa.Date(), nullable=True),
    sa.Column('verification_provider', sa.String(length=255), nullable=True),
    sa.Column('government_id_collected', sa.Boolean(), nullable=True),
    sa.Column('proof_of_address_collected', sa.Boolean(), nullable=True),
    sa.Column('tax_id_collected', sa.Boolean(), nullable=True),
    sa.Column('entity_documents_collected', sa.Boolean(), nullable=True),
    sa.Column('accredited_investor', sa.Boolean(), nullable=True),
    sa.Column('accreditation_method', sa.String(length=100), nullable=True),
    sa.Column('accreditation_date', sa.Date(), nullable=True),
    sa.Column('accreditation_expiration', sa.Date(), nullable=True),
    sa.Column('source_of_funds_declared', sa.Boolean(), nullable=True),
    sa.Column('source_of_funds', sa.Text(), nullable=True),
    sa.Column('high_risk_jurisdiction', sa.Boolean(), nullable=True),
    sa.Column('pep_screening_completed', sa.Boolean(), nullable=True),
    sa.Column('pep_screening_date', sa.Date(), nullable=True),
    sa.Column('is_pep', sa.Boolean(), nullable=True),
    sa.Column('pep_details', sa.Text(), nullable=True),
    sa.Column('sanctions_screening_completed', sa.Boolean(), nullable=True),
    sa.Column('sanctions_screening_date', sa.Date(), nullable=True),
    sa.Column('sanctions_match_found', sa.Boolean(), nullable=True),
    sa.Column('sanctions_details', sa.Text(), nullable=True),
    sa.Column('risk_rating', sa.String(length=50), nullable=True),
    sa.Column('risk_factors', sa.JSON(), nullable=True),
    sa.Column('enhanced_due_diligence_required', sa.Boolean(), nullable=True),
    sa.Column('edd_completed', sa.Boolean(), nullable=True),
    sa.Column('last_review_date', sa.Date(), nullable=True),
    sa.Column('next_review_date', sa.Date(), nullable=True),
    sa.Column('monitoring_frequency', sa.String(length=50), nullable=True),
    sa.Column('kyc_status', sa.Enum('COMPLIANT', 'NON_COMPLIANT', 'UNDER_REVIEW', 'REMEDIATION', name='compliancestatus'), nullable=True),
    sa.Column('aml_status', sa.Enum('COMPLIANT', 'NON_COMPLIANT', 'UNDER_REVIEW', 'REMEDIATION', name='compliancestatus'), nullable=True),
    sa.Column('approved_for_investment', sa.Boolean(), nullable=True),
    sa.Column('approval_date', sa.Date(), nullable=True),
    sa.Column('approved_by', sa.String(length=255), nullable=True),
    sa.Column('suspicious_activity_reported', sa.Boolean(), nullable=True),
    sa.Column('sar_filing_date', sa.Date(), nullable=True),
    sa.Column('sar_reference_number', sa.String(length=100), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_investor_kyc_aml_id'), 'investor_kyc_aml', ['id'], unique=False)
    op.create_table('legal_holds',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('hold_name', sa.String(length=255), nullable=False),
    sa.Column('matter_name', sa.String(length=255), nullable=True),
    sa.Column('case_number', sa.String(length=100), nullable=True),
    sa.Column('hold_issued_date', sa.Date(), nullable=False),
    sa.Column('hold_issued_by', sa.String(length=255), nullable=True),
    sa.Column('hold_reason', sa.Text(), nullable=False),
    sa.Column('custodians', sa.JSON(), nullable=True),
    sa.Column('properties_affected', sa.JSON(), nullable=True),
    sa.Column('document_types', sa.JSON(), nullable=True),
    sa.Column('date_range_start', sa.Date(), nullable=True),
    sa.Column('date_range_end', sa.Date(), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('release_date', sa.Date(), nullable=True),
    sa.Column('release_authorized_by', sa.String(length=255), nullable=True),
    sa.Column('notification_sent', sa.Boolean(), nullable=True),
    sa.Column('notification_date', sa.DateTime(), nullable=True),
    sa.Column('acknowledgments_required', sa.Boolean(), nullable=True),
    sa.Column('acknowledgments_received', sa.JSON(), nullable=True),
    sa.Column('documents_preserved', sa.Integer(), nullable=True),
    sa.Column('last_compliance_check', sa.Date(), nullable=True),
    sa.Column('compliance_notes', sa.Text(), nullable=True),
    sa.Column('law_firm', sa.String(length=255), nullable=True),
    sa.Column('attorney_name', sa.String(length=255), nullable=True),
    sa.Column('attorney_contact', sa.String(length=255), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_legal_holds_id'), 'legal_holds', ['id'], unique=False)
    op.create_table('official_data_records',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('dataset_id', sa.Integer(), nullable=False),
    sa.Column('record_id', sa.String(length=255), nullable=True),
    sa.Column('data_type', sa.String(length=100), nullable=True),
    sa.Column('category', sa.String(length=100), nullable=True),
    sa.Column('country', sa.String(length=2), nullable=True),
    sa.Column('state', sa.String(length=100), nullable=True),
    sa.Column('county', sa.String(length=100), nullable=True),
    sa.Column('city', sa.String(length=100), nullable=True),
    sa.Column('zip_code', sa.String(length=20), nullable=True),
    sa.Column('metro_area', sa.String(length=255), nullable=True),
    sa.Column('data_year', sa.Integer(), nullable=True),
    sa.Column('data_quarter', sa.Integer(), nullable=True),
    sa.Column('data_month', sa.Integer(), nullable=True),
    sa.Column('data_date', sa.DateTime(), nullable=True),
    sa.Column('period_start', sa.DateTime(), nullable=True),
    sa.Column('period_end', sa.DateTime(), nullable=True),
    sa.Column('value', sa.Float(), nullable=True),
    sa.Column('value_type', sa.String(length=100), nullable=True),
    sa.Column('data', sa.JSON(), nullable=True),
    sa.Column('source_url', sa.String(length=500), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['dataset_id'], ['official_datasets.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_official_data_records_category'), 'official_data_records', ['category'], unique=False)
    op.create_index(op.f('ix_official_data_records_city'), 'official_data_records', ['city'], unique=False)
    op.create_index(op.f('ix_official_data_records_country'), 'official_data_records', ['country'], unique=False)
    op.create_index(op.f('ix_official_data_records_county'), 'official_data_records', ['county'], unique=False)
    op.create_index(op.f('ix_official_data_records_data_type'), 'official_data_records', ['data_type'], unique=False)
    op.create_index(op.f('ix_official_data_records_data_year'), 'official_data_records', ['data_year'], unique=False)
    op.create_index(op.f('ix_official_data_records_dataset_id'), 'official_data_records', ['dataset_id'], unique=False)
    op.create_index(op.f('ix_official_data_records_id'), 'official_data_records', ['id'], unique=False)
    op.create_index(op.f('ix_official_data_records_record_id'), 'official_data_records', ['record_id'], unique=False)
    op.create_index(op.f('ix_official_data_records_state'), 'official_data_records', ['state'], unique=False)
    op.create_index(op.f('ix_official_data_records_zip_code'), 'official_data_records', ['zip_code'], unique=False)
    op.create_table('opportunity_zone_investments',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('investment_name', sa.String(length=255), nullable=False),
    sa.Column('status', sa.Enum('ELIGIBLE', 'INVESTED', 'HOLDING', 'EXITED', name='opportunityzonestatus'), nullable=True),
    sa.Column('property_address', sa.String(length=500), nullable=False),
    sa.Column('census_tract', sa.String(length=50), nullable=True),
    sa.Column('opportunity_zone_designation_date', sa.Date(), nullable=True),
    sa.Column('investment_date', sa.Date(), nullable=False),
    sa.Column('investment_amount', sa.Numeric(precision=15, scale=2), nullable=False),
    sa.Column('capital_gain_invested', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('capital_gain_date', sa.Date(), nullable=True),
    sa.Column('required_hold_date', sa.Date(), nullable=True),
    sa.Column('five_year_milestone', sa.Date(), nullable=True),
    sa.Column('seven_year_milestone', sa.Date(), nullable=True),
    sa.Column('deferral_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deferral_expiration_date', sa.Date(), nullable=True),
    sa.Column('basis_step_up_5yr', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('basis_step_up_7yr', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('estimated_tax_free_gain', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('qozb_fund_name', sa.String(length=255), nullable=True),
    sa.Column('qozb_ein', sa.String(length=20), nullable=True),
    sa.Column('investment_vehicle', sa.String(length=100), nullable=True),
    sa.Column('form_8949_filed', sa.Boolean(), nullable=True),
    sa.Column('form_8997_filed', sa.Boolean(), nullable=True),
    sa.Column('annual_certification_date', sa.Date(), nullable=True),
    sa.Column('compliance_notes', sa.Text(), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_opportunity_zone_investments_id'), 'opportunity_zone_investments', ['id'], unique=False)
    op.create_table('soc2_compliance',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('assessment_name', sa.String(length=255), nullable=False),
    sa.Column('soc2_type', sa.String(length=50), nullable=True),
    sa.Column('security_compliant', sa.Boolean(), nullable=True),
    sa.Column('security_score', sa.Integer(), nullable=True),
    sa.Column('availability_compliant', sa.Boolean(), nullable=True),
    sa.Column('availability_score', sa.Integer(), nullable=True),
    sa.Column('processing_integrity_compliant', sa.Boolean(), nullable=True),
    sa.Column('processing_integrity_score', sa.Integer(), nullable=True),
    sa.Column('confidentiality_compliant', sa.Boolean(), nullable=True),
    sa.Column('confidentiality_score', sa.Integer(), nullable=True),
    sa.Column('privacy_compliant', sa.Boolean(), nullable=True),
    sa.Column('privacy_score', sa.Integer(), nullable=True),
    sa.Column('overall_readiness_score', sa.Integer(), nullable=True),
    sa.Column('compliance_status', sa.Enum('COMPLIANT', 'NON_COMPLIANT', 'UNDER_REVIEW', 'REMEDIATION', name='compliancestatus'), nullable=True),
    sa.Column('total_controls', sa.Integer(), nullable=True),
    sa.Column('implemented_controls', sa.Integer(), nullable=True),
    sa.Column('controls_list', sa.JSON(), nullable=True),
    sa.Column('gaps_identified', sa.Integer(), nullable=True),
    sa.Column('critical_gaps', sa.Integer(), nullable=True),
    sa.Column('gaps_details', sa.JSON(), nullable=True),
    sa.Column('remediation_plan', sa.JSON(), nullable=True),
    sa.Column('remediation_progress', sa.Integer(), nullable=True),
    sa.Column('target_completion_date', sa.Date(), nullable=True),
    sa.Column('audit_scheduled', sa.Boolean(), nullable=True),
    sa.Column('audit_date', sa.Date(), nullable=True),
    sa.Column('auditor_firm', sa.String(length=255), nullable=True),
    sa.Column('audit_completed', sa.Boolean(), nullable=True),
    sa.Column('certification_received', sa.Boolean(), nullable=True),
    sa.Column('certification_date', sa.Date(), nullable=True),
    sa.Column('certification_expiration', sa.Date(), nullable=True),
    sa.Column('last_assessment_date', sa.Date(), nullable=True),
    sa.Column('next_assessment_date', sa.Date(), nullable=True),
    sa.Column('monitoring_tools', sa.JSON(), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_soc2_compliance_id'), 'soc2_compliance', ['id'], unique=False)
    op.create_table('statute_limitations_tracker',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('matter_type', sa.String(length=100), nullable=False),
    sa.Column('claim_description', sa.Text(), nullable=False),
    sa.Column('claimant', sa.String(length=255), nullable=True),
    sa.Column('respondent', sa.String(length=255), nullable=True),
    sa.Column('property_address', sa.String(length=500), nullable=True),
    sa.Column('incident_date', sa.Date(), nullable=False),
    sa.Column('discovery_date', sa.Date(), nullable=True),
    sa.Column('jurisdiction', sa.String(length=100), nullable=False),
    sa.Column('statute_period_years', sa.Integer(), nullable=True),
    sa.Column('statute_deadline', sa.Date(), nullable=False),
    sa.Column('tolling_periods', sa.JSON(), nullable=True),
    sa.Column('extended_deadline', sa.Date(), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('claim_filed', sa.Boolean(), nullable=True),
    sa.Column('filing_date', sa.Date(), nullable=True),
    sa.Column('case_number', sa.String(length=100), nullable=True),
    sa.Column('alert_60_days', sa.Boolean(), nullable=True),
    sa.Column('alert_30_days', sa.Boolean(), nullable=True),
    sa.Column('alert_7_days', sa.Boolean(), nullable=True),
    sa.Column('last_alert_sent', sa.Date(), nullable=True),
    sa.Column('attorney_assigned', sa.String(length=255), nullable=True),
    sa.Column('law_firm', sa.String(length=255), nullable=True),
    sa.Column('notes', sa.Text(), nullable=True),
    sa.Column('company_id', sa.UUID(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_statute_limitations_tracker_id'), 'statute_limitations_tracker', ['id'], unique=False)
    op.drop_index('idx_hot_zone', table_name='hot_zone_markets')
    op.drop_index('ix_hot_zone_markets_hot_zone_rank', table_name='hot_zone_markets')
    op.drop_index('ix_hot_zone_markets_id', table_name='hot_zone_markets')
    op.drop_index('ix_hot_zone_markets_market_name', table_name='hot_zone_markets')
    op.drop_index('ix_hot_zone_markets_metric_category', table_name='hot_zone_markets')
    op.drop_index('ix_hot_zone_markets_metric_name', table_name='hot_zone_markets')
    op.drop_index('ix_hot_zone_markets_neighborhood_name', table_name='hot_zone_markets')
    op.drop_index('ix_hot_zone_markets_period', table_name='hot_zone_markets')
    op.drop_table('hot_zone_markets')
    op.drop_index('ix_str_host_economics_host_type', table_name='str_host_economics')
    op.drop_index('ix_str_host_economics_id', table_name='str_host_economics')
    op.drop_index('ix_str_host_economics_market', table_name='str_host_economics')
    op.drop_index('ix_str_host_economics_period', table_name='str_host_economics')
    op.drop_table('str_host_economics')
    op.drop_index('ix_markitdown_analytics_date', table_name='markitdown_analytics')
    op.drop_table('markitdown_analytics')
    op.drop_index('ix_due_diligence_items_company_id', table_name='due_diligence_items')
    op.drop_table('due_diligence_items')
    op.drop_index('idx_comp_trans', table_name='comparable_transactions')
    op.drop_index('ix_comparable_transactions_city', table_name='comparable_transactions')
    op.drop_index('ix_comparable_transactions_deal_type', table_name='comparable_transactions')
    op.drop_index('ix_comparable_transactions_id', table_name='comparable_transactions')
    op.drop_index('ix_comparable_transactions_property_class', table_name='comparable_transactions')
    op.drop_index('ix_comparable_transactions_property_type', table_name='comparable_transactions')
    op.drop_index('ix_comparable_transactions_sale_date', table_name='comparable_transactions')
    op.drop_index('ix_comparable_transactions_state', table_name='comparable_transactions')
    op.drop_index('ix_comparable_transactions_submarket', table_name='comparable_transactions')
    op.drop_index('ix_comparable_transactions_zip_code', table_name='comparable_transactions')
    op.drop_table('comparable_transactions')
    op.drop_index('ix_documents_company_id', table_name='documents')
    op.drop_table('documents')
    op.drop_index('ix_underbuilt_parcels_analysis_date', table_name='underbuilt_parcels')
    op.drop_index('ix_underbuilt_parcels_id', table_name='underbuilt_parcels')
    op.drop_index('ix_underbuilt_parcels_market', table_name='underbuilt_parcels')
    op.drop_index('ix_underbuilt_parcels_zone_type', table_name='underbuilt_parcels')
    op.drop_table('underbuilt_parcels')
    op.drop_index('ix_str_pricing_patterns_id', table_name='str_pricing_patterns')
    op.drop_index('ix_str_pricing_patterns_market', table_name='str_pricing_patterns')
    op.drop_index('ix_str_pricing_patterns_period', table_name='str_pricing_patterns')
    op.drop_index('ix_str_pricing_patterns_property_type', table_name='str_pricing_patterns')
    op.drop_index('ix_str_pricing_patterns_season', table_name='str_pricing_patterns')
    op.drop_table('str_pricing_patterns')
    op.drop_index('idx_zoning_district', table_name='zoning_districts')
    op.drop_index('ix_zoning_districts_effective_date', table_name='zoning_districts')
    op.drop_index('ix_zoning_districts_id', table_name='zoning_districts')
    op.drop_index('ix_zoning_districts_market', table_name='zoning_districts')
    op.drop_index('ix_zoning_districts_zone_code', table_name='zoning_districts')
    op.drop_index('ix_zoning_districts_zone_type', table_name='zoning_districts')
    op.drop_table('zoning_districts')
    op.drop_index('ix_value_creation_initiatives_company_id', table_name='value_creation_initiatives')
    op.drop_table('value_creation_initiatives')
    op.drop_index('idx_str_performance', table_name='str_performance_metrics')
    op.drop_index('ix_str_performance_metrics_id', table_name='str_performance_metrics')
    op.drop_index('ix_str_performance_metrics_market', table_name='str_performance_metrics')
    op.drop_index('ix_str_performance_metrics_period', table_name='str_performance_metrics')
    op.drop_index('ix_str_performance_metrics_property_type', table_name='str_performance_metrics')
    op.drop_table('str_performance_metrics')
    op.drop_index('ix_audit_logs_user_id', table_name='audit_logs')
    op.drop_table('audit_logs')
    op.drop_index('ix_str_market_overview_analysis_date', table_name='str_market_overview')
    op.drop_index('ix_str_market_overview_id', table_name='str_market_overview')
    op.drop_index('ix_str_market_overview_market', table_name='str_market_overview')
    op.drop_table('str_market_overview')
    op.drop_index('ix_development_pipeline_id', table_name='development_pipeline')
    op.drop_index('ix_development_pipeline_market', table_name='development_pipeline')
    op.drop_index('ix_development_pipeline_period', table_name='development_pipeline')
    op.drop_index('ix_development_pipeline_zone_type', table_name='development_pipeline')
    op.drop_table('development_pipeline')
    op.drop_index('ix_str_competitive_analysis_id', table_name='str_competitive_analysis')
    op.drop_index('ix_str_competitive_analysis_market', table_name='str_competitive_analysis')
    op.drop_index('ix_str_competitive_analysis_period', table_name='str_competitive_analysis')
    op.drop_table('str_competitive_analysis')
    op.drop_index('ix_opportunity_zones_id', table_name='opportunity_zones')
    op.drop_index('ix_opportunity_zones_market', table_name='opportunity_zones')
    op.drop_index('ix_opportunity_zones_period', table_name='opportunity_zones')
    op.drop_table('opportunity_zones')
    op.drop_index('ix_company_kpis_company_id', table_name='company_kpis')
    op.drop_index('ix_company_kpis_period_date', table_name='company_kpis')
    op.drop_table('company_kpis')
    op.drop_index('ix_markitdown_content_document_id', table_name='markitdown_content')
    op.drop_table('markitdown_content')
    op.drop_index('idx_neighborhood_score', table_name='neighborhood_scores')
    op.drop_index('ix_neighborhood_scores_id', table_name='neighborhood_scores')
    op.drop_index('ix_neighborhood_scores_market_name', table_name='neighborhood_scores')
    op.drop_index('ix_neighborhood_scores_neighborhood_name', table_name='neighborhood_scores')
    op.drop_index('ix_neighborhood_scores_period', table_name='neighborhood_scores')
    op.drop_index('ix_neighborhood_scores_score_category', table_name='neighborhood_scores')
    op.drop_table('neighborhood_scores')
    op.drop_index('ix_markitdown_batches_status', table_name='markitdown_batches')
    op.drop_table('markitdown_batches')
    op.drop_index('idx_tenant_credit', table_name='tenant_credit_quality')
    op.drop_index('ix_tenant_credit_quality_category', table_name='tenant_credit_quality')
    op.drop_index('ix_tenant_credit_quality_id', table_name='tenant_credit_quality')
    op.drop_index('ix_tenant_credit_quality_metric_name', table_name='tenant_credit_quality')
    op.drop_index('ix_tenant_credit_quality_period', table_name='tenant_credit_quality')
    op.drop_index('ix_tenant_credit_quality_tenant_name', table_name='tenant_credit_quality')
    op.drop_index('ix_tenant_credit_quality_ticker', table_name='tenant_credit_quality')
    op.drop_table('tenant_credit_quality')
    op.drop_index('ix_str_investment_analysis_id', table_name='str_investment_analysis')
    op.drop_index('ix_str_investment_analysis_market', table_name='str_investment_analysis')
    op.drop_index('ix_str_investment_analysis_period', table_name='str_investment_analysis')
    op.drop_index('ix_str_investment_analysis_property_type', table_name='str_investment_analysis')
    op.drop_table('str_investment_analysis')
    op.drop_index('ix_str_regulatory_environment_effective_date', table_name='str_regulatory_environment')
    op.drop_index('ix_str_regulatory_environment_enforcement_level', table_name='str_regulatory_environment')
    op.drop_index('ix_str_regulatory_environment_id', table_name='str_regulatory_environment')
    op.drop_index('ix_str_regulatory_environment_market', table_name='str_regulatory_environment')
    op.drop_index('ix_str_regulatory_environment_regulation_type', table_name='str_regulatory_environment')
    op.drop_table('str_regulatory_environment')
    op.drop_index('idx_str_hot_neighborhood', table_name='str_hot_neighborhoods')
    op.drop_index('ix_str_hot_neighborhoods_analysis_date', table_name='str_hot_neighborhoods')
    op.drop_index('ix_str_hot_neighborhoods_growth_stage', table_name='str_hot_neighborhoods')
    op.drop_index('ix_str_hot_neighborhoods_id', table_name='str_hot_neighborhoods')
    op.drop_index('ix_str_hot_neighborhoods_market', table_name='str_hot_neighborhoods')
    op.drop_index('ix_str_hot_neighborhoods_neighborhood_name', table_name='str_hot_neighborhoods')
    op.drop_index('ix_str_hot_neighborhoods_neighborhood_rank', table_name='str_hot_neighborhoods')
    op.drop_index('ix_str_hot_neighborhoods_revenue_category', table_name='str_hot_neighborhoods')
    op.drop_table('str_hot_neighborhoods')
    op.drop_index('ix_transit_oriented_development_id', table_name='transit_oriented_development')
    op.drop_index('ix_transit_oriented_development_market', table_name='transit_oriented_development')
    op.drop_index('ix_transit_oriented_development_period', table_name='transit_oriented_development')
    op.drop_index('ix_transit_oriented_development_tod_zone_name', table_name='transit_oriented_development')
    op.drop_index('ix_transit_oriented_development_transit_type', table_name='transit_oriented_development')
    op.drop_table('transit_oriented_development')
    op.drop_index('ix_zoning_master_metrics_id', table_name='zoning_master_metrics')
    op.drop_index('ix_zoning_master_metrics_market', table_name='zoning_master_metrics')
    op.drop_index('ix_zoning_master_metrics_metric_category', table_name='zoning_master_metrics')
    op.drop_index('ix_zoning_master_metrics_metric_name', table_name='zoning_master_metrics')
    op.drop_index('ix_zoning_master_metrics_period', table_name='zoning_master_metrics')
    op.drop_table('zoning_master_metrics')
    op.drop_index('ix_property_tax_assessments_geography_type', table_name='property_tax_assessments')
    op.drop_index('ix_property_tax_assessments_id', table_name='property_tax_assessments')
    op.drop_index('ix_property_tax_assessments_indicator_name', table_name='property_tax_assessments')
    op.drop_index('ix_property_tax_assessments_market', table_name='property_tax_assessments')
    op.drop_table('property_tax_assessments')
    op.drop_index('ix_str_guest_demographics_guest_origin', table_name='str_guest_demographics')
    op.drop_index('ix_str_guest_demographics_id', table_name='str_guest_demographics')
    op.drop_index('ix_str_guest_demographics_market', table_name='str_guest_demographics')
    op.drop_index('ix_str_guest_demographics_period', table_name='str_guest_demographics')
    op.drop_index('ix_str_guest_demographics_purpose_of_visit', table_name='str_guest_demographics')
    op.drop_table('str_guest_demographics')
    op.drop_index('ix_str_platform_performance_id', table_name='str_platform_performance')
    op.drop_index('ix_str_platform_performance_market', table_name='str_platform_performance')
    op.drop_index('ix_str_platform_performance_period', table_name='str_platform_performance')
    op.drop_index('ix_str_platform_performance_platform_name', table_name='str_platform_performance')
    op.drop_table('str_platform_performance')
    op.drop_index('ix_financial_metrics_company_id', table_name='financial_metrics')
    op.drop_index('ix_financial_metrics_fiscal_year', table_name='financial_metrics')
    op.drop_index('ix_financial_metrics_period_date', table_name='financial_metrics')
    op.drop_table('financial_metrics')
    op.drop_index('idx_timeseries', table_name='time_series_indicators')
    op.drop_index('ix_time_series_indicators_date', table_name='time_series_indicators')
    op.drop_index('ix_time_series_indicators_id', table_name='time_series_indicators')
    op.drop_index('ix_time_series_indicators_indicator_name', table_name='time_series_indicators')
    op.drop_index('ix_time_series_indicators_period_type', table_name='time_series_indicators')
    op.drop_index('ix_time_series_indicators_source_category', table_name='time_series_indicators')
    op.drop_table('time_series_indicators')
    op.drop_index('ix_str_housing_market_impact_id', table_name='str_housing_market_impact')
    op.drop_index('ix_str_housing_market_impact_market', table_name='str_housing_market_impact')
    op.drop_index('ix_str_housing_market_impact_period', table_name='str_housing_market_impact')
    op.drop_table('str_housing_market_impact')
    op.drop_index('ix_valuations_company_id', table_name='valuations')
    op.drop_index('ix_valuations_valuation_date', table_name='valuations')
    op.drop_table('valuations')
    op.drop_index('idx_geo_indicator', table_name='geographic_economic_indicators')
    op.drop_index('ix_geographic_economic_indicators_geography', table_name='geographic_economic_indicators')
    op.drop_index('ix_geographic_economic_indicators_geography_type', table_name='geographic_economic_indicators')
    op.drop_index('ix_geographic_economic_indicators_id', table_name='geographic_economic_indicators')
    op.drop_index('ix_geographic_economic_indicators_indicator_name', table_name='geographic_economic_indicators')
    op.drop_index('ix_geographic_economic_indicators_period', table_name='geographic_economic_indicators')
    op.drop_table('geographic_economic_indicators')
    op.drop_index('ix_str_supply_demand_dynamics_id', table_name='str_supply_demand_dynamics')
    op.drop_index('ix_str_supply_demand_dynamics_market', table_name='str_supply_demand_dynamics')
    op.drop_index('ix_str_supply_demand_dynamics_market_saturation_level', table_name='str_supply_demand_dynamics')
    op.drop_index('ix_str_supply_demand_dynamics_period', table_name='str_supply_demand_dynamics')
    op.drop_table('str_supply_demand_dynamics')
    op.drop_index('ix_land_cost_economics_id', table_name='land_cost_economics')
    op.drop_index('ix_land_cost_economics_market', table_name='land_cost_economics')
    op.drop_index('ix_land_cost_economics_period', table_name='land_cost_economics')
    op.drop_index('ix_land_cost_economics_zone_type', table_name='land_cost_economics')
    op.drop_table('land_cost_economics')
    op.drop_index('idx_market_metric', table_name='real_estate_market_data')
    op.drop_index('ix_real_estate_market_data_id', table_name='real_estate_market_data')
    op.drop_index('ix_real_estate_market_data_market_name', table_name='real_estate_market_data')
    op.drop_index('ix_real_estate_market_data_metric_name', table_name='real_estate_market_data')
    op.drop_index('ix_real_estate_market_data_period', table_name='real_estate_market_data')
    op.drop_index('ix_real_estate_market_data_property_class', table_name='real_estate_market_data')
    op.drop_index('ix_real_estate_market_data_property_type', table_name='real_estate_market_data')
    op.drop_index('ix_real_estate_market_data_submarket_name', table_name='real_estate_market_data')
    op.drop_table('real_estate_market_data')
    op.drop_index('ix_str_compliance_enforcement_enforcement_level', table_name='str_compliance_enforcement')
    op.drop_index('ix_str_compliance_enforcement_id', table_name='str_compliance_enforcement')
    op.drop_index('ix_str_compliance_enforcement_market', table_name='str_compliance_enforcement')
    op.drop_index('ix_str_compliance_enforcement_period', table_name='str_compliance_enforcement')
    op.drop_table('str_compliance_enforcement')
    op.drop_index('ix_entitled_land_inventory_development_status', table_name='entitled_land_inventory')
    op.drop_index('ix_entitled_land_inventory_id', table_name='entitled_land_inventory')
    op.drop_index('ix_entitled_land_inventory_market', table_name='entitled_land_inventory')
    op.drop_index('ix_entitled_land_inventory_period', table_name='entitled_land_inventory')
    op.drop_index('ix_entitled_land_inventory_project_type', table_name='entitled_land_inventory')
    op.drop_index('ix_entitled_land_inventory_zone_type', table_name='entitled_land_inventory')
    op.drop_table('entitled_land_inventory')
    op.drop_index('ix_regulatory_barriers_barrier_type', table_name='regulatory_barriers')
    op.drop_index('ix_regulatory_barriers_id', table_name='regulatory_barriers')
    op.drop_index('ix_regulatory_barriers_market', table_name='regulatory_barriers')
    op.drop_index('ix_regulatory_barriers_period', table_name='regulatory_barriers')
    op.drop_index('ix_regulatory_barriers_severity_rating', table_name='regulatory_barriers')
    op.drop_table('regulatory_barriers')
    op.drop_index('idx_market_data_composite', table_name='market_data')
    op.drop_index('idx_market_data_market', table_name='market_data')
    op.drop_index('idx_market_data_metric', table_name='market_data')
    op.drop_index('idx_market_data_period', table_name='market_data')
    op.drop_index('idx_market_data_submarket', table_name='market_data')
    op.drop_index('idx_market_data_type', table_name='market_data')
    op.drop_table('market_data')
    op.drop_index('ix_zoning_reforms_effective_date', table_name='zoning_reforms')
    op.drop_index('ix_zoning_reforms_id', table_name='zoning_reforms')
    op.drop_index('ix_zoning_reforms_market', table_name='zoning_reforms')
    op.drop_table('zoning_reforms')
    op.drop_index('ix_portfolio_companies_company_name', table_name='portfolio_companies')
    op.drop_index('ix_portfolio_companies_company_status', table_name='portfolio_companies')
    op.drop_index('ix_portfolio_companies_fund_id', table_name='portfolio_companies')
    op.drop_index('ix_portfolio_companies_investment_date', table_name='portfolio_companies')
    op.drop_index('ix_portfolio_companies_sector', table_name='portfolio_companies')
    op.drop_table('portfolio_companies')
    op.drop_index('ix_future_zoning_initiatives_approval_likelihood', table_name='future_zoning_initiatives')
    op.drop_index('ix_future_zoning_initiatives_id', table_name='future_zoning_initiatives')
    op.drop_index('ix_future_zoning_initiatives_initiative_type', table_name='future_zoning_initiatives')
    op.drop_index('ix_future_zoning_initiatives_market', table_name='future_zoning_initiatives')
    op.drop_index('ix_future_zoning_initiatives_period', table_name='future_zoning_initiatives')
    op.drop_table('future_zoning_initiatives')
    op.drop_index('ix_markitdown_versions_document_id', table_name='markitdown_versions')
    op.drop_table('markitdown_versions')
    op.drop_index('ix_markitdown_documents_company_id', table_name='markitdown_documents')
    op.drop_index('ix_markitdown_documents_conversion_status', table_name='markitdown_documents')
    op.drop_index('ix_markitdown_documents_file_hash', table_name='markitdown_documents')
    op.drop_index('ix_markitdown_documents_file_type', table_name='markitdown_documents')
    op.drop_index('ix_markitdown_documents_has_errors', table_name='markitdown_documents')
    op.drop_index('ix_markitdown_documents_needs_review', table_name='markitdown_documents')
    op.drop_table('markitdown_documents')
    op.drop_index('idx_accprof_company', table_name='accounting_profiles')
    op.create_unique_constraint(None, 'accounting_profiles', ['id'])
    op.drop_index('idx_acctrans_profile_date', table_name='accounting_transactions')
    op.drop_index('idx_acctrans_type', table_name='accounting_transactions')
    op.create_unique_constraint(None, 'accounting_transactions', ['id'])
    op.create_unique_constraint(None, 'amortization_schedule_entries', ['id'])
    op.alter_column('benchmarks', 'metric_name',
               existing_type=sa.VARCHAR(length=100),
               comment='IRR, MOIC, occupancy, etc.',
               existing_nullable=False)
    op.alter_column('benchmarks', 'value_range_min',
               existing_type=sa.NUMERIC(precision=20, scale=2),
               comment='Lower bound',
               existing_nullable=True)
    op.alter_column('benchmarks', 'value_range_max',
               existing_type=sa.NUMERIC(precision=20, scale=2),
               comment='Upper bound',
               existing_nullable=True)
    op.alter_column('benchmarks', 'geography',
               existing_type=sa.VARCHAR(length=100),
               comment='National, regional, city',
               existing_nullable=True)
    op.alter_column('benchmarks', 'property_type',
               existing_type=sa.VARCHAR(length=50),
               comment='Asset class',
               existing_nullable=True)
    op.alter_column('benchmarks', 'time_period',
               existing_type=sa.VARCHAR(length=50),
               comment='Quarter, year, etc.',
               existing_nullable=True)
    op.alter_column('benchmarks', 'peer_group_definition',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Criteria for peer selection',
               existing_nullable=True)
    op.alter_column('benchmarks', 'peer_count',
               existing_type=sa.INTEGER(),
               comment='Number of peers in comparison',
               existing_nullable=True)
    op.alter_column('benchmarks', 'data_source',
               existing_type=sa.VARCHAR(length=200),
               comment='NCREIF, NAREIT, custom, etc.',
               existing_nullable=True)
    op.alter_column('benchmarks', 'confidence_level',
               existing_type=sa.VARCHAR(length=20),
               comment='high, medium, low',
               existing_nullable=True)
    op.alter_column('benchmarks', 'percentile_50',
               existing_type=sa.NUMERIC(precision=20, scale=2),
               comment='Median',
               existing_nullable=True)
    op.alter_column('benchmarks', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('benchmarks', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.drop_index('idx_benchmarks_type_source', table_name='benchmarks')
    op.create_index('idx_benchmark_metric_date', 'benchmarks', ['metric_name', 'as_of_date'], unique=False)
    op.create_index('idx_benchmark_type_active', 'benchmarks', ['benchmark_type', 'is_active'], unique=False)
    op.create_index(op.f('ix_benchmarks_as_of_date'), 'benchmarks', ['as_of_date'], unique=False)
    op.create_index(op.f('ix_benchmarks_benchmark_type'), 'benchmarks', ['benchmark_type'], unique=False)
    op.create_index(op.f('ix_benchmarks_company_id'), 'benchmarks', ['company_id'], unique=False)
    op.create_index(op.f('ix_benchmarks_metric_name'), 'benchmarks', ['metric_name'], unique=False)
    op.create_unique_constraint(None, 'benchmarks', ['id'])
    op.drop_index('idx_brokers_company_id', table_name='brokers')
    op.create_index(op.f('ix_brokers_company_id'), 'brokers', ['company_id'], unique=False)
    op.create_unique_constraint(None, 'brokers', ['id'])
    op.create_unique_constraint(None, 'budget_items', ['id'])
    op.create_unique_constraint(None, 'capital_call_items', ['id'])
    op.drop_index('idx_capcalls_due_date', table_name='capital_calls')
    op.drop_index('idx_capcalls_fund_status', table_name='capital_calls')
    op.create_unique_constraint(None, 'capital_calls', ['id'])
    op.alter_column('cash_flow_projections', 'projection_month',
               existing_type=sa.INTEGER(),
               comment='Month offset from creation (0-12 for rolling 12)',
               existing_nullable=False)
    op.alter_column('cash_flow_projections', 'confidence_level',
               existing_type=sa.VARCHAR(length=20),
               comment='high, medium, low',
               existing_nullable=True)
    op.alter_column('cash_flow_projections', 'scenario',
               existing_type=sa.VARCHAR(length=50),
               comment='base, optimistic, pessimistic',
               existing_nullable=True)
    op.alter_column('cash_flow_projections', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('cash_flow_projections', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.create_index('idx_cashflow_proj_company', 'cash_flow_projections', ['company_id', 'projection_date'], unique=False)
    op.create_index('idx_cashflow_proj_date', 'cash_flow_projections', ['projection_date', 'projection_month'], unique=False)
    op.create_index(op.f('ix_cash_flow_projections_company_id'), 'cash_flow_projections', ['company_id'], unique=False)
    op.create_index(op.f('ix_cash_flow_projections_fund_id'), 'cash_flow_projections', ['fund_id'], unique=False)
    op.create_index(op.f('ix_cash_flow_projections_projection_date'), 'cash_flow_projections', ['projection_date'], unique=False)
    op.create_index(op.f('ix_cash_flow_projections_property_id'), 'cash_flow_projections', ['property_id'], unique=False)
    op.create_unique_constraint(None, 'cash_flow_projections', ['id'])
    op.create_unique_constraint(None, 'chart_of_accounts', ['id'])
    op.create_unique_constraint(None, 'companies', ['id'])
    op.create_unique_constraint(None, 'comparable_companies', ['id'])
    op.create_unique_constraint(None, 'competitive_properties', ['id'])
    op.alter_column('comps', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this comp belongs to (for multi-tenancy)',
               existing_comment='Company this comparable property belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_index('idx_comps_company_id', table_name='comps')
    op.create_index(op.f('ix_comps_company_id'), 'comps', ['company_id'], unique=False)
    op.create_unique_constraint(None, 'comps', ['id'])
    op.alter_column('custom_kpis', 'formula',
               existing_type=sa.TEXT(),
               comment='Custom formula for calculation',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'data_sources',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Data sources for calculation',
               existing_nullable=False)
    op.alter_column('custom_kpis', 'aggregation_period',
               existing_type=sa.VARCHAR(length=20),
               comment='daily, weekly, monthly, quarterly, yearly',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'calculation_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Additional calculation parameters',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'unit',
               existing_type=sa.VARCHAR(length=20),
               comment='%, $, units, etc.',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'prefix',
               existing_type=sa.VARCHAR(length=10),
               comment='$ or other prefix',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'suffix',
               existing_type=sa.VARCHAR(length=10),
               comment='% or other suffix',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'shared_with_users',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='List of user IDs',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('custom_kpis', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.drop_index('idx_kpis_company', table_name='custom_kpis')
    op.create_index('idx_kpi_company_active', 'custom_kpis', ['company_id', 'is_active'], unique=False)
    op.create_index('idx_kpi_user_category', 'custom_kpis', ['user_id', 'category'], unique=False)
    op.create_index(op.f('ix_custom_kpis_category'), 'custom_kpis', ['category'], unique=False)
    op.create_index(op.f('ix_custom_kpis_company_id'), 'custom_kpis', ['company_id'], unique=False)
    op.create_index(op.f('ix_custom_kpis_user_id'), 'custom_kpis', ['user_id'], unique=False)
    op.create_unique_constraint(None, 'custom_kpis', ['id'])
    op.create_unique_constraint(None, 'custom_markets', ['id'])
    op.alter_column('dashboard_filters', 'filter_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Filter values and operators',
               existing_nullable=False)
    op.alter_column('dashboard_filters', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('dashboard_filters', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.create_index('idx_filter_dashboard_user', 'dashboard_filters', ['dashboard_id', 'user_id'], unique=False)
    op.create_index(op.f('ix_dashboard_filters_dashboard_id'), 'dashboard_filters', ['dashboard_id'], unique=False)
    op.create_index(op.f('ix_dashboard_filters_user_id'), 'dashboard_filters', ['user_id'], unique=False)
    op.create_unique_constraint(None, 'dashboard_filters', ['id'])
    op.alter_column('dashboard_widgets', 'width',
               existing_type=sa.INTEGER(),
               comment='Grid units',
               existing_nullable=False)
    op.alter_column('dashboard_widgets', 'height',
               existing_type=sa.INTEGER(),
               comment='Grid units',
               existing_nullable=False)
    op.alter_column('dashboard_widgets', 'data_source',
               existing_type=sa.VARCHAR(length=100),
               comment='API endpoint or data source',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'data_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Query parameters and data configuration',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'chart_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Chart.js or visualization config',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'visualization_options',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Color, legend, axes options',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'drill_down_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Drill-down navigation and filters',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'on_click_action',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Action to perform on click',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'local_filters',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Widget-specific filters',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'refresh_interval',
               existing_type=sa.INTEGER(),
               comment='Refresh interval in seconds',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'order',
               existing_type=sa.INTEGER(),
               comment='Display order',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('dashboard_widgets', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.drop_index('idx_widgets_dashboard', table_name='dashboard_widgets')
    op.create_index('idx_widget_dashboard_order', 'dashboard_widgets', ['dashboard_id', 'order'], unique=False)
    op.create_index(op.f('ix_dashboard_widgets_dashboard_id'), 'dashboard_widgets', ['dashboard_id'], unique=False)
    op.create_unique_constraint(None, 'dashboard_widgets', ['id'])
    op.alter_column('dashboards', 'is_public',
               existing_type=sa.BOOLEAN(),
               comment='Visible to other users',
               existing_nullable=True)
    op.alter_column('dashboards', 'is_default',
               existing_type=sa.BOOLEAN(),
               comment='Default dashboard for this type',
               existing_nullable=True)
    op.alter_column('dashboards', 'shared_with_roles',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='List of roles that can view this dashboard',
               existing_nullable=True)
    op.alter_column('dashboards', 'layout_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Grid layout configuration',
               existing_nullable=True)
    op.alter_column('dashboards', 'theme_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Color scheme and styling',
               existing_nullable=True)
    op.alter_column('dashboards', 'default_filters',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Default filter values',
               existing_nullable=True)
    op.alter_column('dashboards', 'allowed_filters',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Available filter options',
               existing_nullable=True)
    op.alter_column('dashboards', 'auto_refresh_interval',
               existing_type=sa.INTEGER(),
               comment='Auto-refresh in seconds',
               existing_nullable=True)
    op.alter_column('dashboards', 'cache_duration',
               existing_type=sa.INTEGER(),
               comment='Cache duration in seconds',
               existing_nullable=True)
    op.alter_column('dashboards', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('dashboards', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.drop_index('idx_dashboards_user_type', table_name='dashboards')
    op.create_index('idx_dashboard_company', 'dashboards', ['company_id', 'is_public'], unique=False)
    op.create_index('idx_dashboard_user_type', 'dashboards', ['user_id', 'dashboard_type'], unique=False)
    op.create_index(op.f('ix_dashboards_company_id'), 'dashboards', ['company_id'], unique=False)
    op.create_index(op.f('ix_dashboards_dashboard_type'), 'dashboards', ['dashboard_type'], unique=False)
    op.create_index(op.f('ix_dashboards_user_id'), 'dashboards', ['user_id'], unique=False)
    op.create_unique_constraint(None, 'dashboards', ['id'])
    op.alter_column('dcf_models', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this model belongs to (for multi-tenancy)',
               existing_comment='Company this DCF model belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_index('idx_dcf_models_company_id', table_name='dcf_models')
    op.create_index(op.f('ix_dcf_models_company_id'), 'dcf_models', ['company_id'], unique=False)
    op.create_unique_constraint(None, 'dcf_models', ['id'])
    op.create_foreign_key(None, 'dcf_models', 'users', ['user_id'], ['id'], ondelete='CASCADE')
    op.create_unique_constraint(None, 'deal_activities', ['id'])
    op.create_unique_constraint(None, 'deal_documents', ['id'])
    op.create_unique_constraint(None, 'deal_reminders', ['id'])
    op.create_unique_constraint(None, 'deal_scores', ['id'])
    op.alter_column('deal_stage_rules', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this rule belongs to (for multi-tenancy)',
               existing_comment='Company this deal stage rule belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_index('idx_deal_stage_rules_company_id', table_name='deal_stage_rules')
    op.create_index(op.f('ix_deal_stage_rules_company_id'), 'deal_stage_rules', ['company_id'], unique=False)
    op.create_unique_constraint(None, 'deal_stage_rules', ['id'])
    op.create_unique_constraint(None, 'deal_tasks', ['id'])
    op.alter_column('deals', 'deal_type',
               existing_type=sa.VARCHAR(length=50),
               nullable=False,
               comment='Type of deal',
               existing_server_default=sa.text("'real_estate'::character varying"))
    op.alter_column('deals', 'deal_name',
               existing_type=sa.VARCHAR(length=255),
               comment='General deal name',
               existing_nullable=True)
    op.alter_column('deals', 'stage',
               existing_type=postgresql.ENUM('RESEARCH', 'LOI', 'DUE_DILIGENCE', 'CLOSING', 'CLOSED', 'DEAD', name='deal_stage'),
               type_=sa.String(length=50),
               nullable=True,
               comment='Current stage in pipeline',
               existing_comment='Current pipeline stage')
    op.alter_column('deals', 'status',
               existing_type=postgresql.ENUM('ACTIVE', 'ON_HOLD', 'DEAD', 'CLOSED', name='deal_status'),
               type_=sa.String(length=50),
               nullable=True,
               existing_comment='Deal status')
    op.alter_column('deals', 'company_id',
               existing_type=sa.UUID(),
               comment='Associated company',
               existing_comment='Company this deal belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.alter_column('deals', 'asking_price',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Asking/listed price',
               existing_comment='Seller asking price',
               existing_nullable=True)
    op.alter_column('deals', 'estimated_value',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Estimated market value',
               existing_comment='Our estimated value',
               existing_nullable=True)
    op.alter_column('deals', 'purchase_price',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Final purchase price',
               existing_comment='Final purchase price (if closed)',
               existing_nullable=True)
    op.alter_column('deals', 'currency',
               existing_type=sa.VARCHAR(length=10),
               comment='Currency code',
               existing_nullable=True,
               existing_server_default=sa.text("'USD'::character varying"))
    op.alter_column('deals', 'property_name',
               existing_type=sa.VARCHAR(length=255),
               nullable=True,
               comment='Property name',
               existing_comment='Property name or address')
    op.alter_column('deals', 'property_address',
               existing_type=sa.VARCHAR(length=500),
               comment='Property address',
               existing_comment='Full property address',
               existing_nullable=True)
    op.alter_column('deals', 'property_type',
               existing_type=sa.VARCHAR(length=100),
               comment='Property type (multifamily, office, etc)',
               existing_comment='Property type (e.g., Multifamily, Hotel, Office)',
               existing_nullable=True)
    op.alter_column('deals', 'market',
               existing_type=sa.VARCHAR(length=100),
               comment='Market/location',
               existing_comment='Market or submarket',
               existing_nullable=True)
    op.alter_column('deals', 'units',
               existing_type=sa.INTEGER(),
               comment='Number of units',
               existing_comment='Number of units (if applicable)',
               existing_nullable=True)
    op.alter_column('deals', 'square_feet',
               existing_type=sa.INTEGER(),
               comment='Square footage',
               existing_comment='Total square footage',
               existing_nullable=True)
    op.alter_column('deals', 'cap_rate',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Capitalization rate',
               existing_comment='Going-in cap rate (%)',
               existing_nullable=True)
    op.alter_column('deals', 'irr_target',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Target IRR %',
               existing_comment='Target IRR (%)',
               existing_nullable=True)
    op.alter_column('deals', 'target_company',
               existing_type=sa.VARCHAR(length=255),
               comment='Target company name',
               existing_nullable=True)
    op.alter_column('deals', 'sector',
               existing_type=sa.VARCHAR(length=100),
               comment='Industry sector',
               existing_nullable=True)
    op.alter_column('deals', 'ticker_symbol',
               existing_type=sa.VARCHAR(length=20),
               comment='Stock ticker symbol',
               existing_nullable=True)
    op.alter_column('deals', 'quantity',
               existing_type=sa.NUMERIC(precision=15, scale=2),
               type_=sa.Float(),
               comment='Quantity of shares/units',
               existing_nullable=True)
    op.alter_column('deals', 'asset_class',
               existing_type=sa.VARCHAR(length=100),
               comment='Asset class (equity, debt, etc)',
               existing_nullable=True)
    op.alter_column('deals', 'commodity_type',
               existing_type=sa.VARCHAR(length=100),
               comment='Type of commodity',
               existing_nullable=True)
    op.alter_column('deals', 'broker_id',
               existing_type=sa.UUID(),
               comment='Broker/intermediary',
               existing_nullable=True)
    op.alter_column('deals', 'lead_analyst',
               existing_type=sa.VARCHAR(length=255),
               comment='Lead analyst/deal manager',
               existing_comment='Lead analyst/underwriter',
               existing_nullable=True)
    op.alter_column('deals', 'date_identified',
               existing_type=sa.DATE(),
               comment='Date deal was identified',
               existing_comment='Date deal was first identified',
               existing_nullable=True)
    op.alter_column('deals', 'loi_date',
               existing_type=sa.DATE(),
               comment='Letter of Intent date',
               existing_comment='LOI submission date',
               existing_nullable=True)
    op.alter_column('deals', 'due_diligence_start',
               existing_type=sa.DATE(),
               comment='DD start date',
               existing_comment='Due diligence start date',
               existing_nullable=True)
    op.alter_column('deals', 'due_diligence_end',
               existing_type=sa.DATE(),
               comment='DD end date',
               existing_comment='Due diligence end date',
               existing_nullable=True)
    op.alter_column('deals', 'notes',
               existing_type=sa.TEXT(),
               comment='General notes',
               existing_comment='Internal notes and comments',
               existing_nullable=True)
    op.alter_column('deals', 'pros',
               existing_type=sa.TEXT(),
               comment='Pros/advantages',
               existing_comment='Deal pros/strengths',
               existing_nullable=True)
    op.alter_column('deals', 'cons',
               existing_type=sa.TEXT(),
               comment='Cons/risks',
               existing_comment='Deal cons/risks',
               existing_nullable=True)
    op.alter_column('deals', 'documents_url',
               existing_type=sa.VARCHAR(length=500),
               comment='Document storage URL',
               existing_comment='Link to deal documents folder',
               existing_nullable=True)
    op.alter_column('deals', 'priority',
               existing_type=sa.INTEGER(),
               comment='Priority (1-10)',
               existing_comment='Priority level (1=High, 5=Low)',
               existing_nullable=True)
    op.alter_column('deals', 'confidence_level',
               existing_type=sa.INTEGER(),
               comment='Confidence level (0-100)',
               existing_comment='Confidence % that deal will close',
               existing_nullable=True)
    op.drop_index('idx_deals_company_id', table_name='deals')
    op.drop_index('idx_deals_status', table_name='deals')
    op.drop_index('ix_deals_market', table_name='deals')
    op.drop_index('ix_deals_property_name', table_name='deals')
    op.create_index(op.f('ix_deals_company_id'), 'deals', ['company_id'], unique=False)
    op.create_index(op.f('ix_deals_deal_type'), 'deals', ['deal_type'], unique=False)
    op.create_unique_constraint(None, 'deals', ['id'])
    op.drop_constraint('deals_broker_id_fkey', 'deals', type_='foreignkey')
    op.create_foreign_key(None, 'deals', 'brokers', ['broker_id'], ['id'])
    op.create_unique_constraint(None, 'debt_covenants', ['id'])
    op.create_unique_constraint(None, 'distribution_items', ['id'])
    op.drop_index('idx_dist_fund_date', table_name='distributions')
    op.create_unique_constraint(None, 'distributions', ['id'])
    op.create_unique_constraint(None, 'economic_indicator_correlations', ['id'])
    op.add_column('economic_indicators', sa.Column('id', sa.Integer(), nullable=False))
    op.add_column('economic_indicators', sa.Column('source', sa.String(length=50), nullable=False))
    op.add_column('economic_indicators', sa.Column('country', sa.String(length=2), nullable=False))
    op.add_column('economic_indicators', sa.Column('indicator_code', sa.String(length=100), nullable=False))
    op.add_column('economic_indicators', sa.Column('indicator_type', sa.String(length=100), nullable=True))
    op.add_column('economic_indicators', sa.Column('year', sa.Integer(), nullable=False))
    op.add_column('economic_indicators', sa.Column('quarter', sa.Integer(), nullable=True))
    op.add_column('economic_indicators', sa.Column('month', sa.Integer(), nullable=True))
    op.add_column('economic_indicators', sa.Column('date', sa.DateTime(), nullable=True))
    op.add_column('economic_indicators', sa.Column('value', sa.Float(), nullable=False))
    op.add_column('economic_indicators', sa.Column('value_unit', sa.String(length=50), nullable=True))
    op.add_column('economic_indicators', sa.Column('month_over_month_change', sa.Float(), nullable=True))
    op.add_column('economic_indicators', sa.Column('year_over_year_change', sa.Float(), nullable=True))
    op.add_column('economic_indicators', sa.Column('seasonal_adjustment', sa.Boolean(), nullable=True))
    op.add_column('economic_indicators', sa.Column('revision_status', sa.String(length=50), nullable=True))
    op.add_column('economic_indicators', sa.Column('raw_data', sa.JSON(), nullable=True))
    op.alter_column('economic_indicators', 'indicator_name',
               existing_type=sa.VARCHAR(length=100),
               type_=sa.String(length=255),
               existing_nullable=False)
    op.alter_column('economic_indicators', 'created_at',
               existing_type=postgresql.TIMESTAMP(),
               type_=sa.DateTime(timezone=True),
               existing_nullable=True,
               existing_server_default=sa.text('CURRENT_TIMESTAMP'))
    op.alter_column('economic_indicators', 'updated_at',
               existing_type=postgresql.TIMESTAMP(),
               type_=sa.DateTime(timezone=True),
               existing_nullable=True,
               existing_server_default=sa.text('CURRENT_TIMESTAMP'))
    op.drop_index('idx_econ_composite', table_name='economic_indicators')
    op.drop_index('idx_econ_geography', table_name='economic_indicators')
    op.drop_index('idx_econ_indicator', table_name='economic_indicators')
    op.drop_index('idx_econ_period', table_name='economic_indicators')
    op.create_index(op.f('ix_economic_indicators_country'), 'economic_indicators', ['country'], unique=False)
    op.create_index(op.f('ix_economic_indicators_date'), 'economic_indicators', ['date'], unique=False)
    op.create_index(op.f('ix_economic_indicators_id'), 'economic_indicators', ['id'], unique=False)
    op.create_index(op.f('ix_economic_indicators_indicator_code'), 'economic_indicators', ['indicator_code'], unique=False)
    op.create_index(op.f('ix_economic_indicators_indicator_type'), 'economic_indicators', ['indicator_type'], unique=False)
    op.create_index(op.f('ix_economic_indicators_source'), 'economic_indicators', ['source'], unique=False)
    op.create_index(op.f('ix_economic_indicators_year'), 'economic_indicators', ['year'], unique=False)
    op.drop_column('economic_indicators', 'geography_type')
    op.drop_column('economic_indicators', 'notes')
    op.drop_column('economic_indicators', 'indicator_id')
    op.drop_column('economic_indicators', 'period')
    op.drop_column('economic_indicators', 'indicator_value')
    op.drop_column('economic_indicators', 'indicator_unit')
    op.drop_column('economic_indicators', 'period_type')
    op.drop_column('economic_indicators', 'data_source')
    op.drop_column('economic_indicators', 'geography')
    op.alter_column('economics_cache_metadata', 'last_fetched',
               existing_type=postgresql.TIMESTAMP(),
               comment='When data was last fetched from API',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'last_accessed',
               existing_type=postgresql.TIMESTAMP(),
               comment='When cache was last accessed',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'access_count',
               existing_type=sa.INTEGER(),
               comment='Number of times accessed',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'record_count',
               existing_type=sa.INTEGER(),
               comment='Number of records in cache',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'data_quality',
               existing_type=sa.VARCHAR(length=20),
               comment='Quality indicator (complete, partial, stale)',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'expires_at',
               existing_type=postgresql.TIMESTAMP(),
               comment='When cache expires',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'ttl_seconds',
               existing_type=sa.INTEGER(),
               comment='TTL in seconds',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=False,
               comment='Record creation timestamp',
               existing_server_default=sa.text('now()'))
    op.alter_column('economics_cache_metadata', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=False,
               comment='Record last update timestamp')
    op.drop_constraint('economics_cache_metadata_cache_key_key', 'economics_cache_metadata', type_='unique')
    op.create_unique_constraint(None, 'economics_cache_metadata', ['id'])
    op.alter_column('economics_country_overview', 'country_name',
               existing_type=sa.VARCHAR(length=100),
               comment='Country name',
               existing_nullable=False)
    op.alter_column('economics_country_overview', 'country_code',
               existing_type=sa.VARCHAR(length=10),
               comment='ISO country code',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'gdp',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='GDP in billions USD',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'gdp_growth',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='GDP growth rate %',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'inflation_rate',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Inflation rate %',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'interest_rate',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Interest rate %',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'unemployment_rate',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Unemployment/Jobless rate %',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'population',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Population in millions',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'current_account',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Current account % of GDP',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'debt_to_gdp',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Debt to GDP ratio %',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'government_budget',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Government budget % of GDP',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'data_date',
               existing_type=postgresql.TIMESTAMP(),
               comment='Date of the data snapshot',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'data_source',
               existing_type=sa.VARCHAR(length=50),
               comment='Data source identifier',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'raw_data',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Raw API response',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=False,
               comment='Record creation timestamp',
               existing_server_default=sa.text('now()'))
    op.alter_column('economics_country_overview', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=False,
               comment='Record last update timestamp')
    op.create_unique_constraint(None, 'economics_country_overview', ['id'])
    op.alter_column('economics_fetch_log', 'endpoint',
               existing_type=sa.VARCHAR(length=255),
               comment='API endpoint called',
               existing_nullable=False)
    op.alter_column('economics_fetch_log', 'status',
               existing_type=sa.VARCHAR(length=20),
               comment='success, failed, partial',
               existing_nullable=False)
    op.alter_column('economics_fetch_log', 'records_fetched',
               existing_type=sa.INTEGER(),
               comment='Number of records fetched',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'records_stored',
               existing_type=sa.INTEGER(),
               comment='Number of records stored in DB',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'response_time_ms',
               existing_type=sa.INTEGER(),
               comment='API response time in ms',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'cache_hit',
               existing_type=sa.VARCHAR(length=20),
               comment='Whether cache was hit',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'error_message',
               existing_type=sa.TEXT(),
               comment='Error message if failed',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'error_details',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Detailed error information',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'triggered_by',
               existing_type=sa.VARCHAR(length=100),
               comment='What triggered the fetch (cron, api, manual)',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=False,
               comment='Record creation timestamp',
               existing_server_default=sa.text('now()'))
    op.alter_column('economics_fetch_log', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=False,
               comment='Record last update timestamp')
    op.create_index(op.f('ix_economics_fetch_log_fetch_timestamp'), 'economics_fetch_log', ['fetch_timestamp'], unique=False)
    op.create_unique_constraint(None, 'economics_fetch_log', ['id'])
    op.alter_column('economics_indicator_history', 'observation_date',
               existing_type=postgresql.TIMESTAMP(),
               comment='Date of observation',
               existing_nullable=False)
    op.alter_column('economics_indicator_history', 'value',
               existing_type=sa.VARCHAR(length=50),
               comment='Value as string',
               existing_nullable=True)
    op.alter_column('economics_indicator_history', 'value_numeric',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Value as number',
               existing_nullable=True)
    op.alter_column('economics_indicator_history', 'change_from_previous',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Change from previous period',
               existing_nullable=True)
    op.alter_column('economics_indicator_history', 'change_percent',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Percent change from previous',
               existing_nullable=True)
    op.alter_column('economics_indicator_history', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=False,
               comment='Record creation timestamp',
               existing_server_default=sa.text('now()'))
    op.alter_column('economics_indicator_history', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=False,
               comment='Record last update timestamp')
    op.create_unique_constraint(None, 'economics_indicator_history', ['id'])
    op.alter_column('economics_indicators', 'country_name',
               existing_type=sa.VARCHAR(length=100),
               comment='Country name',
               existing_nullable=False)
    op.alter_column('economics_indicators', 'category',
               existing_type=sa.VARCHAR(length=50),
               comment='Indicator category (gdp, labour, housing, etc.)',
               existing_nullable=False)
    op.alter_column('economics_indicators', 'indicator_name',
               existing_type=sa.VARCHAR(length=255),
               comment='Specific indicator name',
               existing_nullable=False)
    op.alter_column('economics_indicators', 'last_value',
               existing_type=sa.VARCHAR(length=50),
               comment='Latest value (as string to handle formats)',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'last_value_numeric',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Latest value as number',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'previous_value',
               existing_type=sa.VARCHAR(length=50),
               comment='Previous value',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'previous_value_numeric',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Previous value as number',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'highest_value',
               existing_type=sa.VARCHAR(length=50),
               comment='Historical highest value',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'highest_value_numeric',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Historical highest as number',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'lowest_value',
               existing_type=sa.VARCHAR(length=50),
               comment='Historical lowest value',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'lowest_value_numeric',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Historical lowest as number',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'unit',
               existing_type=sa.VARCHAR(length=100),
               comment='Unit of measurement',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'frequency',
               existing_type=sa.VARCHAR(length=50),
               comment='Update frequency (monthly, quarterly, etc.)',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'reference_period',
               existing_type=sa.VARCHAR(length=50),
               comment='Reference period (e.g., Nov/25)',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'data_date',
               existing_type=postgresql.TIMESTAMP(),
               comment='Date of the data',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'source',
               existing_type=sa.VARCHAR(length=255),
               comment='Data source/provider',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'raw_data',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Raw API response for this indicator',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'data_source_api',
               existing_type=sa.VARCHAR(length=50),
               comment='API source',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=False,
               comment='Record creation timestamp',
               existing_server_default=sa.text('now()'))
    op.alter_column('economics_indicators', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=False,
               comment='Record last update timestamp')
    op.create_unique_constraint(None, 'economics_indicators', ['id'])
    op.alter_column('email_templates', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this template belongs to (for multi-tenancy)',
               existing_comment='Company this email template belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_index('idx_email_templates_company_id', table_name='email_templates')
    op.create_index(op.f('ix_email_templates_company_id'), 'email_templates', ['company_id'], unique=False)
    op.create_unique_constraint(None, 'email_templates', ['id'])
    op.create_unique_constraint(None, 'employment_data', ['id'])
    op.create_unique_constraint(None, 'extracted_balance_sheets', ['id'])
    op.create_unique_constraint(None, 'extracted_cash_flows', ['id'])
    op.create_unique_constraint(None, 'extracted_income_statements', ['id'])
    op.create_unique_constraint(None, 'financial_documents', ['id'])
    op.create_unique_constraint(None, 'fix_and_flip_models', ['id'])
    op.create_unique_constraint(None, 'fund_commitments', ['id'])
    op.drop_index('idx_funds_company_id', table_name='funds')
    op.drop_index('idx_funds_vintage', table_name='funds')
    op.create_index(op.f('ix_funds_company_id'), 'funds', ['company_id'], unique=False)
    op.create_unique_constraint(None, 'funds', ['id'])
    op.drop_index('idx_generated_reports_company_id', table_name='generated_reports')
    op.create_index(op.f('ix_generated_reports_company_id'), 'generated_reports', ['company_id'], unique=False)
    op.create_unique_constraint(None, 'generated_reports', ['id'])
    op.alter_column('geographic_performance', 'concentration_percentage',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='% of total portfolio',
               existing_nullable=True)
    op.alter_column('geographic_performance', 'property_types',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Distribution of property types',
               existing_nullable=True)
    op.alter_column('geographic_performance', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('geographic_performance', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.create_index('idx_geo_perf_company', 'geographic_performance', ['company_id', 'metric_date'], unique=False)
    op.create_index('idx_geo_perf_date_location', 'geographic_performance', ['metric_date', 'state', 'city'], unique=False)
    op.create_index(op.f('ix_geographic_performance_city'), 'geographic_performance', ['city'], unique=False)
    op.create_index(op.f('ix_geographic_performance_company_id'), 'geographic_performance', ['company_id'], unique=False)
    op.create_index(op.f('ix_geographic_performance_country'), 'geographic_performance', ['country'], unique=False)
    op.create_index(op.f('ix_geographic_performance_metric_date'), 'geographic_performance', ['metric_date'], unique=False)
    op.create_index(op.f('ix_geographic_performance_state'), 'geographic_performance', ['state'], unique=False)
    op.create_index(op.f('ix_geographic_performance_zip_code'), 'geographic_performance', ['zip_code'], unique=False)
    op.create_unique_constraint(None, 'geographic_performance', ['id'])
    op.create_unique_constraint(None, 'high_rise_multifamily_models', ['id'])
    op.create_unique_constraint(None, 'hotel_financial_models', ['id'])
    op.create_unique_constraint(None, 'housing_indicators', ['id'])
    op.create_unique_constraint(None, 'integration_configs', ['id'])
    op.create_unique_constraint(None, 'interest_rates', ['id'])
    op.alter_column('lbo_models', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this model belongs to (for multi-tenancy)',
               existing_comment='Company this LBO model belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_index('idx_lbo_models_company_id', table_name='lbo_models')
    op.create_index(op.f('ix_lbo_models_company_id'), 'lbo_models', ['company_id'], unique=False)
    op.create_unique_constraint(None, 'lbo_models', ['id'])
    op.create_foreign_key(None, 'lbo_models', 'users', ['user_id'], ['id'], ondelete='CASCADE')
    op.create_unique_constraint(None, 'lease_analyzer_models', ['id'])
    op.create_unique_constraint(None, 'leases', ['id'])
    op.alter_column('limited_partners', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this LP belongs to (for multi-tenancy)',
               existing_comment='Company this limited partner belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_index('idx_limited_partners_company_id', table_name='limited_partners')
    op.create_index(op.f('ix_limited_partners_company_id'), 'limited_partners', ['company_id'], unique=False)
    op.create_unique_constraint(None, 'limited_partners', ['id'])
    op.alter_column('loan_comparisons', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this comparison belongs to (for multi-tenancy)',
               existing_comment='Company this loan comparison belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_index('idx_loan_comparisons_company_id', table_name='loan_comparisons')
    op.create_index(op.f('ix_loan_comparisons_company_id'), 'loan_comparisons', ['company_id'], unique=False)
    op.create_unique_constraint(None, 'loan_comparisons', ['id'])
    op.drop_index('idx_loans_company_id', table_name='loans')
    op.drop_index('idx_loans_lender', table_name='loans')
    op.drop_index('idx_loans_maturity', table_name='loans')
    op.create_index(op.f('ix_loans_company_id'), 'loans', ['company_id'], unique=False)
    op.create_unique_constraint(None, 'loans', ['id'])
    op.drop_index('idx_maint_created', table_name='maintenance_requests')
    op.drop_index('idx_maint_priority', table_name='maintenance_requests')
    op.drop_index('idx_maint_property_status', table_name='maintenance_requests')
    op.create_unique_constraint(None, 'maintenance_requests', ['id'])
    op.drop_constraint('market_analytics_cache_cache_key_key', 'market_analytics_cache', type_='unique')
    op.create_unique_constraint(None, 'market_data_fetch_log', ['id'])
    op.create_unique_constraint(None, 'market_update_schedules', ['id'])
    op.create_unique_constraint(None, 'milestones', ['id'])
    op.create_unique_constraint(None, 'mixed_use_development_models', ['id'])
    op.create_unique_constraint(None, 'model_clones', ['id'])
    op.create_unique_constraint(None, 'model_comparisons', ['id'])
    op.create_unique_constraint(None, 'model_templates', ['id'])
    op.create_unique_constraint(None, 'ownership_details', ['id'])
    op.alter_column('performance_attribution', 'total_return',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment='Total portfolio return (%)',
               existing_nullable=False)
    op.alter_column('performance_attribution', 'benchmark_return',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment='Benchmark return (%)',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'excess_return',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment='Return vs benchmark (%)',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'asset_allocation_effect',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment='Return from asset allocation',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'security_selection_effect',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment='Return from property selection',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'interaction_effect',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment='Interaction between allocation and selection',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'geographic_attribution',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Return by geography',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'sector_attribution',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Return by property type/sector',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'detailed_attribution',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Granular attribution data',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'tracking_error',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment='Volatility of excess returns',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'attribution_method',
               existing_type=sa.VARCHAR(length=50),
               comment='Brinson, BHB, etc.',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('performance_attribution', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.create_index('idx_perf_attr_company_date', 'performance_attribution', ['company_id', 'analysis_date'], unique=False)
    op.create_index('idx_perf_attr_fund_date', 'performance_attribution', ['fund_id', 'analysis_date'], unique=False)
    op.create_index(op.f('ix_performance_attribution_analysis_date'), 'performance_attribution', ['analysis_date'], unique=False)
    op.create_index(op.f('ix_performance_attribution_company_id'), 'performance_attribution', ['company_id'], unique=False)
    op.create_index(op.f('ix_performance_attribution_fund_id'), 'performance_attribution', ['fund_id'], unique=False)
    op.create_index(op.f('ix_performance_attribution_property_id'), 'performance_attribution', ['property_id'], unique=False)
    op.create_unique_constraint(None, 'performance_attribution', ['id'])
    op.drop_index('idx_portinv_fund_status', table_name='portfolio_investments')
    op.create_unique_constraint(None, 'portfolio_investments', ['id'])
    op.create_unique_constraint(None, 'portfolio_models', ['id'])
    op.alter_column('portfolio_performance_metrics', 'target_value',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Target or benchmark value',
               existing_nullable=True)
    op.alter_column('portfolio_performance_metrics', 'breakdown',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Detailed breakdown of metric calculation',
               existing_nullable=True)
    op.alter_column('portfolio_performance_metrics', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('portfolio_performance_metrics', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.create_index('idx_perf_metric_company', 'portfolio_performance_metrics', ['company_id', 'metric_date'], unique=False)
    op.create_index('idx_perf_metric_date_type', 'portfolio_performance_metrics', ['metric_date', 'metric_type'], unique=False)
    op.create_index('idx_perf_metric_fund', 'portfolio_performance_metrics', ['fund_id', 'metric_date'], unique=False)
    op.create_index('idx_perf_metric_property', 'portfolio_performance_metrics', ['property_id', 'metric_date'], unique=False)
    op.create_index(op.f('ix_portfolio_performance_metrics_company_id'), 'portfolio_performance_metrics', ['company_id'], unique=False)
    op.create_index(op.f('ix_portfolio_performance_metrics_fund_id'), 'portfolio_performance_metrics', ['fund_id'], unique=False)
    op.create_index(op.f('ix_portfolio_performance_metrics_metric_date'), 'portfolio_performance_metrics', ['metric_date'], unique=False)
    op.create_index(op.f('ix_portfolio_performance_metrics_metric_type'), 'portfolio_performance_metrics', ['metric_type'], unique=False)
    op.create_index(op.f('ix_portfolio_performance_metrics_property_id'), 'portfolio_performance_metrics', ['property_id'], unique=False)
    op.create_unique_constraint(None, 'portfolio_performance_metrics', ['id'])
    op.alter_column('portfolio_risk_metrics', 'risk_score',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='0-100 risk score',
               existing_nullable=False)
    op.alter_column('portfolio_risk_metrics', 'risk_level',
               existing_type=sa.VARCHAR(length=20),
               comment='low, medium, high, critical',
               existing_nullable=True)
    op.alter_column('portfolio_risk_metrics', 'concentration_value',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Concentration percentage or ratio',
               existing_nullable=True)
    op.alter_column('portfolio_risk_metrics', 'concentration_limit',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Policy limit for concentration',
               existing_nullable=True)
    op.alter_column('portfolio_risk_metrics', 'top_exposures',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Top 5-10 concentrations',
               existing_nullable=True)
    op.alter_column('portfolio_risk_metrics', 'risk_breakdown',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment='Detailed risk analysis',
               existing_nullable=True)
    op.alter_column('portfolio_risk_metrics', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('portfolio_risk_metrics', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.create_index('idx_risk_metric_company', 'portfolio_risk_metrics', ['company_id', 'metric_date'], unique=False)
    op.create_index('idx_risk_metric_date_type', 'portfolio_risk_metrics', ['metric_date', 'risk_type'], unique=False)
    op.create_index(op.f('ix_portfolio_risk_metrics_company_id'), 'portfolio_risk_metrics', ['company_id'], unique=False)
    op.create_index(op.f('ix_portfolio_risk_metrics_fund_id'), 'portfolio_risk_metrics', ['fund_id'], unique=False)
    op.create_index(op.f('ix_portfolio_risk_metrics_metric_date'), 'portfolio_risk_metrics', ['metric_date'], unique=False)
    op.create_index(op.f('ix_portfolio_risk_metrics_risk_type'), 'portfolio_risk_metrics', ['risk_type'], unique=False)
    op.create_unique_constraint(None, 'portfolio_risk_metrics', ['id'])
    op.alter_column('portfolio_snapshots', 'portfolio_irr',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Internal Rate of Return (%)',
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'portfolio_moic',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Multiple on Invested Capital',
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'average_occupancy',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Weighted average occupancy (%)',
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'average_cap_rate',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Weighted average cap rate (%)',
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'average_ltv',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Loan-to-Value ratio (%)',
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'weighted_dscr',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Debt Service Coverage Ratio',
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'geographic_distribution',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment="{'state': value, ...}",
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'sector_distribution',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment="{'residential': value, ...}",
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'property_type_distribution',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment="{'multifamily': value, ...}",
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('portfolio_snapshots', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.drop_index('idx_portsnap_company_date', table_name='portfolio_snapshots')
    op.create_index('idx_portfolio_snapshot_date_company', 'portfolio_snapshots', ['snapshot_date', 'company_id'], unique=False)
    op.create_index('idx_portfolio_snapshot_date_fund', 'portfolio_snapshots', ['snapshot_date', 'fund_id'], unique=False)
    op.create_index(op.f('ix_portfolio_snapshots_company_id'), 'portfolio_snapshots', ['company_id'], unique=False)
    op.create_index(op.f('ix_portfolio_snapshots_fund_id'), 'portfolio_snapshots', ['fund_id'], unique=False)
    op.create_index(op.f('ix_portfolio_snapshots_snapshot_date'), 'portfolio_snapshots', ['snapshot_date'], unique=False)
    op.create_unique_constraint(None, 'portfolio_snapshots', ['id'])
    op.create_unique_constraint(None, 'preset_assumption_sets', ['id'])
    op.create_unique_constraint(None, 'project_updates', ['id'])
    op.create_unique_constraint(None, 'projects', ['id'])
    op.drop_index('idx_properties_address', table_name='properties')
    op.drop_index('idx_properties_created_at', table_name='properties')
    op.drop_index('idx_properties_purchase_date', table_name='properties')
    op.drop_index('idx_properties_type_status', table_name='properties')
    op.create_unique_constraint(None, 'properties', ['id'])
    op.create_unique_constraint(None, 'property_financials', ['id'])
    op.create_unique_constraint(None, 'renovation_budget_models', ['id'])
    op.create_unique_constraint(None, 'rent_trend_analyses', ['id'])
    op.alter_column('report_templates', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this template belongs to (for multi-tenancy)',
               existing_comment='Company this report template belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_index('idx_report_templates_company_id', table_name='report_templates')
    op.create_index(op.f('ix_report_templates_company_id'), 'report_templates', ['company_id'], unique=False)
    op.create_unique_constraint(None, 'report_templates', ['id'])
    op.create_unique_constraint(None, 'roi_metrics', ['id'])
    op.add_column('saved_calculations', sa.Column('company_id', sa.UUID(), nullable=True, comment='Company this calculation belongs to (for multi-tenancy)'))
    op.drop_index('idx_savedcalc_user_created', table_name='saved_calculations')
    op.create_index(op.f('ix_saved_calculations_company_id'), 'saved_calculations', ['company_id'], unique=False)
    op.create_index('ix_saved_calculations_company_type', 'saved_calculations', ['company_id', 'calculation_type'], unique=False)
    op.create_unique_constraint(None, 'saved_calculations', ['id'])
    op.create_foreign_key(None, 'saved_calculations', 'companies', ['company_id'], ['id'], ondelete='CASCADE')
    op.create_unique_constraint(None, 'single_family_rental_models', ['id'])
    op.create_unique_constraint(None, 'small_multifamily_models', ['id'])
    op.create_unique_constraint(None, 'subdivision_models', ['id'])
    op.create_unique_constraint(None, 'supply_demand_analyses', ['id'])
    op.drop_index('idx_tasks_due_date', table_name='tasks')
    op.drop_index('idx_tasks_priority', table_name='tasks')
    op.drop_index('idx_tasks_project_status', table_name='tasks')
    op.create_unique_constraint(None, 'tasks', ['id'])
    op.create_unique_constraint(None, 'tax_benefits', ['id'])
    op.create_unique_constraint(None, 'tax_strategy_models', ['id'])
    op.create_unique_constraint(None, 'template_usage_logs', ['id'])
    op.create_unique_constraint(None, 'transaction_lines', ['id'])
    op.drop_index('idx_units_property_status', table_name='units')
    op.create_unique_constraint(None, 'units', ['id'])
    op.add_column('users', sa.Column('username', sa.String(length=100), nullable=False, comment='Username'))
    op.add_column('users', sa.Column('first_name', sa.String(length=100), nullable=True, comment='First name'))
    op.add_column('users', sa.Column('last_name', sa.String(length=100), nullable=True, comment='Last name'))
    op.add_column('users', sa.Column('company_name', sa.String(length=255), nullable=True, comment='[DEPRECATED] Use company_id instead'))
    op.add_column('users', sa.Column('company_id', sa.UUID(), nullable=True, comment='Company/organization this user belongs to'))
    op.add_column('users', sa.Column('is_verified', sa.Boolean(), nullable=False, comment='Email verified'))
    op.add_column('users', sa.Column('last_login', sa.DateTime(), nullable=True, comment='Last login timestamp'))
    op.add_column('users', sa.Column('email_verified_at', sa.DateTime(), nullable=True, comment='Email verification timestamp'))
    op.alter_column('users', 'email',
               existing_type=sa.VARCHAR(length=255),
               comment='User email (login)',
               existing_nullable=False)
    op.alter_column('users', 'hashed_password',
               existing_type=sa.VARCHAR(length=255),
               comment='Bcrypt hashed password',
               existing_nullable=False)
    op.alter_column('users', 'is_active',
               existing_type=sa.BOOLEAN(),
               nullable=False,
               comment='Account is active')
    op.alter_column('users', 'is_superuser',
               existing_type=sa.BOOLEAN(),
               nullable=False,
               comment='Admin privileges')
    op.create_index(op.f('ix_users_company_id'), 'users', ['company_id'], unique=False)
    op.create_index(op.f('ix_users_username'), 'users', ['username'], unique=True)
    op.create_unique_constraint(None, 'users', ['id'])
    op.create_foreign_key(None, 'users', 'companies', ['company_id'], ['id'], ondelete='SET NULL')
    op.drop_column('users', 'full_name')
    op.create_unique_constraint(None, 'valuation_comparisons', ['id'])
    op.create_unique_constraint(None, 'valuation_snapshots', ['id'])
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(None, 'valuation_snapshots', type_='unique')
    op.drop_constraint(None, 'valuation_comparisons', type_='unique')
    op.add_column('users', sa.Column('full_name', sa.VARCHAR(length=255), autoincrement=False, nullable=True))
    op.drop_constraint(None, 'users', type_='foreignkey')
    op.drop_constraint(None, 'users', type_='unique')
    op.drop_index(op.f('ix_users_username'), table_name='users')
    op.drop_index(op.f('ix_users_company_id'), table_name='users')
    op.alter_column('users', 'is_superuser',
               existing_type=sa.BOOLEAN(),
               nullable=True,
               comment=None,
               existing_comment='Admin privileges')
    op.alter_column('users', 'is_active',
               existing_type=sa.BOOLEAN(),
               nullable=True,
               comment=None,
               existing_comment='Account is active')
    op.alter_column('users', 'hashed_password',
               existing_type=sa.VARCHAR(length=255),
               comment=None,
               existing_comment='Bcrypt hashed password',
               existing_nullable=False)
    op.alter_column('users', 'email',
               existing_type=sa.VARCHAR(length=255),
               comment=None,
               existing_comment='User email (login)',
               existing_nullable=False)
    op.drop_column('users', 'email_verified_at')
    op.drop_column('users', 'last_login')
    op.drop_column('users', 'is_verified')
    op.drop_column('users', 'company_id')
    op.drop_column('users', 'company_name')
    op.drop_column('users', 'last_name')
    op.drop_column('users', 'first_name')
    op.drop_column('users', 'username')
    op.drop_constraint(None, 'units', type_='unique')
    op.create_index('idx_units_property_status', 'units', ['property_id', 'status'], unique=False)
    op.drop_constraint(None, 'transaction_lines', type_='unique')
    op.drop_constraint(None, 'template_usage_logs', type_='unique')
    op.drop_constraint(None, 'tax_strategy_models', type_='unique')
    op.drop_constraint(None, 'tax_benefits', type_='unique')
    op.drop_constraint(None, 'tasks', type_='unique')
    op.create_index('idx_tasks_project_status', 'tasks', ['project_id', 'status'], unique=False)
    op.create_index('idx_tasks_priority', 'tasks', ['priority'], unique=False)
    op.create_index('idx_tasks_due_date', 'tasks', ['due_date'], unique=False)
    op.drop_constraint(None, 'supply_demand_analyses', type_='unique')
    op.drop_constraint(None, 'subdivision_models', type_='unique')
    op.drop_constraint(None, 'small_multifamily_models', type_='unique')
    op.drop_constraint(None, 'single_family_rental_models', type_='unique')
    op.drop_constraint(None, 'saved_calculations', type_='foreignkey')
    op.drop_constraint(None, 'saved_calculations', type_='unique')
    op.drop_index('ix_saved_calculations_company_type', table_name='saved_calculations')
    op.drop_index(op.f('ix_saved_calculations_company_id'), table_name='saved_calculations')
    op.create_index('idx_savedcalc_user_created', 'saved_calculations', ['user_id', 'created_at'], unique=False)
    op.drop_column('saved_calculations', 'company_id')
    op.drop_constraint(None, 'roi_metrics', type_='unique')
    op.drop_constraint(None, 'report_templates', type_='unique')
    op.drop_index(op.f('ix_report_templates_company_id'), table_name='report_templates')
    op.create_index('idx_report_templates_company_id', 'report_templates', ['company_id'], unique=False)
    op.alter_column('report_templates', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this report template belongs to (for multi-tenancy)',
               existing_comment='Company this template belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_constraint(None, 'rent_trend_analyses', type_='unique')
    op.drop_constraint(None, 'renovation_budget_models', type_='unique')
    op.drop_constraint(None, 'property_financials', type_='unique')
    op.drop_constraint(None, 'properties', type_='unique')
    op.create_index('idx_properties_type_status', 'properties', ['property_type', 'status'], unique=False)
    op.create_index('idx_properties_purchase_date', 'properties', ['purchase_date'], unique=False)
    op.create_index('idx_properties_created_at', 'properties', ['created_at'], unique=False)
    op.create_index('idx_properties_address', 'properties', ['city', 'state'], unique=False)
    op.drop_constraint(None, 'projects', type_='unique')
    op.drop_constraint(None, 'project_updates', type_='unique')
    op.drop_constraint(None, 'preset_assumption_sets', type_='unique')
    op.drop_constraint(None, 'portfolio_snapshots', type_='unique')
    op.drop_index(op.f('ix_portfolio_snapshots_snapshot_date'), table_name='portfolio_snapshots')
    op.drop_index(op.f('ix_portfolio_snapshots_fund_id'), table_name='portfolio_snapshots')
    op.drop_index(op.f('ix_portfolio_snapshots_company_id'), table_name='portfolio_snapshots')
    op.drop_index('idx_portfolio_snapshot_date_fund', table_name='portfolio_snapshots')
    op.drop_index('idx_portfolio_snapshot_date_company', table_name='portfolio_snapshots')
    op.create_index('idx_portsnap_company_date', 'portfolio_snapshots', ['company_id', 'snapshot_date'], unique=False)
    op.alter_column('portfolio_snapshots', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('portfolio_snapshots', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('portfolio_snapshots', 'property_type_distribution',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment="{'multifamily': value, ...}",
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'sector_distribution',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment="{'residential': value, ...}",
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'geographic_distribution',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment="{'state': value, ...}",
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'weighted_dscr',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Debt Service Coverage Ratio',
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'average_ltv',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Loan-to-Value ratio (%)',
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'average_cap_rate',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Weighted average cap rate (%)',
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'average_occupancy',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Weighted average occupancy (%)',
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'portfolio_moic',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Multiple on Invested Capital',
               existing_nullable=True)
    op.alter_column('portfolio_snapshots', 'portfolio_irr',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Internal Rate of Return (%)',
               existing_nullable=True)
    op.drop_constraint(None, 'portfolio_risk_metrics', type_='unique')
    op.drop_index(op.f('ix_portfolio_risk_metrics_risk_type'), table_name='portfolio_risk_metrics')
    op.drop_index(op.f('ix_portfolio_risk_metrics_metric_date'), table_name='portfolio_risk_metrics')
    op.drop_index(op.f('ix_portfolio_risk_metrics_fund_id'), table_name='portfolio_risk_metrics')
    op.drop_index(op.f('ix_portfolio_risk_metrics_company_id'), table_name='portfolio_risk_metrics')
    op.drop_index('idx_risk_metric_date_type', table_name='portfolio_risk_metrics')
    op.drop_index('idx_risk_metric_company', table_name='portfolio_risk_metrics')
    op.alter_column('portfolio_risk_metrics', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('portfolio_risk_metrics', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('portfolio_risk_metrics', 'risk_breakdown',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Detailed risk analysis',
               existing_nullable=True)
    op.alter_column('portfolio_risk_metrics', 'top_exposures',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Top 5-10 concentrations',
               existing_nullable=True)
    op.alter_column('portfolio_risk_metrics', 'concentration_limit',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Policy limit for concentration',
               existing_nullable=True)
    op.alter_column('portfolio_risk_metrics', 'concentration_value',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Concentration percentage or ratio',
               existing_nullable=True)
    op.alter_column('portfolio_risk_metrics', 'risk_level',
               existing_type=sa.VARCHAR(length=20),
               comment=None,
               existing_comment='low, medium, high, critical',
               existing_nullable=True)
    op.alter_column('portfolio_risk_metrics', 'risk_score',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='0-100 risk score',
               existing_nullable=False)
    op.drop_constraint(None, 'portfolio_performance_metrics', type_='unique')
    op.drop_index(op.f('ix_portfolio_performance_metrics_property_id'), table_name='portfolio_performance_metrics')
    op.drop_index(op.f('ix_portfolio_performance_metrics_metric_type'), table_name='portfolio_performance_metrics')
    op.drop_index(op.f('ix_portfolio_performance_metrics_metric_date'), table_name='portfolio_performance_metrics')
    op.drop_index(op.f('ix_portfolio_performance_metrics_fund_id'), table_name='portfolio_performance_metrics')
    op.drop_index(op.f('ix_portfolio_performance_metrics_company_id'), table_name='portfolio_performance_metrics')
    op.drop_index('idx_perf_metric_property', table_name='portfolio_performance_metrics')
    op.drop_index('idx_perf_metric_fund', table_name='portfolio_performance_metrics')
    op.drop_index('idx_perf_metric_date_type', table_name='portfolio_performance_metrics')
    op.drop_index('idx_perf_metric_company', table_name='portfolio_performance_metrics')
    op.alter_column('portfolio_performance_metrics', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('portfolio_performance_metrics', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('portfolio_performance_metrics', 'breakdown',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Detailed breakdown of metric calculation',
               existing_nullable=True)
    op.alter_column('portfolio_performance_metrics', 'target_value',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Target or benchmark value',
               existing_nullable=True)
    op.drop_constraint(None, 'portfolio_models', type_='unique')
    op.drop_constraint(None, 'portfolio_investments', type_='unique')
    op.create_index('idx_portinv_fund_status', 'portfolio_investments', ['fund_id', 'status'], unique=False)
    op.drop_constraint(None, 'performance_attribution', type_='unique')
    op.drop_index(op.f('ix_performance_attribution_property_id'), table_name='performance_attribution')
    op.drop_index(op.f('ix_performance_attribution_fund_id'), table_name='performance_attribution')
    op.drop_index(op.f('ix_performance_attribution_company_id'), table_name='performance_attribution')
    op.drop_index(op.f('ix_performance_attribution_analysis_date'), table_name='performance_attribution')
    op.drop_index('idx_perf_attr_fund_date', table_name='performance_attribution')
    op.drop_index('idx_perf_attr_company_date', table_name='performance_attribution')
    op.alter_column('performance_attribution', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('performance_attribution', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('performance_attribution', 'attribution_method',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='Brinson, BHB, etc.',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'tracking_error',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment=None,
               existing_comment='Volatility of excess returns',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'detailed_attribution',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Granular attribution data',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'sector_attribution',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Return by property type/sector',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'geographic_attribution',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Return by geography',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'interaction_effect',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment=None,
               existing_comment='Interaction between allocation and selection',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'security_selection_effect',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment=None,
               existing_comment='Return from property selection',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'asset_allocation_effect',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment=None,
               existing_comment='Return from asset allocation',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'excess_return',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment=None,
               existing_comment='Return vs benchmark (%)',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'benchmark_return',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment=None,
               existing_comment='Benchmark return (%)',
               existing_nullable=True)
    op.alter_column('performance_attribution', 'total_return',
               existing_type=sa.NUMERIC(precision=10, scale=4),
               comment=None,
               existing_comment='Total portfolio return (%)',
               existing_nullable=False)
    op.drop_constraint(None, 'ownership_details', type_='unique')
    op.drop_constraint(None, 'model_templates', type_='unique')
    op.drop_constraint(None, 'model_comparisons', type_='unique')
    op.drop_constraint(None, 'model_clones', type_='unique')
    op.drop_constraint(None, 'mixed_use_development_models', type_='unique')
    op.drop_constraint(None, 'milestones', type_='unique')
    op.drop_constraint(None, 'market_update_schedules', type_='unique')
    op.drop_constraint(None, 'market_data_fetch_log', type_='unique')
    op.create_unique_constraint('market_analytics_cache_cache_key_key', 'market_analytics_cache', ['cache_key'])
    op.drop_constraint(None, 'maintenance_requests', type_='unique')
    op.create_index('idx_maint_property_status', 'maintenance_requests', ['property_id', 'status'], unique=False)
    op.create_index('idx_maint_priority', 'maintenance_requests', ['priority'], unique=False)
    op.create_index('idx_maint_created', 'maintenance_requests', ['created_at'], unique=False)
    op.drop_constraint(None, 'loans', type_='unique')
    op.drop_index(op.f('ix_loans_company_id'), table_name='loans')
    op.create_index('idx_loans_maturity', 'loans', ['maturity_date'], unique=False)
    op.create_index('idx_loans_lender', 'loans', ['lender_name'], unique=False)
    op.create_index('idx_loans_company_id', 'loans', ['company_id'], unique=False)
    op.drop_constraint(None, 'loan_comparisons', type_='unique')
    op.drop_index(op.f('ix_loan_comparisons_company_id'), table_name='loan_comparisons')
    op.create_index('idx_loan_comparisons_company_id', 'loan_comparisons', ['company_id'], unique=False)
    op.alter_column('loan_comparisons', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this loan comparison belongs to (for multi-tenancy)',
               existing_comment='Company this comparison belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_constraint(None, 'limited_partners', type_='unique')
    op.drop_index(op.f('ix_limited_partners_company_id'), table_name='limited_partners')
    op.create_index('idx_limited_partners_company_id', 'limited_partners', ['company_id'], unique=False)
    op.alter_column('limited_partners', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this limited partner belongs to (for multi-tenancy)',
               existing_comment='Company this LP belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_constraint(None, 'leases', type_='unique')
    op.drop_constraint(None, 'lease_analyzer_models', type_='unique')
    op.drop_constraint(None, 'lbo_models', type_='foreignkey')
    op.drop_constraint(None, 'lbo_models', type_='unique')
    op.drop_index(op.f('ix_lbo_models_company_id'), table_name='lbo_models')
    op.create_index('idx_lbo_models_company_id', 'lbo_models', ['company_id'], unique=False)
    op.alter_column('lbo_models', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this LBO model belongs to (for multi-tenancy)',
               existing_comment='Company this model belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_constraint(None, 'interest_rates', type_='unique')
    op.drop_constraint(None, 'integration_configs', type_='unique')
    op.drop_constraint(None, 'housing_indicators', type_='unique')
    op.drop_constraint(None, 'hotel_financial_models', type_='unique')
    op.drop_constraint(None, 'high_rise_multifamily_models', type_='unique')
    op.drop_constraint(None, 'geographic_performance', type_='unique')
    op.drop_index(op.f('ix_geographic_performance_zip_code'), table_name='geographic_performance')
    op.drop_index(op.f('ix_geographic_performance_state'), table_name='geographic_performance')
    op.drop_index(op.f('ix_geographic_performance_metric_date'), table_name='geographic_performance')
    op.drop_index(op.f('ix_geographic_performance_country'), table_name='geographic_performance')
    op.drop_index(op.f('ix_geographic_performance_company_id'), table_name='geographic_performance')
    op.drop_index(op.f('ix_geographic_performance_city'), table_name='geographic_performance')
    op.drop_index('idx_geo_perf_date_location', table_name='geographic_performance')
    op.drop_index('idx_geo_perf_company', table_name='geographic_performance')
    op.alter_column('geographic_performance', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('geographic_performance', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('geographic_performance', 'property_types',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Distribution of property types',
               existing_nullable=True)
    op.alter_column('geographic_performance', 'concentration_percentage',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='% of total portfolio',
               existing_nullable=True)
    op.drop_constraint(None, 'generated_reports', type_='unique')
    op.drop_index(op.f('ix_generated_reports_company_id'), table_name='generated_reports')
    op.create_index('idx_generated_reports_company_id', 'generated_reports', ['company_id'], unique=False)
    op.drop_constraint(None, 'funds', type_='unique')
    op.drop_index(op.f('ix_funds_company_id'), table_name='funds')
    op.create_index('idx_funds_vintage', 'funds', ['vintage_year'], unique=False)
    op.create_index('idx_funds_company_id', 'funds', ['company_id'], unique=False)
    op.drop_constraint(None, 'fund_commitments', type_='unique')
    op.drop_constraint(None, 'fix_and_flip_models', type_='unique')
    op.drop_constraint(None, 'financial_documents', type_='unique')
    op.drop_constraint(None, 'extracted_income_statements', type_='unique')
    op.drop_constraint(None, 'extracted_cash_flows', type_='unique')
    op.drop_constraint(None, 'extracted_balance_sheets', type_='unique')
    op.drop_constraint(None, 'employment_data', type_='unique')
    op.drop_constraint(None, 'email_templates', type_='unique')
    op.drop_index(op.f('ix_email_templates_company_id'), table_name='email_templates')
    op.create_index('idx_email_templates_company_id', 'email_templates', ['company_id'], unique=False)
    op.alter_column('email_templates', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this email template belongs to (for multi-tenancy)',
               existing_comment='Company this template belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_constraint(None, 'economics_indicators', type_='unique')
    op.alter_column('economics_indicators', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=True,
               comment=None,
               existing_comment='Record last update timestamp')
    op.alter_column('economics_indicators', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=True,
               comment=None,
               existing_comment='Record creation timestamp',
               existing_server_default=sa.text('now()'))
    op.alter_column('economics_indicators', 'data_source_api',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='API source',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'raw_data',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Raw API response for this indicator',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'source',
               existing_type=sa.VARCHAR(length=255),
               comment=None,
               existing_comment='Data source/provider',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'data_date',
               existing_type=postgresql.TIMESTAMP(),
               comment=None,
               existing_comment='Date of the data',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'reference_period',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='Reference period (e.g., Nov/25)',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'frequency',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='Update frequency (monthly, quarterly, etc.)',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'unit',
               existing_type=sa.VARCHAR(length=100),
               comment=None,
               existing_comment='Unit of measurement',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'lowest_value_numeric',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Historical lowest as number',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'lowest_value',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='Historical lowest value',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'highest_value_numeric',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Historical highest as number',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'highest_value',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='Historical highest value',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'previous_value_numeric',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Previous value as number',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'previous_value',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='Previous value',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'last_value_numeric',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Latest value as number',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'last_value',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='Latest value (as string to handle formats)',
               existing_nullable=True)
    op.alter_column('economics_indicators', 'indicator_name',
               existing_type=sa.VARCHAR(length=255),
               comment=None,
               existing_comment='Specific indicator name',
               existing_nullable=False)
    op.alter_column('economics_indicators', 'category',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='Indicator category (gdp, labour, housing, etc.)',
               existing_nullable=False)
    op.alter_column('economics_indicators', 'country_name',
               existing_type=sa.VARCHAR(length=100),
               comment=None,
               existing_comment='Country name',
               existing_nullable=False)
    op.drop_constraint(None, 'economics_indicator_history', type_='unique')
    op.alter_column('economics_indicator_history', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=True,
               comment=None,
               existing_comment='Record last update timestamp')
    op.alter_column('economics_indicator_history', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=True,
               comment=None,
               existing_comment='Record creation timestamp',
               existing_server_default=sa.text('now()'))
    op.alter_column('economics_indicator_history', 'change_percent',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Percent change from previous',
               existing_nullable=True)
    op.alter_column('economics_indicator_history', 'change_from_previous',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Change from previous period',
               existing_nullable=True)
    op.alter_column('economics_indicator_history', 'value_numeric',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Value as number',
               existing_nullable=True)
    op.alter_column('economics_indicator_history', 'value',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='Value as string',
               existing_nullable=True)
    op.alter_column('economics_indicator_history', 'observation_date',
               existing_type=postgresql.TIMESTAMP(),
               comment=None,
               existing_comment='Date of observation',
               existing_nullable=False)
    op.drop_constraint(None, 'economics_fetch_log', type_='unique')
    op.drop_index(op.f('ix_economics_fetch_log_fetch_timestamp'), table_name='economics_fetch_log')
    op.alter_column('economics_fetch_log', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=True,
               comment=None,
               existing_comment='Record last update timestamp')
    op.alter_column('economics_fetch_log', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=True,
               comment=None,
               existing_comment='Record creation timestamp',
               existing_server_default=sa.text('now()'))
    op.alter_column('economics_fetch_log', 'triggered_by',
               existing_type=sa.VARCHAR(length=100),
               comment=None,
               existing_comment='What triggered the fetch (cron, api, manual)',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'error_details',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Detailed error information',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'error_message',
               existing_type=sa.TEXT(),
               comment=None,
               existing_comment='Error message if failed',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'cache_hit',
               existing_type=sa.VARCHAR(length=20),
               comment=None,
               existing_comment='Whether cache was hit',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'response_time_ms',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='API response time in ms',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'records_stored',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='Number of records stored in DB',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'records_fetched',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='Number of records fetched',
               existing_nullable=True)
    op.alter_column('economics_fetch_log', 'status',
               existing_type=sa.VARCHAR(length=20),
               comment=None,
               existing_comment='success, failed, partial',
               existing_nullable=False)
    op.alter_column('economics_fetch_log', 'endpoint',
               existing_type=sa.VARCHAR(length=255),
               comment=None,
               existing_comment='API endpoint called',
               existing_nullable=False)
    op.drop_constraint(None, 'economics_country_overview', type_='unique')
    op.alter_column('economics_country_overview', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=True,
               comment=None,
               existing_comment='Record last update timestamp')
    op.alter_column('economics_country_overview', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=True,
               comment=None,
               existing_comment='Record creation timestamp',
               existing_server_default=sa.text('now()'))
    op.alter_column('economics_country_overview', 'raw_data',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Raw API response',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'data_source',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='Data source identifier',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'data_date',
               existing_type=postgresql.TIMESTAMP(),
               comment=None,
               existing_comment='Date of the data snapshot',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'government_budget',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Government budget % of GDP',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'debt_to_gdp',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Debt to GDP ratio %',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'current_account',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Current account % of GDP',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'population',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Population in millions',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'unemployment_rate',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Unemployment/Jobless rate %',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'interest_rate',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Interest rate %',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'inflation_rate',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='Inflation rate %',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'gdp_growth',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='GDP growth rate %',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'gdp',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment=None,
               existing_comment='GDP in billions USD',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'country_code',
               existing_type=sa.VARCHAR(length=10),
               comment=None,
               existing_comment='ISO country code',
               existing_nullable=True)
    op.alter_column('economics_country_overview', 'country_name',
               existing_type=sa.VARCHAR(length=100),
               comment=None,
               existing_comment='Country name',
               existing_nullable=False)
    op.drop_constraint(None, 'economics_cache_metadata', type_='unique')
    op.create_unique_constraint('economics_cache_metadata_cache_key_key', 'economics_cache_metadata', ['cache_key'])
    op.alter_column('economics_cache_metadata', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=True,
               comment=None,
               existing_comment='Record last update timestamp')
    op.alter_column('economics_cache_metadata', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               nullable=True,
               comment=None,
               existing_comment='Record creation timestamp',
               existing_server_default=sa.text('now()'))
    op.alter_column('economics_cache_metadata', 'ttl_seconds',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='TTL in seconds',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'expires_at',
               existing_type=postgresql.TIMESTAMP(),
               comment=None,
               existing_comment='When cache expires',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'data_quality',
               existing_type=sa.VARCHAR(length=20),
               comment=None,
               existing_comment='Quality indicator (complete, partial, stale)',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'record_count',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='Number of records in cache',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'access_count',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='Number of times accessed',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'last_accessed',
               existing_type=postgresql.TIMESTAMP(),
               comment=None,
               existing_comment='When cache was last accessed',
               existing_nullable=True)
    op.alter_column('economics_cache_metadata', 'last_fetched',
               existing_type=postgresql.TIMESTAMP(),
               comment=None,
               existing_comment='When data was last fetched from API',
               existing_nullable=True)
    op.add_column('economic_indicators', sa.Column('geography', sa.VARCHAR(length=100), autoincrement=False, nullable=False))
    op.add_column('economic_indicators', sa.Column('data_source', sa.VARCHAR(length=255), autoincrement=False, nullable=True))
    op.add_column('economic_indicators', sa.Column('period_type', sa.VARCHAR(length=20), autoincrement=False, nullable=True))
    op.add_column('economic_indicators', sa.Column('indicator_unit', sa.VARCHAR(length=50), autoincrement=False, nullable=True))
    op.add_column('economic_indicators', sa.Column('indicator_value', sa.NUMERIC(precision=20, scale=4), autoincrement=False, nullable=True))
    op.add_column('economic_indicators', sa.Column('period', sa.DATE(), autoincrement=False, nullable=False))
    op.add_column('economic_indicators', sa.Column('indicator_id', sa.INTEGER(), autoincrement=True, nullable=False))
    op.add_column('economic_indicators', sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True))
    op.add_column('economic_indicators', sa.Column('geography_type', sa.VARCHAR(length=50), autoincrement=False, nullable=True))
    op.drop_index(op.f('ix_economic_indicators_year'), table_name='economic_indicators')
    op.drop_index(op.f('ix_economic_indicators_source'), table_name='economic_indicators')
    op.drop_index(op.f('ix_economic_indicators_indicator_type'), table_name='economic_indicators')
    op.drop_index(op.f('ix_economic_indicators_indicator_code'), table_name='economic_indicators')
    op.drop_index(op.f('ix_economic_indicators_id'), table_name='economic_indicators')
    op.drop_index(op.f('ix_economic_indicators_date'), table_name='economic_indicators')
    op.drop_index(op.f('ix_economic_indicators_country'), table_name='economic_indicators')
    op.create_index('idx_econ_period', 'economic_indicators', ['period'], unique=False)
    op.create_index('idx_econ_indicator', 'economic_indicators', ['indicator_name'], unique=False)
    op.create_index('idx_econ_geography', 'economic_indicators', ['geography'], unique=False)
    op.create_index('idx_econ_composite', 'economic_indicators', ['geography', 'indicator_name', 'period'], unique=False)
    op.alter_column('economic_indicators', 'updated_at',
               existing_type=sa.DateTime(timezone=True),
               type_=postgresql.TIMESTAMP(),
               existing_nullable=True,
               existing_server_default=sa.text('CURRENT_TIMESTAMP'))
    op.alter_column('economic_indicators', 'created_at',
               existing_type=sa.DateTime(timezone=True),
               type_=postgresql.TIMESTAMP(),
               existing_nullable=True,
               existing_server_default=sa.text('CURRENT_TIMESTAMP'))
    op.alter_column('economic_indicators', 'indicator_name',
               existing_type=sa.String(length=255),
               type_=sa.VARCHAR(length=100),
               existing_nullable=False)
    op.drop_column('economic_indicators', 'raw_data')
    op.drop_column('economic_indicators', 'revision_status')
    op.drop_column('economic_indicators', 'seasonal_adjustment')
    op.drop_column('economic_indicators', 'year_over_year_change')
    op.drop_column('economic_indicators', 'month_over_month_change')
    op.drop_column('economic_indicators', 'value_unit')
    op.drop_column('economic_indicators', 'value')
    op.drop_column('economic_indicators', 'date')
    op.drop_column('economic_indicators', 'month')
    op.drop_column('economic_indicators', 'quarter')
    op.drop_column('economic_indicators', 'year')
    op.drop_column('economic_indicators', 'indicator_type')
    op.drop_column('economic_indicators', 'indicator_code')
    op.drop_column('economic_indicators', 'country')
    op.drop_column('economic_indicators', 'source')
    op.drop_column('economic_indicators', 'id')
    op.drop_constraint(None, 'economic_indicator_correlations', type_='unique')
    op.drop_constraint(None, 'distributions', type_='unique')
    op.create_index('idx_dist_fund_date', 'distributions', ['fund_id', 'distribution_date'], unique=False)
    op.drop_constraint(None, 'distribution_items', type_='unique')
    op.drop_constraint(None, 'debt_covenants', type_='unique')
    op.drop_constraint(None, 'deals', type_='foreignkey')
    op.create_foreign_key('deals_broker_id_fkey', 'deals', 'brokers', ['broker_id'], ['id'], ondelete='SET NULL')
    op.drop_constraint(None, 'deals', type_='unique')
    op.drop_index(op.f('ix_deals_deal_type'), table_name='deals')
    op.drop_index(op.f('ix_deals_company_id'), table_name='deals')
    op.create_index('ix_deals_property_name', 'deals', ['property_name'], unique=False)
    op.create_index('ix_deals_market', 'deals', ['market'], unique=False)
    op.create_index('idx_deals_status', 'deals', ['status'], unique=False)
    op.create_index('idx_deals_company_id', 'deals', ['company_id'], unique=False)
    op.alter_column('deals', 'confidence_level',
               existing_type=sa.INTEGER(),
               comment='Confidence % that deal will close',
               existing_comment='Confidence level (0-100)',
               existing_nullable=True)
    op.alter_column('deals', 'priority',
               existing_type=sa.INTEGER(),
               comment='Priority level (1=High, 5=Low)',
               existing_comment='Priority (1-10)',
               existing_nullable=True)
    op.alter_column('deals', 'documents_url',
               existing_type=sa.VARCHAR(length=500),
               comment='Link to deal documents folder',
               existing_comment='Document storage URL',
               existing_nullable=True)
    op.alter_column('deals', 'cons',
               existing_type=sa.TEXT(),
               comment='Deal cons/risks',
               existing_comment='Cons/risks',
               existing_nullable=True)
    op.alter_column('deals', 'pros',
               existing_type=sa.TEXT(),
               comment='Deal pros/strengths',
               existing_comment='Pros/advantages',
               existing_nullable=True)
    op.alter_column('deals', 'notes',
               existing_type=sa.TEXT(),
               comment='Internal notes and comments',
               existing_comment='General notes',
               existing_nullable=True)
    op.alter_column('deals', 'due_diligence_end',
               existing_type=sa.DATE(),
               comment='Due diligence end date',
               existing_comment='DD end date',
               existing_nullable=True)
    op.alter_column('deals', 'due_diligence_start',
               existing_type=sa.DATE(),
               comment='Due diligence start date',
               existing_comment='DD start date',
               existing_nullable=True)
    op.alter_column('deals', 'loi_date',
               existing_type=sa.DATE(),
               comment='LOI submission date',
               existing_comment='Letter of Intent date',
               existing_nullable=True)
    op.alter_column('deals', 'date_identified',
               existing_type=sa.DATE(),
               comment='Date deal was first identified',
               existing_comment='Date deal was identified',
               existing_nullable=True)
    op.alter_column('deals', 'lead_analyst',
               existing_type=sa.VARCHAR(length=255),
               comment='Lead analyst/underwriter',
               existing_comment='Lead analyst/deal manager',
               existing_nullable=True)
    op.alter_column('deals', 'broker_id',
               existing_type=sa.UUID(),
               comment=None,
               existing_comment='Broker/intermediary',
               existing_nullable=True)
    op.alter_column('deals', 'commodity_type',
               existing_type=sa.VARCHAR(length=100),
               comment=None,
               existing_comment='Type of commodity',
               existing_nullable=True)
    op.alter_column('deals', 'asset_class',
               existing_type=sa.VARCHAR(length=100),
               comment=None,
               existing_comment='Asset class (equity, debt, etc)',
               existing_nullable=True)
    op.alter_column('deals', 'quantity',
               existing_type=sa.Float(),
               type_=sa.NUMERIC(precision=15, scale=2),
               comment=None,
               existing_comment='Quantity of shares/units',
               existing_nullable=True)
    op.alter_column('deals', 'ticker_symbol',
               existing_type=sa.VARCHAR(length=20),
               comment=None,
               existing_comment='Stock ticker symbol',
               existing_nullable=True)
    op.alter_column('deals', 'sector',
               existing_type=sa.VARCHAR(length=100),
               comment=None,
               existing_comment='Industry sector',
               existing_nullable=True)
    op.alter_column('deals', 'target_company',
               existing_type=sa.VARCHAR(length=255),
               comment=None,
               existing_comment='Target company name',
               existing_nullable=True)
    op.alter_column('deals', 'irr_target',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Target IRR (%)',
               existing_comment='Target IRR %',
               existing_nullable=True)
    op.alter_column('deals', 'cap_rate',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Going-in cap rate (%)',
               existing_comment='Capitalization rate',
               existing_nullable=True)
    op.alter_column('deals', 'square_feet',
               existing_type=sa.INTEGER(),
               comment='Total square footage',
               existing_comment='Square footage',
               existing_nullable=True)
    op.alter_column('deals', 'units',
               existing_type=sa.INTEGER(),
               comment='Number of units (if applicable)',
               existing_comment='Number of units',
               existing_nullable=True)
    op.alter_column('deals', 'market',
               existing_type=sa.VARCHAR(length=100),
               comment='Market or submarket',
               existing_comment='Market/location',
               existing_nullable=True)
    op.alter_column('deals', 'property_type',
               existing_type=sa.VARCHAR(length=100),
               comment='Property type (e.g., Multifamily, Hotel, Office)',
               existing_comment='Property type (multifamily, office, etc)',
               existing_nullable=True)
    op.alter_column('deals', 'property_address',
               existing_type=sa.VARCHAR(length=500),
               comment='Full property address',
               existing_comment='Property address',
               existing_nullable=True)
    op.alter_column('deals', 'property_name',
               existing_type=sa.VARCHAR(length=255),
               nullable=False,
               comment='Property name or address',
               existing_comment='Property name')
    op.alter_column('deals', 'currency',
               existing_type=sa.VARCHAR(length=10),
               comment=None,
               existing_comment='Currency code',
               existing_nullable=True,
               existing_server_default=sa.text("'USD'::character varying"))
    op.alter_column('deals', 'purchase_price',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Final purchase price (if closed)',
               existing_comment='Final purchase price',
               existing_nullable=True)
    op.alter_column('deals', 'estimated_value',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Our estimated value',
               existing_comment='Estimated market value',
               existing_nullable=True)
    op.alter_column('deals', 'asking_price',
               existing_type=sa.DOUBLE_PRECISION(precision=53),
               comment='Seller asking price',
               existing_comment='Asking/listed price',
               existing_nullable=True)
    op.alter_column('deals', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this deal belongs to (for multi-tenancy)',
               existing_comment='Associated company',
               existing_nullable=True)
    op.alter_column('deals', 'status',
               existing_type=sa.String(length=50),
               type_=postgresql.ENUM('ACTIVE', 'ON_HOLD', 'DEAD', 'CLOSED', name='deal_status'),
               nullable=False,
               existing_comment='Deal status')
    op.alter_column('deals', 'stage',
               existing_type=sa.String(length=50),
               type_=postgresql.ENUM('RESEARCH', 'LOI', 'DUE_DILIGENCE', 'CLOSING', 'CLOSED', 'DEAD', name='deal_stage'),
               nullable=False,
               comment='Current pipeline stage',
               existing_comment='Current stage in pipeline')
    op.alter_column('deals', 'deal_name',
               existing_type=sa.VARCHAR(length=255),
               comment=None,
               existing_comment='General deal name',
               existing_nullable=True)
    op.alter_column('deals', 'deal_type',
               existing_type=sa.VARCHAR(length=50),
               nullable=True,
               comment=None,
               existing_comment='Type of deal',
               existing_server_default=sa.text("'real_estate'::character varying"))
    op.drop_constraint(None, 'deal_tasks', type_='unique')
    op.drop_constraint(None, 'deal_stage_rules', type_='unique')
    op.drop_index(op.f('ix_deal_stage_rules_company_id'), table_name='deal_stage_rules')
    op.create_index('idx_deal_stage_rules_company_id', 'deal_stage_rules', ['company_id'], unique=False)
    op.alter_column('deal_stage_rules', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this deal stage rule belongs to (for multi-tenancy)',
               existing_comment='Company this rule belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_constraint(None, 'deal_scores', type_='unique')
    op.drop_constraint(None, 'deal_reminders', type_='unique')
    op.drop_constraint(None, 'deal_documents', type_='unique')
    op.drop_constraint(None, 'deal_activities', type_='unique')
    op.drop_constraint(None, 'dcf_models', type_='foreignkey')
    op.drop_constraint(None, 'dcf_models', type_='unique')
    op.drop_index(op.f('ix_dcf_models_company_id'), table_name='dcf_models')
    op.create_index('idx_dcf_models_company_id', 'dcf_models', ['company_id'], unique=False)
    op.alter_column('dcf_models', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this DCF model belongs to (for multi-tenancy)',
               existing_comment='Company this model belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_constraint(None, 'dashboards', type_='unique')
    op.drop_index(op.f('ix_dashboards_user_id'), table_name='dashboards')
    op.drop_index(op.f('ix_dashboards_dashboard_type'), table_name='dashboards')
    op.drop_index(op.f('ix_dashboards_company_id'), table_name='dashboards')
    op.drop_index('idx_dashboard_user_type', table_name='dashboards')
    op.drop_index('idx_dashboard_company', table_name='dashboards')
    op.create_index('idx_dashboards_user_type', 'dashboards', ['user_id', 'dashboard_type'], unique=False)
    op.alter_column('dashboards', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('dashboards', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('dashboards', 'cache_duration',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='Cache duration in seconds',
               existing_nullable=True)
    op.alter_column('dashboards', 'auto_refresh_interval',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='Auto-refresh in seconds',
               existing_nullable=True)
    op.alter_column('dashboards', 'allowed_filters',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Available filter options',
               existing_nullable=True)
    op.alter_column('dashboards', 'default_filters',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Default filter values',
               existing_nullable=True)
    op.alter_column('dashboards', 'theme_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Color scheme and styling',
               existing_nullable=True)
    op.alter_column('dashboards', 'layout_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Grid layout configuration',
               existing_nullable=True)
    op.alter_column('dashboards', 'shared_with_roles',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='List of roles that can view this dashboard',
               existing_nullable=True)
    op.alter_column('dashboards', 'is_default',
               existing_type=sa.BOOLEAN(),
               comment=None,
               existing_comment='Default dashboard for this type',
               existing_nullable=True)
    op.alter_column('dashboards', 'is_public',
               existing_type=sa.BOOLEAN(),
               comment=None,
               existing_comment='Visible to other users',
               existing_nullable=True)
    op.drop_constraint(None, 'dashboard_widgets', type_='unique')
    op.drop_index(op.f('ix_dashboard_widgets_dashboard_id'), table_name='dashboard_widgets')
    op.drop_index('idx_widget_dashboard_order', table_name='dashboard_widgets')
    op.create_index('idx_widgets_dashboard', 'dashboard_widgets', ['dashboard_id'], unique=False)
    op.alter_column('dashboard_widgets', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('dashboard_widgets', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('dashboard_widgets', 'order',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='Display order',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'refresh_interval',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='Refresh interval in seconds',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'local_filters',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Widget-specific filters',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'on_click_action',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Action to perform on click',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'drill_down_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Drill-down navigation and filters',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'visualization_options',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Color, legend, axes options',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'chart_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Chart.js or visualization config',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'data_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Query parameters and data configuration',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'data_source',
               existing_type=sa.VARCHAR(length=100),
               comment=None,
               existing_comment='API endpoint or data source',
               existing_nullable=True)
    op.alter_column('dashboard_widgets', 'height',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='Grid units',
               existing_nullable=False)
    op.alter_column('dashboard_widgets', 'width',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='Grid units',
               existing_nullable=False)
    op.drop_constraint(None, 'dashboard_filters', type_='unique')
    op.drop_index(op.f('ix_dashboard_filters_user_id'), table_name='dashboard_filters')
    op.drop_index(op.f('ix_dashboard_filters_dashboard_id'), table_name='dashboard_filters')
    op.drop_index('idx_filter_dashboard_user', table_name='dashboard_filters')
    op.alter_column('dashboard_filters', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('dashboard_filters', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('dashboard_filters', 'filter_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Filter values and operators',
               existing_nullable=False)
    op.drop_constraint(None, 'custom_markets', type_='unique')
    op.drop_constraint(None, 'custom_kpis', type_='unique')
    op.drop_index(op.f('ix_custom_kpis_user_id'), table_name='custom_kpis')
    op.drop_index(op.f('ix_custom_kpis_company_id'), table_name='custom_kpis')
    op.drop_index(op.f('ix_custom_kpis_category'), table_name='custom_kpis')
    op.drop_index('idx_kpi_user_category', table_name='custom_kpis')
    op.drop_index('idx_kpi_company_active', table_name='custom_kpis')
    op.create_index('idx_kpis_company', 'custom_kpis', ['company_id'], unique=False)
    op.alter_column('custom_kpis', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('custom_kpis', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('custom_kpis', 'shared_with_users',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='List of user IDs',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'suffix',
               existing_type=sa.VARCHAR(length=10),
               comment=None,
               existing_comment='% or other suffix',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'prefix',
               existing_type=sa.VARCHAR(length=10),
               comment=None,
               existing_comment='$ or other prefix',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'unit',
               existing_type=sa.VARCHAR(length=20),
               comment=None,
               existing_comment='%, $, units, etc.',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'calculation_config',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Additional calculation parameters',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'aggregation_period',
               existing_type=sa.VARCHAR(length=20),
               comment=None,
               existing_comment='daily, weekly, monthly, quarterly, yearly',
               existing_nullable=True)
    op.alter_column('custom_kpis', 'data_sources',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Data sources for calculation',
               existing_nullable=False)
    op.alter_column('custom_kpis', 'formula',
               existing_type=sa.TEXT(),
               comment=None,
               existing_comment='Custom formula for calculation',
               existing_nullable=True)
    op.drop_constraint(None, 'comps', type_='unique')
    op.drop_index(op.f('ix_comps_company_id'), table_name='comps')
    op.create_index('idx_comps_company_id', 'comps', ['company_id'], unique=False)
    op.alter_column('comps', 'company_id',
               existing_type=sa.UUID(),
               comment='Company this comparable property belongs to (for multi-tenancy)',
               existing_comment='Company this comp belongs to (for multi-tenancy)',
               existing_nullable=True)
    op.drop_constraint(None, 'competitive_properties', type_='unique')
    op.drop_constraint(None, 'comparable_companies', type_='unique')
    op.drop_constraint(None, 'companies', type_='unique')
    op.drop_constraint(None, 'chart_of_accounts', type_='unique')
    op.drop_constraint(None, 'cash_flow_projections', type_='unique')
    op.drop_index(op.f('ix_cash_flow_projections_property_id'), table_name='cash_flow_projections')
    op.drop_index(op.f('ix_cash_flow_projections_projection_date'), table_name='cash_flow_projections')
    op.drop_index(op.f('ix_cash_flow_projections_fund_id'), table_name='cash_flow_projections')
    op.drop_index(op.f('ix_cash_flow_projections_company_id'), table_name='cash_flow_projections')
    op.drop_index('idx_cashflow_proj_date', table_name='cash_flow_projections')
    op.drop_index('idx_cashflow_proj_company', table_name='cash_flow_projections')
    op.alter_column('cash_flow_projections', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('cash_flow_projections', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('cash_flow_projections', 'scenario',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='base, optimistic, pessimistic',
               existing_nullable=True)
    op.alter_column('cash_flow_projections', 'confidence_level',
               existing_type=sa.VARCHAR(length=20),
               comment=None,
               existing_comment='high, medium, low',
               existing_nullable=True)
    op.alter_column('cash_flow_projections', 'projection_month',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='Month offset from creation (0-12 for rolling 12)',
               existing_nullable=False)
    op.drop_constraint(None, 'capital_calls', type_='unique')
    op.create_index('idx_capcalls_fund_status', 'capital_calls', ['fund_id', 'status'], unique=False)
    op.create_index('idx_capcalls_due_date', 'capital_calls', ['due_date'], unique=False)
    op.drop_constraint(None, 'capital_call_items', type_='unique')
    op.drop_constraint(None, 'budget_items', type_='unique')
    op.drop_constraint(None, 'brokers', type_='unique')
    op.drop_index(op.f('ix_brokers_company_id'), table_name='brokers')
    op.create_index('idx_brokers_company_id', 'brokers', ['company_id'], unique=False)
    op.drop_constraint(None, 'benchmarks', type_='unique')
    op.drop_index(op.f('ix_benchmarks_metric_name'), table_name='benchmarks')
    op.drop_index(op.f('ix_benchmarks_company_id'), table_name='benchmarks')
    op.drop_index(op.f('ix_benchmarks_benchmark_type'), table_name='benchmarks')
    op.drop_index(op.f('ix_benchmarks_as_of_date'), table_name='benchmarks')
    op.drop_index('idx_benchmark_type_active', table_name='benchmarks')
    op.drop_index('idx_benchmark_metric_date', table_name='benchmarks')
    op.create_index('idx_benchmarks_type_source', 'benchmarks', ['benchmark_type', 'data_source'], unique=False)
    op.alter_column('benchmarks', 'updated_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record last update timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('benchmarks', 'created_at',
               existing_type=postgresql.TIMESTAMP(timezone=True),
               comment=None,
               existing_comment='Record creation timestamp',
               existing_nullable=False,
               existing_server_default=sa.text('now()'))
    op.alter_column('benchmarks', 'percentile_50',
               existing_type=sa.NUMERIC(precision=20, scale=2),
               comment=None,
               existing_comment='Median',
               existing_nullable=True)
    op.alter_column('benchmarks', 'confidence_level',
               existing_type=sa.VARCHAR(length=20),
               comment=None,
               existing_comment='high, medium, low',
               existing_nullable=True)
    op.alter_column('benchmarks', 'data_source',
               existing_type=sa.VARCHAR(length=200),
               comment=None,
               existing_comment='NCREIF, NAREIT, custom, etc.',
               existing_nullable=True)
    op.alter_column('benchmarks', 'peer_count',
               existing_type=sa.INTEGER(),
               comment=None,
               existing_comment='Number of peers in comparison',
               existing_nullable=True)
    op.alter_column('benchmarks', 'peer_group_definition',
               existing_type=postgresql.JSON(astext_type=sa.Text()),
               comment=None,
               existing_comment='Criteria for peer selection',
               existing_nullable=True)
    op.alter_column('benchmarks', 'time_period',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='Quarter, year, etc.',
               existing_nullable=True)
    op.alter_column('benchmarks', 'property_type',
               existing_type=sa.VARCHAR(length=50),
               comment=None,
               existing_comment='Asset class',
               existing_nullable=True)
    op.alter_column('benchmarks', 'geography',
               existing_type=sa.VARCHAR(length=100),
               comment=None,
               existing_comment='National, regional, city',
               existing_nullable=True)
    op.alter_column('benchmarks', 'value_range_max',
               existing_type=sa.NUMERIC(precision=20, scale=2),
               comment=None,
               existing_comment='Upper bound',
               existing_nullable=True)
    op.alter_column('benchmarks', 'value_range_min',
               existing_type=sa.NUMERIC(precision=20, scale=2),
               comment=None,
               existing_comment='Lower bound',
               existing_nullable=True)
    op.alter_column('benchmarks', 'metric_name',
               existing_type=sa.VARCHAR(length=100),
               comment=None,
               existing_comment='IRR, MOIC, occupancy, etc.',
               existing_nullable=False)
    op.drop_constraint(None, 'amortization_schedule_entries', type_='unique')
    op.drop_constraint(None, 'accounting_transactions', type_='unique')
    op.create_index('idx_acctrans_type', 'accounting_transactions', ['transaction_type'], unique=False)
    op.create_index('idx_acctrans_profile_date', 'accounting_transactions', ['accounting_profile_id', 'transaction_date'], unique=False)
    op.drop_constraint(None, 'accounting_profiles', type_='unique')
    op.create_index('idx_accprof_company', 'accounting_profiles', ['company_id'], unique=False)
    op.create_table('markitdown_documents',
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('document_name', sa.VARCHAR(length=500), autoincrement=False, nullable=False),
    sa.Column('file_type', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('mime_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('company_id', sa.UUID(), autoincrement=False, nullable=True),
    sa.Column('company_name', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('project_name', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('file_path', sa.VARCHAR(length=1000), autoincrement=False, nullable=False),
    sa.Column('file_size_kb', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('file_hash', sa.VARCHAR(length=64), autoincrement=False, nullable=True),
    sa.Column('upload_date', postgresql.TIMESTAMP(), autoincrement=False, nullable=False),
    sa.Column('uploaded_by', sa.UUID(), autoincrement=False, nullable=True),
    sa.Column('conversion_status', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('conversion_method', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('conversion_started', postgresql.TIMESTAMP(), autoincrement=False, nullable=True),
    sa.Column('conversion_completed', postgresql.TIMESTAMP(), autoincrement=False, nullable=True),
    sa.Column('conversion_duration_ms', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('conversion_confidence', sa.DOUBLE_PRECISION(precision=53), autoincrement=False, nullable=True),
    sa.Column('character_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('word_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('page_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('llm_enhanced', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('llm_model', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('llm_tokens_used', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('needs_review', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('reviewed_by', sa.UUID(), autoincrement=False, nullable=True),
    sa.Column('reviewed_date', postgresql.TIMESTAMP(), autoincrement=False, nullable=True),
    sa.Column('review_notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('has_errors', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('error_message', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('warnings', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('detected_language', sa.VARCHAR(length=10), autoincrement=False, nullable=True),
    sa.Column('detected_structure', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('extracted_metadata', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('tags', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('categories', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('keywords', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('view_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('last_viewed', postgresql.TIMESTAMP(), autoincrement=False, nullable=True),
    sa.Column('export_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(), autoincrement=False, nullable=True),
    sa.Column('deleted_at', postgresql.TIMESTAMP(), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['company_id'], ['companies.id'], name='markitdown_documents_company_id_fkey', ondelete='SET NULL'),
    sa.PrimaryKeyConstraint('id', name='markitdown_documents_pkey'),
    postgresql_ignore_search_path=False
    )
    op.create_index('ix_markitdown_documents_needs_review', 'markitdown_documents', ['needs_review'], unique=False)
    op.create_index('ix_markitdown_documents_has_errors', 'markitdown_documents', ['has_errors'], unique=False)
    op.create_index('ix_markitdown_documents_file_type', 'markitdown_documents', ['file_type'], unique=False)
    op.create_index('ix_markitdown_documents_file_hash', 'markitdown_documents', ['file_hash'], unique=False)
    op.create_index('ix_markitdown_documents_conversion_status', 'markitdown_documents', ['conversion_status'], unique=False)
    op.create_index('ix_markitdown_documents_company_id', 'markitdown_documents', ['company_id'], unique=False)
    op.create_table('markitdown_versions',
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('document_id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('version_number', sa.INTEGER(), autoincrement=False, nullable=False),
    sa.Column('version_date', postgresql.TIMESTAMP(), autoincrement=False, nullable=False),
    sa.Column('created_by', sa.UUID(), autoincrement=False, nullable=True),
    sa.Column('conversion_method', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('markdown_text', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('conversion_confidence', sa.DOUBLE_PRECISION(precision=53), autoincrement=False, nullable=True),
    sa.Column('character_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('change_summary', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('diff_stats', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('settings_used', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['document_id'], ['markitdown_documents.id'], name='markitdown_versions_document_id_fkey', ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id', name='markitdown_versions_pkey')
    )
    op.create_index('ix_markitdown_versions_document_id', 'markitdown_versions', ['document_id'], unique=False)
    op.create_table('future_zoning_initiatives',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('initiative_name', sa.VARCHAR(length=300), autoincrement=False, nullable=False),
    sa.Column('initiative_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('area_affected_acres', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('neighborhoods_affected', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('current_zoning', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('proposed_zoning', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('estimated_new_units_enabled', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('estimated_new_sf_enabled', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('proposal_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('expected_approval_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('approval_likelihood', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('political_support_level', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='future_zoning_initiatives_pkey')
    )
    op.create_index('ix_future_zoning_initiatives_period', 'future_zoning_initiatives', ['period'], unique=False)
    op.create_index('ix_future_zoning_initiatives_market', 'future_zoning_initiatives', ['market'], unique=False)
    op.create_index('ix_future_zoning_initiatives_initiative_type', 'future_zoning_initiatives', ['initiative_type'], unique=False)
    op.create_index('ix_future_zoning_initiatives_id', 'future_zoning_initiatives', ['id'], unique=False)
    op.create_index('ix_future_zoning_initiatives_approval_likelihood', 'future_zoning_initiatives', ['approval_likelihood'], unique=False)
    op.create_table('portfolio_companies',
    sa.Column('fund_id', sa.UUID(), autoincrement=False, nullable=False, comment='Reference to the fund that owns this company'),
    sa.Column('company_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False, comment='Company name (DBA)'),
    sa.Column('company_legal_name', sa.VARCHAR(length=255), autoincrement=False, nullable=True, comment='Legal entity name'),
    sa.Column('ticker_symbol', sa.VARCHAR(length=10), autoincrement=False, nullable=True, comment='Stock ticker if public'),
    sa.Column('website', sa.VARCHAR(length=255), autoincrement=False, nullable=True, comment='Company website URL'),
    sa.Column('investment_date', sa.DATE(), autoincrement=False, nullable=False, comment='Date of investment'),
    sa.Column('deal_type', sa.VARCHAR(length=50), autoincrement=False, nullable=False, comment='Deal type: LBO, Growth, Minority, etc.'),
    sa.Column('sector', sa.VARCHAR(length=100), autoincrement=False, nullable=False, comment="Primary sector (e.g., 'Technology')"),
    sa.Column('industry', sa.VARCHAR(length=100), autoincrement=False, nullable=True, comment="Industry within sector (e.g., 'SaaS')"),
    sa.Column('sub_sector', sa.VARCHAR(length=100), autoincrement=False, nullable=True, comment='Sub-sector classification'),
    sa.Column('business_description', sa.TEXT(), autoincrement=False, nullable=True, comment='Detailed business description'),
    sa.Column('headquarters_city', sa.VARCHAR(length=100), autoincrement=False, nullable=True, comment='Headquarters city'),
    sa.Column('headquarters_state', sa.VARCHAR(length=100), autoincrement=False, nullable=True, comment='Headquarters state/province'),
    sa.Column('headquarters_country', sa.VARCHAR(length=100), autoincrement=False, nullable=False, comment='Headquarters country'),
    sa.Column('entry_revenue', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Revenue at time of investment'),
    sa.Column('entry_ebitda', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='EBITDA at time of investment'),
    sa.Column('entry_multiple', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True, comment='Entry valuation multiple (EV/EBITDA)'),
    sa.Column('purchase_price', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Total purchase price (enterprise value)'),
    sa.Column('equity_invested', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Equity invested by fund'),
    sa.Column('debt_raised', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Debt financing raised'),
    sa.Column('ownership_percentage', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True, comment='Ownership percentage (decimal, e.g., 0.75 for 75%)'),
    sa.Column('company_status', sa.VARCHAR(length=50), autoincrement=False, nullable=False, comment='Status: Active, Exited, Written Off, On Hold'),
    sa.Column('exit_date', sa.DATE(), autoincrement=False, nullable=True, comment='Date of exit (if applicable)'),
    sa.Column('exit_type', sa.VARCHAR(length=50), autoincrement=False, nullable=True, comment='Exit type: IPO, Strategic Sale, Secondary, etc.'),
    sa.Column('exit_proceeds', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Gross proceeds from exit'),
    sa.Column('realized_moic', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True, comment='Realized Multiple on Invested Capital'),
    sa.Column('realized_irr', sa.NUMERIC(precision=10, scale=4), autoincrement=False, nullable=True, comment='Realized Internal Rate of Return (decimal)'),
    sa.Column('risk_rating', sa.VARCHAR(length=20), autoincrement=False, nullable=False, comment='Risk rating: Low, Medium, High'),
    sa.Column('internal_rating', sa.VARCHAR(length=10), autoincrement=False, nullable=True, comment='Internal performance rating (A, B, C, D)'),
    sa.Column('ceo_name', sa.VARCHAR(length=255), autoincrement=False, nullable=True, comment='CEO name'),
    sa.Column('cfo_name', sa.VARCHAR(length=255), autoincrement=False, nullable=True, comment='CFO name'),
    sa.Column('board_members', postgresql.ARRAY(sa.VARCHAR()), autoincrement=False, nullable=True, comment='List of board member names'),
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record last update timestamp'),
    sa.Column('created_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who created this record'),
    sa.Column('updated_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who last updated this record'),
    sa.Column('deleted_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True, comment='Record deletion timestamp (NULL if not deleted)'),
    sa.Column('deleted_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who deleted this record'),
    sa.CheckConstraint("company_status::text = ANY (ARRAY['Active'::character varying, 'Exited'::character varying, 'Written Off'::character varying, 'On Hold'::character varying]::text[])", name='status_valid'),
    sa.CheckConstraint('ownership_percentage >= 0::numeric AND ownership_percentage <= 1::numeric', name='ownership_valid'),
    sa.PrimaryKeyConstraint('id', name='portfolio_companies_pkey'),
    postgresql_ignore_search_path=False
    )
    op.create_index('ix_portfolio_companies_sector', 'portfolio_companies', ['sector'], unique=False)
    op.create_index('ix_portfolio_companies_investment_date', 'portfolio_companies', ['investment_date'], unique=False)
    op.create_index('ix_portfolio_companies_fund_id', 'portfolio_companies', ['fund_id'], unique=False)
    op.create_index('ix_portfolio_companies_company_status', 'portfolio_companies', ['company_status'], unique=False)
    op.create_index('ix_portfolio_companies_company_name', 'portfolio_companies', ['company_name'], unique=False)
    op.create_table('zoning_reforms',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('reform_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('area_affected', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('old_zoning', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('new_zoning', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('effective_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('units_enabled', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='zoning_reforms_pkey')
    )
    op.create_index('ix_zoning_reforms_market', 'zoning_reforms', ['market'], unique=False)
    op.create_index('ix_zoning_reforms_id', 'zoning_reforms', ['id'], unique=False)
    op.create_index('ix_zoning_reforms_effective_date', 'zoning_reforms', ['effective_date'], unique=False)
    op.create_table('market_data',
    sa.Column('market_data_id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market_name', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('submarket_name', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('property_type', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('property_class', sa.VARCHAR(length=10), autoincrement=False, nullable=True),
    sa.Column('metric_name', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('metric_value', sa.NUMERIC(precision=15, scale=4), autoincrement=False, nullable=True),
    sa.Column('metric_unit', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('data_source', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('confidence_level', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(), server_default=sa.text('CURRENT_TIMESTAMP'), autoincrement=False, nullable=True),
    sa.CheckConstraint("confidence_level::text = ANY (ARRAY['high'::character varying, 'medium'::character varying, 'low'::character varying, NULL::character varying]::text[])", name='valid_confidence'),
    sa.CheckConstraint("market_name::text = ANY (ARRAY['NYC'::character varying, 'Miami'::character varying]::text[])", name='valid_market'),
    sa.CheckConstraint("property_class::text = ANY (ARRAY['A'::character varying, 'B'::character varying, 'C'::character varying, NULL::character varying]::text[])", name='valid_class'),
    sa.CheckConstraint("property_type::text = ANY (ARRAY['multifamily'::character varying, 'office'::character varying, 'retail'::character varying, 'hotel'::character varying, 'mixed-use'::character varying, 'sfr'::character varying, 'land'::character varying]::text[])", name='valid_property_type'),
    sa.PrimaryKeyConstraint('market_data_id', name='market_data_pkey')
    )
    op.create_index('idx_market_data_type', 'market_data', ['property_type', 'property_class'], unique=False)
    op.create_index('idx_market_data_submarket', 'market_data', ['submarket_name'], unique=False)
    op.create_index('idx_market_data_period', 'market_data', ['period'], unique=False)
    op.create_index('idx_market_data_metric', 'market_data', ['metric_name'], unique=False)
    op.create_index('idx_market_data_market', 'market_data', ['market_name'], unique=False)
    op.create_index('idx_market_data_composite', 'market_data', ['market_name', 'property_type', 'metric_name', 'period'], unique=False)
    op.create_table('regulatory_barriers',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('barrier_type', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('barrier_description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('affected_project_types', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('avg_delay_months', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_additional_cost_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('projects_impacted_annually', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('severity_rating', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('potential_reform_status', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('estimated_units_blocked_annually', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('economic_impact_mm', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='regulatory_barriers_pkey')
    )
    op.create_index('ix_regulatory_barriers_severity_rating', 'regulatory_barriers', ['severity_rating'], unique=False)
    op.create_index('ix_regulatory_barriers_period', 'regulatory_barriers', ['period'], unique=False)
    op.create_index('ix_regulatory_barriers_market', 'regulatory_barriers', ['market'], unique=False)
    op.create_index('ix_regulatory_barriers_id', 'regulatory_barriers', ['id'], unique=False)
    op.create_index('ix_regulatory_barriers_barrier_type', 'regulatory_barriers', ['barrier_type'], unique=False)
    op.create_table('entitled_land_inventory',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('project_name', sa.VARCHAR(length=300), autoincrement=False, nullable=True),
    sa.Column('zone_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('entitled_units', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('entitled_sf', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('project_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('approval_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('years_since_approval', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('estimated_land_value_mm', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('estimated_built_value_mm', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('development_status', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('constraints', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='entitled_land_inventory_pkey')
    )
    op.create_index('ix_entitled_land_inventory_zone_type', 'entitled_land_inventory', ['zone_type'], unique=False)
    op.create_index('ix_entitled_land_inventory_project_type', 'entitled_land_inventory', ['project_type'], unique=False)
    op.create_index('ix_entitled_land_inventory_period', 'entitled_land_inventory', ['period'], unique=False)
    op.create_index('ix_entitled_land_inventory_market', 'entitled_land_inventory', ['market'], unique=False)
    op.create_index('ix_entitled_land_inventory_id', 'entitled_land_inventory', ['id'], unique=False)
    op.create_index('ix_entitled_land_inventory_development_status', 'entitled_land_inventory', ['development_status'], unique=False)
    op.create_table('str_compliance_enforcement',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('regulation_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('enforcement_level', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('violations_issued', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('fines_collected_usd', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_fine_per_violation_usd', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('compliance_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('registered_hosts_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('unregistered_hosts_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('platform_cooperation_level', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_compliance_enforcement_pkey')
    )
    op.create_index('ix_str_compliance_enforcement_period', 'str_compliance_enforcement', ['period'], unique=False)
    op.create_index('ix_str_compliance_enforcement_market', 'str_compliance_enforcement', ['market'], unique=False)
    op.create_index('ix_str_compliance_enforcement_id', 'str_compliance_enforcement', ['id'], unique=False)
    op.create_index('ix_str_compliance_enforcement_enforcement_level', 'str_compliance_enforcement', ['enforcement_level'], unique=False)
    op.create_table('real_estate_market_data',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market_name', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('submarket_name', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('property_type', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('property_class', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('metric_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('metric_value', sa.NUMERIC(precision=20, scale=6), autoincrement=False, nullable=False),
    sa.Column('metric_unit', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('confidence_level', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='real_estate_market_data_pkey')
    )
    op.create_index('ix_real_estate_market_data_submarket_name', 'real_estate_market_data', ['submarket_name'], unique=False)
    op.create_index('ix_real_estate_market_data_property_type', 'real_estate_market_data', ['property_type'], unique=False)
    op.create_index('ix_real_estate_market_data_property_class', 'real_estate_market_data', ['property_class'], unique=False)
    op.create_index('ix_real_estate_market_data_period', 'real_estate_market_data', ['period'], unique=False)
    op.create_index('ix_real_estate_market_data_metric_name', 'real_estate_market_data', ['metric_name'], unique=False)
    op.create_index('ix_real_estate_market_data_market_name', 'real_estate_market_data', ['market_name'], unique=False)
    op.create_index('ix_real_estate_market_data_id', 'real_estate_market_data', ['id'], unique=False)
    op.create_index('idx_market_metric', 'real_estate_market_data', ['market_name', 'property_type', 'metric_name', 'period'], unique=False)
    op.create_table('land_cost_economics',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('zone_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('land_price_per_sf', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('land_price_per_developable_sf', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('land_as_pct_of_total_cost', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('estimated_construction_cost_per_sf', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('pro_forma_yield_on_cost_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='land_cost_economics_pkey')
    )
    op.create_index('ix_land_cost_economics_zone_type', 'land_cost_economics', ['zone_type'], unique=False)
    op.create_index('ix_land_cost_economics_period', 'land_cost_economics', ['period'], unique=False)
    op.create_index('ix_land_cost_economics_market', 'land_cost_economics', ['market'], unique=False)
    op.create_index('ix_land_cost_economics_id', 'land_cost_economics', ['id'], unique=False)
    op.create_table('str_supply_demand_dynamics',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('total_supply_units', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('new_listings_mtd', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('delisted_units_mtd', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('net_supply_change_mtd', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('supply_growth_rate_yoy_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('total_demand_bookings', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('demand_growth_rate_yoy_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('supply_demand_ratio', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('market_saturation_level', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('projected_supply_12m', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('projected_demand_12m', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_supply_demand_dynamics_pkey')
    )
    op.create_index('ix_str_supply_demand_dynamics_period', 'str_supply_demand_dynamics', ['period'], unique=False)
    op.create_index('ix_str_supply_demand_dynamics_market_saturation_level', 'str_supply_demand_dynamics', ['market_saturation_level'], unique=False)
    op.create_index('ix_str_supply_demand_dynamics_market', 'str_supply_demand_dynamics', ['market'], unique=False)
    op.create_index('ix_str_supply_demand_dynamics_id', 'str_supply_demand_dynamics', ['id'], unique=False)
    op.create_table('geographic_economic_indicators',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('geography', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('geography_type', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('indicator_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('indicator_value', sa.NUMERIC(precision=20, scale=6), autoincrement=False, nullable=False),
    sa.Column('indicator_unit', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('period_type', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='geographic_economic_indicators_pkey')
    )
    op.create_index('ix_geographic_economic_indicators_period', 'geographic_economic_indicators', ['period'], unique=False)
    op.create_index('ix_geographic_economic_indicators_indicator_name', 'geographic_economic_indicators', ['indicator_name'], unique=False)
    op.create_index('ix_geographic_economic_indicators_id', 'geographic_economic_indicators', ['id'], unique=False)
    op.create_index('ix_geographic_economic_indicators_geography_type', 'geographic_economic_indicators', ['geography_type'], unique=False)
    op.create_index('ix_geographic_economic_indicators_geography', 'geographic_economic_indicators', ['geography'], unique=False)
    op.create_index('idx_geo_indicator', 'geographic_economic_indicators', ['geography', 'indicator_name', 'period'], unique=False)
    op.create_table('valuations',
    sa.Column('company_id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('valuation_date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('valuation_method', sa.VARCHAR(length=50), autoincrement=False, nullable=True, comment='DCF, Market Comp, Transaction, etc.'),
    sa.Column('enterprise_value', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('equity_value', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('valuation_assumptions', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=True, comment='JSON of assumptions'),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record last update timestamp'),
    sa.Column('created_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who created this record'),
    sa.Column('updated_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who last updated this record'),
    sa.ForeignKeyConstraint(['company_id'], ['portfolio_companies.id'], name='valuations_company_id_fkey', ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id', name='valuations_pkey')
    )
    op.create_index('ix_valuations_valuation_date', 'valuations', ['valuation_date'], unique=False)
    op.create_index('ix_valuations_company_id', 'valuations', ['company_id'], unique=False)
    op.create_table('str_housing_market_impact',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('str_listings_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('str_pct_of_housing_stock', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('ltr_units_lost_to_str', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('estimated_rent_increase_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('estimated_home_price_increase_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('neighborhoods_most_impacted', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('housing_affordability_index_change', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('vacancy_rate_ltr_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('vacancy_rate_str_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_housing_market_impact_pkey')
    )
    op.create_index('ix_str_housing_market_impact_period', 'str_housing_market_impact', ['period'], unique=False)
    op.create_index('ix_str_housing_market_impact_market', 'str_housing_market_impact', ['market'], unique=False)
    op.create_index('ix_str_housing_market_impact_id', 'str_housing_market_impact', ['id'], unique=False)
    op.create_table('time_series_indicators',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('period_type', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('indicator_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('indicator_value', sa.NUMERIC(precision=20, scale=6), autoincrement=False, nullable=True),
    sa.Column('indicator_unit', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('source_category', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='time_series_indicators_pkey')
    )
    op.create_index('ix_time_series_indicators_source_category', 'time_series_indicators', ['source_category'], unique=False)
    op.create_index('ix_time_series_indicators_period_type', 'time_series_indicators', ['period_type'], unique=False)
    op.create_index('ix_time_series_indicators_indicator_name', 'time_series_indicators', ['indicator_name'], unique=False)
    op.create_index('ix_time_series_indicators_id', 'time_series_indicators', ['id'], unique=False)
    op.create_index('ix_time_series_indicators_date', 'time_series_indicators', ['date'], unique=False)
    op.create_index('idx_timeseries', 'time_series_indicators', ['date', 'indicator_name', 'source_category'], unique=False)
    op.create_table('financial_metrics',
    sa.Column('company_id', sa.UUID(), autoincrement=False, nullable=False, comment='Reference to portfolio company'),
    sa.Column('period_date', sa.DATE(), autoincrement=False, nullable=False, comment='Period end date'),
    sa.Column('period_type', sa.VARCHAR(length=20), autoincrement=False, nullable=False, comment='Period type: Monthly, Quarterly, Annual, LTM'),
    sa.Column('fiscal_year', sa.INTEGER(), autoincrement=False, nullable=False, comment='Fiscal year'),
    sa.Column('fiscal_quarter', sa.INTEGER(), autoincrement=False, nullable=True, comment='Fiscal quarter (1-4), NULL for annual'),
    sa.Column('fiscal_month', sa.INTEGER(), autoincrement=False, nullable=True, comment='Fiscal month (1-12), NULL for quarterly/annual'),
    sa.Column('revenue', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Total revenue'),
    sa.Column('cogs', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Cost of goods sold'),
    sa.Column('gross_profit', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Gross profit'),
    sa.Column('gross_margin', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True, comment='Gross margin %'),
    sa.Column('operating_expenses', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Total operating expenses'),
    sa.Column('sales_marketing', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Sales & marketing expenses'),
    sa.Column('research_development', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='R&D expenses'),
    sa.Column('general_admin', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='G&A expenses'),
    sa.Column('ebitda', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='EBITDA'),
    sa.Column('ebitda_margin', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True, comment='EBITDA margin %'),
    sa.Column('adjusted_ebitda', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Adjusted EBITDA'),
    sa.Column('adjusted_ebitda_margin', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True, comment='Adjusted EBITDA margin %'),
    sa.Column('depreciation', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Depreciation'),
    sa.Column('amortization', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Amortization'),
    sa.Column('ebit', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='EBIT'),
    sa.Column('interest_expense', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Interest expense'),
    sa.Column('interest_income', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Interest income'),
    sa.Column('other_income', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Other income/(expense)'),
    sa.Column('ebt', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Earnings before tax'),
    sa.Column('tax_expense', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Tax expense'),
    sa.Column('tax_rate', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True, comment='Effective tax rate %'),
    sa.Column('net_income', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Net income'),
    sa.Column('net_margin', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True, comment='Net margin %'),
    sa.Column('cash', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Cash & equivalents'),
    sa.Column('accounts_receivable', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Accounts receivable'),
    sa.Column('inventory', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Inventory'),
    sa.Column('prepaid_expenses', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Prepaid expenses'),
    sa.Column('other_current_assets', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Other current assets'),
    sa.Column('total_current_assets', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Total current assets'),
    sa.Column('ppe_gross', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='PP&E (gross)'),
    sa.Column('accumulated_depreciation', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Accumulated depreciation'),
    sa.Column('ppe_net', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='PP&E (net)'),
    sa.Column('intangible_assets', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Intangible assets'),
    sa.Column('goodwill', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Goodwill'),
    sa.Column('other_longterm_assets', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Other long-term assets'),
    sa.Column('total_assets', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Total assets'),
    sa.Column('accounts_payable', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Accounts payable'),
    sa.Column('accrued_expenses', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Accrued expenses'),
    sa.Column('current_portion_debt', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Current portion of debt'),
    sa.Column('other_current_liabilities', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Other current liabilities'),
    sa.Column('total_current_liabilities', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Total current liabilities'),
    sa.Column('long_term_debt', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Long-term debt'),
    sa.Column('deferred_taxes', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Deferred taxes'),
    sa.Column('other_longterm_liabilities', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Other long-term liabilities'),
    sa.Column('total_liabilities', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Total liabilities'),
    sa.Column('shareholders_equity', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Shareholders equity'),
    sa.Column('retained_earnings', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Retained earnings'),
    sa.Column('operating_cash_flow', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Operating cash flow'),
    sa.Column('capex', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Capital expenditures'),
    sa.Column('investing_cash_flow', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Investing cash flow'),
    sa.Column('financing_cash_flow', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Financing cash flow'),
    sa.Column('net_cash_flow', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Net cash flow'),
    sa.Column('free_cash_flow', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Free cash flow'),
    sa.Column('working_capital', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Working capital'),
    sa.Column('net_working_capital', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Net working capital'),
    sa.Column('nwc_percent_revenue', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True, comment='NWC as % of revenue'),
    sa.Column('data_source', sa.VARCHAR(length=100), autoincrement=False, nullable=True, comment='Source: Management Report, Audited Financials, etc.'),
    sa.Column('data_source_file_id', sa.UUID(), autoincrement=False, nullable=True, comment='Reference to source document'),
    sa.Column('verified', sa.BOOLEAN(), autoincrement=False, nullable=False, comment='Whether data has been verified'),
    sa.Column('verified_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who verified the data'),
    sa.Column('verified_at', sa.DATE(), autoincrement=False, nullable=True, comment='Verification date'),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True, comment='Additional notes'),
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record last update timestamp'),
    sa.Column('created_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who created this record'),
    sa.Column('updated_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who last updated this record'),
    sa.CheckConstraint("period_type::text = ANY (ARRAY['Monthly'::character varying, 'Quarterly'::character varying, 'Annual'::character varying, 'LTM'::character varying]::text[])", name='valid_period_type'),
    sa.ForeignKeyConstraint(['company_id'], ['portfolio_companies.id'], name='financial_metrics_company_id_fkey', ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['data_source_file_id'], ['documents.id'], name='financial_metrics_data_source_file_id_fkey'),
    sa.PrimaryKeyConstraint('id', name='financial_metrics_pkey'),
    sa.UniqueConstraint('company_id', 'period_date', 'period_type', name='unique_company_period')
    )
    op.create_index('ix_financial_metrics_period_date', 'financial_metrics', ['period_date'], unique=False)
    op.create_index('ix_financial_metrics_fiscal_year', 'financial_metrics', ['fiscal_year'], unique=False)
    op.create_index('ix_financial_metrics_company_id', 'financial_metrics', ['company_id'], unique=False)
    op.create_table('str_platform_performance',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('platform_name', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('market_share_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('total_listings', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('active_listings', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('avg_adr', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_occupancy_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('booking_volume', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('gross_booking_value_usd', sa.NUMERIC(precision=20, scale=2), autoincrement=False, nullable=True),
    sa.Column('commission_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('host_retention_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('guest_satisfaction_score', sa.NUMERIC(precision=3, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_platform_performance_pkey')
    )
    op.create_index('ix_str_platform_performance_platform_name', 'str_platform_performance', ['platform_name'], unique=False)
    op.create_index('ix_str_platform_performance_period', 'str_platform_performance', ['period'], unique=False)
    op.create_index('ix_str_platform_performance_market', 'str_platform_performance', ['market'], unique=False)
    op.create_index('ix_str_platform_performance_id', 'str_platform_performance', ['id'], unique=False)
    op.create_table('str_guest_demographics',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('guest_origin', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('avg_group_size', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_age_range', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('purpose_of_visit', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('avg_booking_value_usd', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_length_of_stay_nights', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('repeat_guest_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('review_participation_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_review_score', sa.NUMERIC(precision=3, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_guest_demographics_pkey')
    )
    op.create_index('ix_str_guest_demographics_purpose_of_visit', 'str_guest_demographics', ['purpose_of_visit'], unique=False)
    op.create_index('ix_str_guest_demographics_period', 'str_guest_demographics', ['period'], unique=False)
    op.create_index('ix_str_guest_demographics_market', 'str_guest_demographics', ['market'], unique=False)
    op.create_index('ix_str_guest_demographics_id', 'str_guest_demographics', ['id'], unique=False)
    op.create_index('ix_str_guest_demographics_guest_origin', 'str_guest_demographics', ['guest_origin'], unique=False)
    op.create_table('property_tax_assessments',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('geography_type', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('indicator_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('indicator_value', sa.NUMERIC(precision=20, scale=6), autoincrement=False, nullable=True),
    sa.Column('indicator_unit', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='property_tax_assessments_pkey')
    )
    op.create_index('ix_property_tax_assessments_market', 'property_tax_assessments', ['market'], unique=False)
    op.create_index('ix_property_tax_assessments_indicator_name', 'property_tax_assessments', ['indicator_name'], unique=False)
    op.create_index('ix_property_tax_assessments_id', 'property_tax_assessments', ['id'], unique=False)
    op.create_index('ix_property_tax_assessments_geography_type', 'property_tax_assessments', ['geography_type'], unique=False)
    op.create_table('zoning_master_metrics',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('metric_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('metric_value', sa.NUMERIC(precision=20, scale=6), autoincrement=False, nullable=True),
    sa.Column('metric_unit', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('metric_category', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('benchmark_value', sa.NUMERIC(precision=20, scale=6), autoincrement=False, nullable=True),
    sa.Column('variance_from_benchmark_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('trend_direction', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='zoning_master_metrics_pkey')
    )
    op.create_index('ix_zoning_master_metrics_period', 'zoning_master_metrics', ['period'], unique=False)
    op.create_index('ix_zoning_master_metrics_metric_name', 'zoning_master_metrics', ['metric_name'], unique=False)
    op.create_index('ix_zoning_master_metrics_metric_category', 'zoning_master_metrics', ['metric_category'], unique=False)
    op.create_index('ix_zoning_master_metrics_market', 'zoning_master_metrics', ['market'], unique=False)
    op.create_index('ix_zoning_master_metrics_id', 'zoning_master_metrics', ['id'], unique=False)
    op.create_table('transit_oriented_development',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('tod_zone_name', sa.VARCHAR(length=300), autoincrement=False, nullable=False),
    sa.Column('transit_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('station_name', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('distance_to_station_feet', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('current_zoning', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('tod_zoning_designation', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('max_far_allowed', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('max_height_feet', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('parking_reduction_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('density_bonus_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('developable_acres', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('estimated_units_capacity', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('estimated_sf_capacity', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('development_pipeline_units', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('utilization_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='transit_oriented_development_pkey')
    )
    op.create_index('ix_transit_oriented_development_transit_type', 'transit_oriented_development', ['transit_type'], unique=False)
    op.create_index('ix_transit_oriented_development_tod_zone_name', 'transit_oriented_development', ['tod_zone_name'], unique=False)
    op.create_index('ix_transit_oriented_development_period', 'transit_oriented_development', ['period'], unique=False)
    op.create_index('ix_transit_oriented_development_market', 'transit_oriented_development', ['market'], unique=False)
    op.create_index('ix_transit_oriented_development_id', 'transit_oriented_development', ['id'], unique=False)
    op.create_table('str_hot_neighborhoods',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('neighborhood_rank', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('neighborhood_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('avg_annual_revenue_per_listing', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_occupancy_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_revpar', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('growth_stage', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('revenue_category', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('analysis_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_hot_neighborhoods_pkey')
    )
    op.create_index('ix_str_hot_neighborhoods_revenue_category', 'str_hot_neighborhoods', ['revenue_category'], unique=False)
    op.create_index('ix_str_hot_neighborhoods_neighborhood_rank', 'str_hot_neighborhoods', ['neighborhood_rank'], unique=False)
    op.create_index('ix_str_hot_neighborhoods_neighborhood_name', 'str_hot_neighborhoods', ['neighborhood_name'], unique=False)
    op.create_index('ix_str_hot_neighborhoods_market', 'str_hot_neighborhoods', ['market'], unique=False)
    op.create_index('ix_str_hot_neighborhoods_id', 'str_hot_neighborhoods', ['id'], unique=False)
    op.create_index('ix_str_hot_neighborhoods_growth_stage', 'str_hot_neighborhoods', ['growth_stage'], unique=False)
    op.create_index('ix_str_hot_neighborhoods_analysis_date', 'str_hot_neighborhoods', ['analysis_date'], unique=False)
    op.create_index('idx_str_hot_neighborhood', 'str_hot_neighborhoods', ['market', 'neighborhood_rank'], unique=False)
    op.create_table('str_regulatory_environment',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('regulation_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('registration_required', sa.VARCHAR(length=10), autoincrement=False, nullable=True),
    sa.Column('license_permit_required', sa.VARCHAR(length=10), autoincrement=False, nullable=True),
    sa.Column('license_cost_usd', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('primary_residence_requirement', sa.VARCHAR(length=10), autoincrement=False, nullable=True),
    sa.Column('max_rental_days_per_year', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('occupancy_tax_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('platform_collects_taxes', sa.VARCHAR(length=10), autoincrement=False, nullable=True),
    sa.Column('enforcement_level', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('fine_per_violation_usd', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('effective_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_regulatory_environment_pkey')
    )
    op.create_index('ix_str_regulatory_environment_regulation_type', 'str_regulatory_environment', ['regulation_type'], unique=False)
    op.create_index('ix_str_regulatory_environment_market', 'str_regulatory_environment', ['market'], unique=False)
    op.create_index('ix_str_regulatory_environment_id', 'str_regulatory_environment', ['id'], unique=False)
    op.create_index('ix_str_regulatory_environment_enforcement_level', 'str_regulatory_environment', ['enforcement_level'], unique=False)
    op.create_index('ix_str_regulatory_environment_effective_date', 'str_regulatory_environment', ['effective_date'], unique=False)
    op.create_table('str_investment_analysis',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('property_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('avg_acquisition_cost', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_renovation_cost', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('total_upfront_investment', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('annual_gross_revenue', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('annual_net_operating_income', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('cash_on_cash_return_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('cap_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('payback_period_years', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('irr_5year_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('appreciation_rate_annual_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_investment_analysis_pkey')
    )
    op.create_index('ix_str_investment_analysis_property_type', 'str_investment_analysis', ['property_type'], unique=False)
    op.create_index('ix_str_investment_analysis_period', 'str_investment_analysis', ['period'], unique=False)
    op.create_index('ix_str_investment_analysis_market', 'str_investment_analysis', ['market'], unique=False)
    op.create_index('ix_str_investment_analysis_id', 'str_investment_analysis', ['id'], unique=False)
    op.create_table('tenant_credit_quality',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('tenant_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('ticker', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('category', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('company_name', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('moodys_rating', sa.VARCHAR(length=10), autoincrement=False, nullable=True),
    sa.Column('sp_rating', sa.VARCHAR(length=10), autoincrement=False, nullable=True),
    sa.Column('metric_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('metric_value', sa.NUMERIC(precision=20, scale=6), autoincrement=False, nullable=True),
    sa.Column('unit', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='tenant_credit_quality_pkey')
    )
    op.create_index('ix_tenant_credit_quality_ticker', 'tenant_credit_quality', ['ticker'], unique=False)
    op.create_index('ix_tenant_credit_quality_tenant_name', 'tenant_credit_quality', ['tenant_name'], unique=False)
    op.create_index('ix_tenant_credit_quality_period', 'tenant_credit_quality', ['period'], unique=False)
    op.create_index('ix_tenant_credit_quality_metric_name', 'tenant_credit_quality', ['metric_name'], unique=False)
    op.create_index('ix_tenant_credit_quality_id', 'tenant_credit_quality', ['id'], unique=False)
    op.create_index('ix_tenant_credit_quality_category', 'tenant_credit_quality', ['category'], unique=False)
    op.create_index('idx_tenant_credit', 'tenant_credit_quality', ['tenant_name', 'metric_name', 'period'], unique=False)
    op.create_table('markitdown_batches',
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('batch_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('batch_description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('total_documents', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('completed_documents', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('failed_documents', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('started_at', postgresql.TIMESTAMP(), autoincrement=False, nullable=True),
    sa.Column('completed_at', postgresql.TIMESTAMP(), autoincrement=False, nullable=True),
    sa.Column('total_duration_ms', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('conversion_settings', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('created_by', sa.UUID(), autoincrement=False, nullable=True),
    sa.Column('total_size_kb', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('total_characters', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='markitdown_batches_pkey')
    )
    op.create_index('ix_markitdown_batches_status', 'markitdown_batches', ['status'], unique=False)
    op.create_table('neighborhood_scores',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('neighborhood_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('score_category', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('score_value', sa.NUMERIC(precision=10, scale=4), autoincrement=False, nullable=False),
    sa.Column('rank_within_market', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('rank_nationally', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='neighborhood_scores_pkey')
    )
    op.create_index('ix_neighborhood_scores_score_category', 'neighborhood_scores', ['score_category'], unique=False)
    op.create_index('ix_neighborhood_scores_period', 'neighborhood_scores', ['period'], unique=False)
    op.create_index('ix_neighborhood_scores_neighborhood_name', 'neighborhood_scores', ['neighborhood_name'], unique=False)
    op.create_index('ix_neighborhood_scores_market_name', 'neighborhood_scores', ['market_name'], unique=False)
    op.create_index('ix_neighborhood_scores_id', 'neighborhood_scores', ['id'], unique=False)
    op.create_index('idx_neighborhood_score', 'neighborhood_scores', ['market_name', 'neighborhood_name', 'score_category'], unique=False)
    op.create_table('markitdown_content',
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('document_id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('markdown_text', sa.TEXT(), autoincrement=False, nullable=False),
    sa.Column('html_preview', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('plain_text', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('heading_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('table_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('image_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('link_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('code_block_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('tables_data', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('images_data', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('links_data', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['document_id'], ['markitdown_documents.id'], name='markitdown_content_document_id_fkey', ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id', name='markitdown_content_pkey'),
    sa.UniqueConstraint('document_id', name='markitdown_content_document_id_key')
    )
    op.create_index('ix_markitdown_content_document_id', 'markitdown_content', ['document_id'], unique=False)
    op.create_table('company_kpis',
    sa.Column('company_id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('period_date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('period_type', sa.VARCHAR(length=20), autoincrement=False, nullable=False),
    sa.Column('arr', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Annual Recurring Revenue'),
    sa.Column('mrr', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Monthly Recurring Revenue'),
    sa.Column('net_revenue_retention', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True, comment='Net Revenue Retention %'),
    sa.Column('gross_revenue_retention', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True, comment='Gross Revenue Retention %'),
    sa.Column('customer_churn_rate', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True, comment='Customer churn rate %'),
    sa.Column('revenue_churn_rate', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True, comment='Revenue churn rate %'),
    sa.Column('total_customers', sa.INTEGER(), autoincrement=False, nullable=True, comment='Total customers'),
    sa.Column('new_customers', sa.INTEGER(), autoincrement=False, nullable=True, comment='New customers added'),
    sa.Column('churned_customers', sa.INTEGER(), autoincrement=False, nullable=True, comment='Customers churned'),
    sa.Column('active_customers', sa.INTEGER(), autoincrement=False, nullable=True, comment='Active customers'),
    sa.Column('arpu', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Average Revenue Per User'),
    sa.Column('cac', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Customer Acquisition Cost'),
    sa.Column('ltv', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Lifetime Value'),
    sa.Column('ltv_cac_ratio', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True, comment='LTV/CAC ratio'),
    sa.Column('magic_number', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True, comment='SaaS Magic Number'),
    sa.Column('sales_efficiency', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True, comment='Sales efficiency ratio'),
    sa.Column('headcount', sa.INTEGER(), autoincrement=False, nullable=True, comment='Total headcount'),
    sa.Column('revenue_per_employee', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Revenue per employee'),
    sa.Column('gross_margin_per_employee', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True, comment='Gross margin per employee'),
    sa.Column('monthly_active_users', sa.INTEGER(), autoincrement=False, nullable=True, comment='Monthly active users'),
    sa.Column('daily_active_users', sa.INTEGER(), autoincrement=False, nullable=True, comment='Daily active users'),
    sa.Column('nps_score', sa.INTEGER(), autoincrement=False, nullable=True, comment='Net Promoter Score'),
    sa.Column('product_adoption_rate', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True, comment='Product adoption rate %'),
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record last update timestamp'),
    sa.Column('created_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who created this record'),
    sa.Column('updated_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who last updated this record'),
    sa.CheckConstraint("period_type::text = ANY (ARRAY['Monthly'::character varying, 'Quarterly'::character varying, 'Annual'::character varying]::text[])", name='valid_period_type'),
    sa.ForeignKeyConstraint(['company_id'], ['portfolio_companies.id'], name='company_kpis_company_id_fkey', ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id', name='company_kpis_pkey')
    )
    op.create_index('ix_company_kpis_period_date', 'company_kpis', ['period_date'], unique=False)
    op.create_index('ix_company_kpis_company_id', 'company_kpis', ['company_id'], unique=False)
    op.create_table('opportunity_zones',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('num_opportunity_zones', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('total_acres_in_oz', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('investment_in_oz_mm', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('development_projects_in_oz', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('oz_residential_units', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('oz_commercial_sf', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('avg_cap_rate_compression_bps', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('oz_designation_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='opportunity_zones_pkey')
    )
    op.create_index('ix_opportunity_zones_period', 'opportunity_zones', ['period'], unique=False)
    op.create_index('ix_opportunity_zones_market', 'opportunity_zones', ['market'], unique=False)
    op.create_index('ix_opportunity_zones_id', 'opportunity_zones', ['id'], unique=False)
    op.create_table('str_competitive_analysis',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('str_adr_daily', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('str_monthly_equivalent_adr_x30', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('ltr_monthly_rent', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('str_adr_vs_ltr_difference', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('str_profitability_advantage', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('breakeven_occupancy_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('str_implied_cap_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('ltr_implied_cap_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('cap_rate_advantage_basis_points', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_competitive_analysis_pkey')
    )
    op.create_index('ix_str_competitive_analysis_period', 'str_competitive_analysis', ['period'], unique=False)
    op.create_index('ix_str_competitive_analysis_market', 'str_competitive_analysis', ['market'], unique=False)
    op.create_index('ix_str_competitive_analysis_id', 'str_competitive_analysis', ['id'], unique=False)
    op.create_table('development_pipeline',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('zone_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('projects_under_construction', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('units_under_construction', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('sf_under_construction', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('permits_issued_ytd_2024', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('units_permitted_ytd', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('sf_permitted_ytd', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('permit_value_mm', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('applications_pending', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('avg_approval_timeline_months', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('approval_success_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='development_pipeline_pkey')
    )
    op.create_index('ix_development_pipeline_zone_type', 'development_pipeline', ['zone_type'], unique=False)
    op.create_index('ix_development_pipeline_period', 'development_pipeline', ['period'], unique=False)
    op.create_index('ix_development_pipeline_market', 'development_pipeline', ['market'], unique=False)
    op.create_index('ix_development_pipeline_id', 'development_pipeline', ['id'], unique=False)
    op.create_table('str_market_overview',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('total_str_listings', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('active_listings_30days', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('entire_home_apt_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('entire_home_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('private_shared_room_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('private_shared_room_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('str_pct_of_housing_stock', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True),
    sa.Column('inventory_growth_yoy_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_listing_age_months', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('host_concentration_10plus_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('analysis_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_market_overview_pkey')
    )
    op.create_index('ix_str_market_overview_market', 'str_market_overview', ['market'], unique=False)
    op.create_index('ix_str_market_overview_id', 'str_market_overview', ['id'], unique=False)
    op.create_index('ix_str_market_overview_analysis_date', 'str_market_overview', ['analysis_date'], unique=False)
    op.create_table('audit_logs',
    sa.Column('user_id', sa.UUID(), autoincrement=False, nullable=True),
    sa.Column('action', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('entity_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('entity_id', sa.UUID(), autoincrement=False, nullable=True),
    sa.Column('changes', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('ip_address', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('user_agent', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record last update timestamp'),
    sa.PrimaryKeyConstraint('id', name='audit_logs_pkey')
    )
    op.create_index('ix_audit_logs_user_id', 'audit_logs', ['user_id'], unique=False)
    op.create_table('str_performance_metrics',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('property_type', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('adr_daily', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('occupancy_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('revpar', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('monthly_revenue_avg', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('annual_revenue_avg', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('booking_lead_time_days', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('avg_length_of_stay_nights', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('review_score', sa.NUMERIC(precision=3, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_performance_metrics_pkey')
    )
    op.create_index('ix_str_performance_metrics_property_type', 'str_performance_metrics', ['property_type'], unique=False)
    op.create_index('ix_str_performance_metrics_period', 'str_performance_metrics', ['period'], unique=False)
    op.create_index('ix_str_performance_metrics_market', 'str_performance_metrics', ['market'], unique=False)
    op.create_index('ix_str_performance_metrics_id', 'str_performance_metrics', ['id'], unique=False)
    op.create_index('idx_str_performance', 'str_performance_metrics', ['market', 'property_type', 'period'], unique=False)
    op.create_table('value_creation_initiatives',
    sa.Column('company_id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('initiative_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('category', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('status', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('target_value_impact', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('start_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('completion_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('owner', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('description', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record last update timestamp'),
    sa.Column('created_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who created this record'),
    sa.Column('updated_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who last updated this record'),
    sa.ForeignKeyConstraint(['company_id'], ['portfolio_companies.id'], name='value_creation_initiatives_company_id_fkey', ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id', name='value_creation_initiatives_pkey')
    )
    op.create_index('ix_value_creation_initiatives_company_id', 'value_creation_initiatives', ['company_id'], unique=False)
    op.create_table('zoning_districts',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('zone_type', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('zone_code', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('max_far', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('max_height_feet', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('min_lot_size_sf', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('parking_requirement', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('setback_front_feet', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('use_restrictions', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('effective_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='zoning_districts_pkey')
    )
    op.create_index('ix_zoning_districts_zone_type', 'zoning_districts', ['zone_type'], unique=False)
    op.create_index('ix_zoning_districts_zone_code', 'zoning_districts', ['zone_code'], unique=False)
    op.create_index('ix_zoning_districts_market', 'zoning_districts', ['market'], unique=False)
    op.create_index('ix_zoning_districts_id', 'zoning_districts', ['id'], unique=False)
    op.create_index('ix_zoning_districts_effective_date', 'zoning_districts', ['effective_date'], unique=False)
    op.create_index('idx_zoning_district', 'zoning_districts', ['market', 'zone_type', 'zone_code'], unique=False)
    op.create_table('str_pricing_patterns',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('property_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('season', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('avg_nightly_rate', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('min_nightly_rate', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('max_nightly_rate', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('weekend_premium_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('holiday_premium_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('special_event_premium_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('last_minute_discount_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('early_booking_discount_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('dynamic_pricing_adoption_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_pricing_patterns_pkey')
    )
    op.create_index('ix_str_pricing_patterns_season', 'str_pricing_patterns', ['season'], unique=False)
    op.create_index('ix_str_pricing_patterns_property_type', 'str_pricing_patterns', ['property_type'], unique=False)
    op.create_index('ix_str_pricing_patterns_period', 'str_pricing_patterns', ['period'], unique=False)
    op.create_index('ix_str_pricing_patterns_market', 'str_pricing_patterns', ['market'], unique=False)
    op.create_index('ix_str_pricing_patterns_id', 'str_pricing_patterns', ['id'], unique=False)
    op.create_table('underbuilt_parcels',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('zone_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('num_underbuilt_parcels', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('avg_current_far', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_max_allowed_far', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('far_gap', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_current_height_feet', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('avg_max_height_feet', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('avg_parcel_size_sf', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('avg_parcel_size_acres', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('total_additional_developable_sf', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('estimated_additional_units_possible', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('analysis_date', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='underbuilt_parcels_pkey')
    )
    op.create_index('ix_underbuilt_parcels_zone_type', 'underbuilt_parcels', ['zone_type'], unique=False)
    op.create_index('ix_underbuilt_parcels_market', 'underbuilt_parcels', ['market'], unique=False)
    op.create_index('ix_underbuilt_parcels_id', 'underbuilt_parcels', ['id'], unique=False)
    op.create_index('ix_underbuilt_parcels_analysis_date', 'underbuilt_parcels', ['analysis_date'], unique=False)
    op.create_table('documents',
    sa.Column('company_id', sa.UUID(), autoincrement=False, nullable=True),
    sa.Column('document_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('document_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True, comment='Financial Statement, Contract, etc.'),
    sa.Column('file_path', sa.VARCHAR(length=500), autoincrement=False, nullable=False),
    sa.Column('file_size', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('mime_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('extraction_status', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('extracted_data', postgresql.JSONB(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('extraction_confidence', sa.VARCHAR(length=10), autoincrement=False, nullable=True),
    sa.Column('needs_review', sa.BOOLEAN(), autoincrement=False, nullable=True),
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record last update timestamp'),
    sa.Column('created_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who created this record'),
    sa.Column('updated_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who last updated this record'),
    sa.ForeignKeyConstraint(['company_id'], ['portfolio_companies.id'], name='documents_company_id_fkey', ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id', name='documents_pkey')
    )
    op.create_index('ix_documents_company_id', 'documents', ['company_id'], unique=False)
    op.create_table('comparable_transactions',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('address', sa.VARCHAR(length=300), autoincrement=False, nullable=True),
    sa.Column('city', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('submarket', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('state', sa.VARCHAR(length=2), autoincrement=False, nullable=False),
    sa.Column('property_type', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('property_class', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('sale_date', sa.DATE(), autoincrement=False, nullable=False),
    sa.Column('sale_price', sa.NUMERIC(precision=20, scale=2), autoincrement=False, nullable=True),
    sa.Column('price_per_unit', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('price_per_sf', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('cap_rate', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True),
    sa.Column('units', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('total_sf', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('year_built', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('buyer', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('seller', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('financing_type', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('occupancy_at_sale', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True),
    sa.Column('deal_type', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('source_url', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.Column('zip_code', sa.VARCHAR(length=10), autoincrement=False, nullable=True),
    sa.Column('lot_size_sf', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('year_renovated', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('num_buildings', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('num_floors', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('parking_spaces', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('noi', sa.NUMERIC(precision=20, scale=2), autoincrement=False, nullable=True),
    sa.Column('gross_potential_rent', sa.NUMERIC(precision=20, scale=2), autoincrement=False, nullable=True),
    sa.Column('inplace_vs_market_rent_pct', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True),
    sa.Column('buyer_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('seller_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('broker', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('ltv', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True),
    sa.Column('lender', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('interest_rate', sa.NUMERIC(precision=5, scale=4), autoincrement=False, nullable=True),
    sa.Column('special_conditions', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='comparable_transactions_pkey')
    )
    op.create_index('ix_comparable_transactions_zip_code', 'comparable_transactions', ['zip_code'], unique=False)
    op.create_index('ix_comparable_transactions_submarket', 'comparable_transactions', ['submarket'], unique=False)
    op.create_index('ix_comparable_transactions_state', 'comparable_transactions', ['state'], unique=False)
    op.create_index('ix_comparable_transactions_sale_date', 'comparable_transactions', ['sale_date'], unique=False)
    op.create_index('ix_comparable_transactions_property_type', 'comparable_transactions', ['property_type'], unique=False)
    op.create_index('ix_comparable_transactions_property_class', 'comparable_transactions', ['property_class'], unique=False)
    op.create_index('ix_comparable_transactions_id', 'comparable_transactions', ['id'], unique=False)
    op.create_index('ix_comparable_transactions_deal_type', 'comparable_transactions', ['deal_type'], unique=False)
    op.create_index('ix_comparable_transactions_city', 'comparable_transactions', ['city'], unique=False)
    op.create_index('idx_comp_trans', 'comparable_transactions', ['city', 'property_type', 'sale_date'], unique=False)
    op.create_table('due_diligence_items',
    sa.Column('company_id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('category', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('item_name', sa.VARCHAR(length=255), autoincrement=False, nullable=False),
    sa.Column('status', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('risk_level', sa.VARCHAR(length=20), autoincrement=False, nullable=True),
    sa.Column('assigned_to', sa.VARCHAR(length=255), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record creation timestamp'),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=False, comment='Record last update timestamp'),
    sa.Column('created_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who created this record'),
    sa.Column('updated_by', sa.UUID(), autoincrement=False, nullable=True, comment='User who last updated this record'),
    sa.ForeignKeyConstraint(['company_id'], ['portfolio_companies.id'], name='due_diligence_items_company_id_fkey', ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id', name='due_diligence_items_pkey')
    )
    op.create_index('ix_due_diligence_items_company_id', 'due_diligence_items', ['company_id'], unique=False)
    op.create_table('markitdown_analytics',
    sa.Column('id', sa.UUID(), autoincrement=False, nullable=False),
    sa.Column('date', postgresql.TIMESTAMP(), autoincrement=False, nullable=False),
    sa.Column('total_conversions', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('successful_conversions', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('failed_conversions', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('file_type_stats', postgresql.JSON(astext_type=sa.Text()), autoincrement=False, nullable=True),
    sa.Column('avg_conversion_time_ms', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('avg_file_size_kb', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('avg_output_length', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('avg_confidence_score', sa.DOUBLE_PRECISION(precision=53), autoincrement=False, nullable=True),
    sa.Column('documents_needing_review', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('llm_enhanced_count', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('total_llm_tokens', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('active_users', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('total_uploads', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(), autoincrement=False, nullable=False),
    sa.Column('updated_at', postgresql.TIMESTAMP(), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='markitdown_analytics_pkey')
    )
    op.create_index('ix_markitdown_analytics_date', 'markitdown_analytics', ['date'], unique=False)
    op.create_table('str_host_economics',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('host_type', sa.VARCHAR(length=100), autoincrement=False, nullable=True),
    sa.Column('avg_annual_revenue_per_listing', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_monthly_revenue_per_listing', sa.NUMERIC(precision=15, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_occupancy_rate_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('avg_nightly_rate', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('operating_expenses_pct_of_revenue', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('platform_fees_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('cleaning_fees_avg', sa.NUMERIC(precision=10, scale=2), autoincrement=False, nullable=True),
    sa.Column('estimated_net_margin_pct', sa.NUMERIC(precision=5, scale=2), autoincrement=False, nullable=True),
    sa.Column('time_to_profitability_months', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='str_host_economics_pkey')
    )
    op.create_index('ix_str_host_economics_period', 'str_host_economics', ['period'], unique=False)
    op.create_index('ix_str_host_economics_market', 'str_host_economics', ['market'], unique=False)
    op.create_index('ix_str_host_economics_id', 'str_host_economics', ['id'], unique=False)
    op.create_index('ix_str_host_economics_host_type', 'str_host_economics', ['host_type'], unique=False)
    op.create_table('hot_zone_markets',
    sa.Column('id', sa.INTEGER(), autoincrement=True, nullable=False),
    sa.Column('market_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('neighborhood_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('hot_zone_rank', sa.INTEGER(), autoincrement=False, nullable=True),
    sa.Column('metric_category', sa.VARCHAR(length=100), autoincrement=False, nullable=False),
    sa.Column('metric_name', sa.VARCHAR(length=200), autoincrement=False, nullable=False),
    sa.Column('metric_value', sa.NUMERIC(precision=20, scale=6), autoincrement=False, nullable=True),
    sa.Column('metric_unit', sa.VARCHAR(length=50), autoincrement=False, nullable=False),
    sa.Column('period', sa.DATE(), autoincrement=False, nullable=True),
    sa.Column('comparison_to_city_average', sa.VARCHAR(length=50), autoincrement=False, nullable=True),
    sa.Column('data_source', sa.VARCHAR(length=200), autoincrement=False, nullable=True),
    sa.Column('notes', sa.TEXT(), autoincrement=False, nullable=True),
    sa.Column('created_at', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), autoincrement=False, nullable=True),
    sa.Column('updated_at', postgresql.TIMESTAMP(timezone=True), autoincrement=False, nullable=True),
    sa.PrimaryKeyConstraint('id', name='hot_zone_markets_pkey')
    )
    op.create_index('ix_hot_zone_markets_period', 'hot_zone_markets', ['period'], unique=False)
    op.create_index('ix_hot_zone_markets_neighborhood_name', 'hot_zone_markets', ['neighborhood_name'], unique=False)
    op.create_index('ix_hot_zone_markets_metric_name', 'hot_zone_markets', ['metric_name'], unique=False)
    op.create_index('ix_hot_zone_markets_metric_category', 'hot_zone_markets', ['metric_category'], unique=False)
    op.create_index('ix_hot_zone_markets_market_name', 'hot_zone_markets', ['market_name'], unique=False)
    op.create_index('ix_hot_zone_markets_id', 'hot_zone_markets', ['id'], unique=False)
    op.create_index('ix_hot_zone_markets_hot_zone_rank', 'hot_zone_markets', ['hot_zone_rank'], unique=False)
    op.create_index('idx_hot_zone', 'hot_zone_markets', ['market_name', 'neighborhood_name', 'hot_zone_rank'], unique=False)
    op.drop_index(op.f('ix_statute_limitations_tracker_id'), table_name='statute_limitations_tracker')
    op.drop_table('statute_limitations_tracker')
    op.drop_index(op.f('ix_soc2_compliance_id'), table_name='soc2_compliance')
    op.drop_table('soc2_compliance')
    op.drop_index(op.f('ix_opportunity_zone_investments_id'), table_name='opportunity_zone_investments')
    op.drop_table('opportunity_zone_investments')
    op.drop_index(op.f('ix_official_data_records_zip_code'), table_name='official_data_records')
    op.drop_index(op.f('ix_official_data_records_state'), table_name='official_data_records')
    op.drop_index(op.f('ix_official_data_records_record_id'), table_name='official_data_records')
    op.drop_index(op.f('ix_official_data_records_id'), table_name='official_data_records')
    op.drop_index(op.f('ix_official_data_records_dataset_id'), table_name='official_data_records')
    op.drop_index(op.f('ix_official_data_records_data_year'), table_name='official_data_records')
    op.drop_index(op.f('ix_official_data_records_data_type'), table_name='official_data_records')
    op.drop_index(op.f('ix_official_data_records_county'), table_name='official_data_records')
    op.drop_index(op.f('ix_official_data_records_country'), table_name='official_data_records')
    op.drop_index(op.f('ix_official_data_records_city'), table_name='official_data_records')
    op.drop_index(op.f('ix_official_data_records_category'), table_name='official_data_records')
    op.drop_table('official_data_records')
    op.drop_index(op.f('ix_legal_holds_id'), table_name='legal_holds')
    op.drop_table('legal_holds')
    op.drop_index(op.f('ix_investor_kyc_aml_id'), table_name='investor_kyc_aml')
    op.drop_table('investor_kyc_aml')
    op.drop_index(op.f('ix_firpta_compliance_id'), table_name='firpta_compliance')
    op.drop_table('firpta_compliance')
    op.drop_index(op.f('ix_fair_housing_compliance_id'), table_name='fair_housing_compliance')
    op.drop_table('fair_housing_compliance')
    op.drop_index(op.f('ix_exchange_1031_tracking_id'), table_name='exchange_1031_tracking')
    op.drop_table('exchange_1031_tracking')
    op.drop_index(op.f('ix_esignature_requests_id'), table_name='esignature_requests')
    op.drop_table('esignature_requests')
    op.drop_index(op.f('ix_document_templates_id'), table_name='document_templates')
    op.drop_table('document_templates')
    op.drop_index(op.f('ix_country_filters_user_id'), table_name='country_filters')
    op.drop_index('idx_country_filter_user', table_name='country_filters')
    op.drop_index('idx_country_filter_company', table_name='country_filters')
    op.drop_table('country_filters')
    op.drop_index(op.f('ix_clause_library_id'), table_name='clause_library')
    op.drop_table('clause_library')
    op.drop_index(op.f('ix_clause_comparisons_id'), table_name='clause_comparisons')
    op.drop_table('clause_comparisons')
    op.drop_index(op.f('ix_automation_workflows_id'), table_name='automation_workflows')
    op.drop_table('automation_workflows')
    op.drop_index(op.f('ix_audit_preparation_id'), table_name='audit_preparation')
    op.drop_table('audit_preparation')
    op.drop_index(op.f('ix_ai_contract_analysis_id'), table_name='ai_contract_analysis')
    op.drop_table('ai_contract_analysis')
    op.drop_index(op.f('ix_zoning_data_state'), table_name='zoning_data')
    op.drop_index(op.f('ix_zoning_data_jurisdiction'), table_name='zoning_data')
    op.drop_index(op.f('ix_zoning_data_id'), table_name='zoning_data')
    op.drop_table('zoning_data')
    op.drop_index(op.f('ix_yfinance_market_data_ticker'), table_name='yfinance_market_data')
    op.drop_index(op.f('ix_yfinance_market_data_security_type'), table_name='yfinance_market_data')
    op.drop_index(op.f('ix_yfinance_market_data_sector'), table_name='yfinance_market_data')
    op.drop_index(op.f('ix_yfinance_market_data_industry'), table_name='yfinance_market_data')
    op.drop_index(op.f('ix_yfinance_market_data_id'), table_name='yfinance_market_data')
    op.drop_index('idx_yfinance_type_sector', table_name='yfinance_market_data')
    op.drop_index('idx_yfinance_ticker_timestamp', table_name='yfinance_market_data')
    op.drop_table('yfinance_market_data')
    op.drop_index(op.f('ix_treasury_rates_symbol'), table_name='treasury_rates')
    op.drop_index(op.f('ix_treasury_rates_data_date'), table_name='treasury_rates')
    op.drop_index('idx_treasury_symbol_date', table_name='treasury_rates')
    op.drop_table('treasury_rates')
    op.drop_index(op.f('ix_stock_data_ticker'), table_name='stock_data')
    op.drop_index(op.f('ix_stock_data_data_date'), table_name='stock_data')
    op.drop_index('idx_stock_ticker_date', table_name='stock_data')
    op.drop_index('idx_stock_sector', table_name='stock_data')
    op.drop_table('stock_data')
    op.drop_index(op.f('ix_state_legal_forms_state'), table_name='state_legal_forms')
    op.drop_index(op.f('ix_state_legal_forms_id'), table_name='state_legal_forms')
    op.drop_table('state_legal_forms')
    op.drop_table('small_multifamily_acquisition_models')
    op.drop_index(op.f('ix_reit_data_ticker'), table_name='reit_data')
    op.drop_index(op.f('ix_reit_data_data_date'), table_name='reit_data')
    op.drop_index('idx_reit_ticker_date', table_name='reit_data')
    op.drop_index('idx_reit_sector', table_name='reit_data')
    op.drop_table('reit_data')
    op.drop_index(op.f('ix_regulatory_changes_id'), table_name='regulatory_changes')
    op.drop_table('regulatory_changes')
    op.drop_index(op.f('ix_real_estate_economic_indicators_data_date'), table_name='real_estate_economic_indicators')
    op.drop_table('real_estate_economic_indicators')
    op.drop_index(op.f('ix_official_datasets_source'), table_name='official_datasets')
    op.drop_index(op.f('ix_official_datasets_id'), table_name='official_datasets')
    op.drop_index(op.f('ix_official_datasets_dataset_id'), table_name='official_datasets')
    op.drop_table('official_datasets')
    op.drop_index(op.f('ix_market_intelligence_snapshots_snapshot_type'), table_name='market_intelligence_snapshots')
    op.drop_index(op.f('ix_market_intelligence_snapshots_snapshot_date'), table_name='market_intelligence_snapshots')
    op.drop_index(op.f('ix_market_intelligence_snapshots_id'), table_name='market_intelligence_snapshots')
    op.drop_index('idx_snapshot_date_type', table_name='market_intelligence_snapshots')
    op.drop_table('market_intelligence_snapshots')
    op.drop_index(op.f('ix_market_intelligence_fetch_log_fetch_timestamp'), table_name='market_intelligence_fetch_log')
    op.drop_index('idx_fetch_log_status', table_name='market_intelligence_fetch_log')
    op.drop_index('idx_fetch_log_source_type', table_name='market_intelligence_fetch_log')
    op.drop_table('market_intelligence_fetch_log')
    op.drop_index(op.f('ix_market_indices_symbol'), table_name='market_indices')
    op.drop_index(op.f('ix_market_indices_data_date'), table_name='market_indices')
    op.drop_index('idx_market_index_symbol_date', table_name='market_indices')
    op.drop_table('market_indices')
    op.drop_index(op.f('ix_legal_knowledge_base_topic'), table_name='legal_knowledge_base')
    op.drop_index(op.f('ix_legal_knowledge_base_id'), table_name='legal_knowledge_base')
    op.drop_table('legal_knowledge_base')
    op.drop_index(op.f('ix_housing_price_indexes_year'), table_name='housing_price_indexes')
    op.drop_index(op.f('ix_housing_price_indexes_source'), table_name='housing_price_indexes')
    op.drop_index(op.f('ix_housing_price_indexes_id'), table_name='housing_price_indexes')
    op.drop_index(op.f('ix_housing_price_indexes_geography_type'), table_name='housing_price_indexes')
    op.drop_index(op.f('ix_housing_price_indexes_geography_code'), table_name='housing_price_indexes')
    op.drop_index(op.f('ix_housing_price_indexes_date'), table_name='housing_price_indexes')
    op.drop_table('housing_price_indexes')
    op.drop_index(op.f('ix_global_economic_indicators_data_date'), table_name='global_economic_indicators')
    op.drop_index(op.f('ix_global_economic_indicators_country'), table_name='global_economic_indicators')
    op.drop_index(op.f('ix_global_economic_indicators_category'), table_name='global_economic_indicators')
    op.drop_index('idx_global_economic_indicator', table_name='global_economic_indicators')
    op.drop_index('idx_global_economic_country_category', table_name='global_economic_indicators')
    op.drop_table('global_economic_indicators')
    op.drop_index(op.f('ix_fair_market_rents_zip_code'), table_name='fair_market_rents')
    op.drop_index(op.f('ix_fair_market_rents_year'), table_name='fair_market_rents')
    op.drop_index(op.f('ix_fair_market_rents_state'), table_name='fair_market_rents')
    op.drop_index(op.f('ix_fair_market_rents_metro_code'), table_name='fair_market_rents')
    op.drop_index(op.f('ix_fair_market_rents_id'), table_name='fair_market_rents')
    op.drop_index(op.f('ix_fair_market_rents_county'), table_name='fair_market_rents')
    op.drop_table('fair_market_rents')
    op.drop_index(op.f('ix_exchange_rates_year'), table_name='exchange_rates')
    op.drop_index(op.f('ix_exchange_rates_source'), table_name='exchange_rates')
    op.drop_index(op.f('ix_exchange_rates_series_code'), table_name='exchange_rates')
    op.drop_index(op.f('ix_exchange_rates_quote_currency'), table_name='exchange_rates')
    op.drop_index(op.f('ix_exchange_rates_month'), table_name='exchange_rates')
    op.drop_index(op.f('ix_exchange_rates_id'), table_name='exchange_rates')
    op.drop_index(op.f('ix_exchange_rates_date'), table_name='exchange_rates')
    op.drop_index(op.f('ix_exchange_rates_base_currency'), table_name='exchange_rates')
    op.drop_table('exchange_rates')
    op.drop_index(op.f('ix_economics_api_indicators_reference_date'), table_name='economics_api_indicators')
    op.drop_index(op.f('ix_economics_api_indicators_id'), table_name='economics_api_indicators')
    op.drop_index(op.f('ix_economics_api_indicators_country_code'), table_name='economics_api_indicators')
    op.drop_index(op.f('ix_economics_api_indicators_country'), table_name='economics_api_indicators')
    op.drop_index(op.f('ix_economics_api_indicators_category'), table_name='economics_api_indicators')
    op.drop_index('idx_economic_indicator', table_name='economics_api_indicators')
    op.drop_index('idx_economic_country_category', table_name='economics_api_indicators')
    op.drop_index('idx_economic_category_date', table_name='economics_api_indicators')
    op.drop_table('economics_api_indicators')
    op.drop_index(op.f('ix_data_update_logs_status'), table_name='data_update_logs')
    op.drop_index(op.f('ix_data_update_logs_integration_name'), table_name='data_update_logs')
    op.drop_index(op.f('ix_data_update_logs_id'), table_name='data_update_logs')
    op.drop_index(op.f('ix_data_update_logs_data_type'), table_name='data_update_logs')
    op.drop_table('data_update_logs')
    # ### end Alembic commands ###
